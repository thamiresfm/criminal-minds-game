<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Investiga√ß√£o - Criminal Minds Cards</title>
    
    <!-- Timer do Jogo -->
    <script src="js/simple-game-timer.js"></script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #0f0f23, #1a1a2e, #16213e);
            color: white;
            min-height: 100vh;
            overflow-x: hidden;
        }

        .game-container {
            display: grid;
            grid-template-columns: 320px 1fr 320px;
            grid-template-rows: 70px 1fr;
            height: 100vh;
            gap: 0.8rem;
            padding: 0.8rem;
            background: linear-gradient(135deg, #0f0f23, #1a1a2e, #16213e);
            box-shadow: inset 0 0 100px rgba(0, 0, 0, 0.3);
        }

        .header {
            grid-column: 1 / -1;
            background: linear-gradient(135deg, rgba(15, 15, 35, 0.98), rgba(26, 26, 46, 0.98));
            border: 2px solid rgba(251, 191, 36, 0.4);
            border-radius: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 2rem;
            backdrop-filter: blur(20px);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4), inset 0 1px 0 rgba(251, 191, 36, 0.1);
        }
        
        .header .case-title {
            flex: 1;
            text-align: left;
        }
        

        
        .header .btn {
            flex: 0 0 auto;
        }

        .case-title {
            font-size: 1.6rem;
            font-weight: 800;
            background: linear-gradient(45deg, #fbbf24, #f59e0b, #f97316);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            text-shadow: 0 0 25px rgba(251, 191, 36, 0.4);
            letter-spacing: 0.5px;
        }



        .sidebar {
            background: linear-gradient(135deg, rgba(15, 15, 35, 0.98), rgba(26, 26, 46, 0.98));
            border: 2px solid rgba(251, 191, 36, 0.4);
            border-radius: 18px;
            padding: 1.2rem;
            backdrop-filter: blur(20px);
            overflow-y: auto;
            overflow-x: visible;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4), inset 0 1px 0 rgba(251, 191, 36, 0.1);
            min-width: 0;
            max-width: 100%;
        }

        .main-area {
            background: linear-gradient(135deg, rgba(15, 15, 35, 0.98), rgba(26, 26, 46, 0.98));
            border: 2px solid rgba(251, 191, 36, 0.4);
            border-radius: 18px;
            padding: 2rem;
            backdrop-filter: blur(20px);
            overflow: hidden;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4), inset 0 1px 0 rgba(251, 191, 36, 0.1);
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
            align-items: center;
            min-height: calc(100vh - 140px);
            position: relative;
        }

        /* EFEITO DE DESTAQUE PARA A SE√á√ÉO DE CARTAS */
        .main-area::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: radial-gradient(circle at center, rgba(251, 191, 36, 0.05) 0%, transparent 70%);
            pointer-events: none;
            z-index: 1;
        }

        .main-area > * {
            position: relative;
            z-index: 2;
        }

        .section-title {
            font-size: 1.5rem;
            font-weight: 800;
            margin-bottom: 2rem;
            color: #fbbf24;
            border-bottom: 3px solid rgba(251, 191, 36, 0.5);
            padding-bottom: 1rem;
            text-shadow: 0 0 15px rgba(251, 191, 36, 0.5);
            flex-shrink: 0;
            text-align: center;
            letter-spacing: 1px;
            background: linear-gradient(135deg, rgba(251, 191, 36, 0.1), rgba(245, 158, 11, 0.1));
            padding: 1rem 2rem;
            border-radius: 12px;
            border: 1px solid rgba(251, 191, 36, 0.3);
        }

        /* OCULTAR SE√á√ÉO MINHA M√ÉO - VERS√ÉO EXPANDIDA */
        .deck-area,
        .hand-cards,
        .mini-card,
        [class*="hand"],
        [id*="hand"],
        [class*="mao"],
        [id*="mao"],
        [class*="deck"],
        [id*="deck"],
        [data-type*="hand"],
        [data-type*="deck"],
        .sidebar .deck-area,
        .sidebar [class*="hand"],
        .sidebar [class*="mini"],
        .sidebar [class*="card"]:not(.main-area .card) {
            display: none !important;
            visibility: hidden !important;
            opacity: 0 !important;
            height: 0 !important;
            overflow: hidden !important;
        }
        
        /* SISTEMA DE CARTAS - GRID MELHORADO */
        .cards-container {
            display: grid;
            grid-template-columns: repeat(3, 280px);
            grid-template-rows: repeat(2, 280px);
            gap: 2rem;
            justify-content: center;
            align-content: center;
            width: fit-content;
            max-width: 1000px;
            margin: 0 auto;
            padding: 2rem;
            background: rgba(15, 15, 35, 0.4);
            border-radius: 25px;
            border: 3px solid rgba(251, 191, 36, 0.4);
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.4), inset 0 2px 0 rgba(251, 191, 36, 0.1);
            backdrop-filter: blur(10px);
        }
        
        /* Grid espec√≠fico para iniciante (6 cartas = 2x3) */
        .cards-container.beginner {
            grid-template-rows: repeat(2, 280px) !important;
            gap: 2rem !important;
            max-width: 1000px !important;
            padding: 2rem !important;
            align-content: center;
        }
        
        /* Grid espec√≠fico para intermedi√°rio (9 cartas = 3x3) */
        .cards-container.intermediate {
            grid-template-rows: repeat(3, 280px) !important;
            gap: 2rem !important;
            max-width: 1000px !important;
            padding: 2rem !important;
            align-content: center;
        }
        
        /* Grid espec√≠fico para dif√≠cil (12 cartas = 4x3) */
        .cards-container.hard {
            grid-template-rows: repeat(4, 280px) !important;
            gap: 2rem !important;
            max-width: 1000px !important;
            padding: 2rem !important;
            align-content: center;
        }
        
        /* Media queries para responsividade */
        @media (max-width: 1200px) {
            .cards-container {
                max-width: 1200px;
                grid-template-columns: repeat(3, 520px);
                grid-template-rows: repeat(2, 420px);
                gap: 2.5rem;
                padding: 3rem;
            }
            
            .card {
                width: 520px !important;
                height: 420px !important;
            }
            
            .card-icon {
                font-size: 2rem !important;
                top: 25% !important;
                left: 12% !important;
            }
            
            .card-title {
                font-size: 1rem;
            }
            
            .card-description {
                font-size: 1.1rem;
            }
        }
        
        @media (max-width: 768px) {
            .cards-container {
                max-width: 720px;
                grid-template-columns: repeat(2, 350px);
                grid-template-rows: repeat(3, 280px);
                gap: 2rem;
                padding: 2.5rem;
            }
            
            .card {
                width: 350px !important;
                height: 280px !important;
            }
            
            .card-icon {
                font-size: 2rem !important;
                top: 25% !important;
                left: 12% !important;
            }
            
            .card-title {
                font-size: 1rem;
            }
            
            .card-description {
                font-size: 1rem;
            }
        }
        
        @media (max-width: 480px) {
            .cards-container {
                grid-template-columns: repeat(2, 250px);
                grid-template-rows: repeat(3, 200px);
                max-width: 520px;
                gap: 1.5rem;
                padding: 2rem;
            }
            
            .card {
                width: 250px !important;
                height: 200px !important;
            }
            
            .card-icon {
                font-size: 2rem !important;
                top: 25% !important;
                left: 12% !important;
            }
            
            .card-title {
                font-size: 1rem;
            }
            
            .card-description {
                font-size: 0.9rem;
            }
        }

        .card {
            position: relative;
            width: 280px !important;
            height: 280px !important;
            margin: 0;
            border-radius: 18px;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            transform-style: preserve-3d;
            perspective: 1000px;
            background: linear-gradient(135deg, rgba(30, 41, 59, 0.95), rgba(15, 23, 42, 0.98));
            border: 2px solid rgba(251, 191, 36, 0.4);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.5), inset 0 1px 0 rgba(251, 191, 36, 0.1);
            display: flex;
            flex-direction: row;
            align-items: center;
            justify-content: flex-start;
            overflow: hidden;
            padding: 1.8rem;
        }

        .card:hover {
            transform: translateY(-15px) rotateX(8deg) rotateY(8deg) scale(1.05);
            box-shadow: 0 25px 50px rgba(251, 191, 36, 0.3), 0 0 30px rgba(251, 191, 36, 0.2);
            cursor: pointer;
            border-color: rgba(251, 191, 36, 0.8);
        }

        .card:active {
            transform: translateY(-5px) rotateX(2deg) rotateY(2deg);
            box-shadow: 0 15px 30px rgba(251, 191, 36, 0.3);
        }

        .card.played {
            opacity: 0.6;
            transform: scale(0.95);
            filter: grayscale(50%);
            border-color: rgba(107, 114, 128, 0.4);
            background: linear-gradient(135deg, rgba(75, 85, 99, 0.95), rgba(55, 65, 81, 0.98));
            cursor: not-allowed;
        }

        .card.played:hover {
            transform: scale(0.95);
            border-color: rgba(107, 114, 128, 0.4);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.5);
        }

        .card.played::after {
            content: '‚úì';
            position: absolute;
            top: 5px;
            right: 5px;
            background: #10b981;
            color: white;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: bold;
            z-index: 10;
        }

        .card:not(.played) {
            cursor: pointer;
            user-select: none;
        }

        .card:not(.played):hover {
            transform: translateY(-15px) rotateX(8deg) rotateY(8deg) scale(1.05);
            box-shadow: 0 25px 50px rgba(251, 191, 36, 0.3), 0 0 30px rgba(251, 191, 36, 0.2);
            border-color: rgba(251, 191, 36, 0.8);
        }

        .card:not(.played):active {
            transform: translateY(-5px) rotateX(2deg) rotateY(2deg);
            box-shadow: 0 15px 30px rgba(251, 191, 36, 0.3);
        }

        .card-inner {
            position: relative;
            width: 100%;
            height: 100%;
            border-radius: 15px;
            overflow: hidden;
            background: linear-gradient(135deg, rgba(22, 33, 62, 0.9), rgba(15, 15, 35, 0.9));
            border: 2px solid transparent;
            background-clip: padding-box;
        }

        /* RARIDADES DAS CARTAS */
        .card.common .card-inner {
            border-image: linear-gradient(45deg, #6b7280, #9ca3af) 1;
            box-shadow: 0 0 20px rgba(107, 114, 128, 0.3);
        }

        .card.rare .card-inner {
            border-image: linear-gradient(45deg, #3b82f6, #60a5fa) 1;
            box-shadow: 0 0 25px rgba(59, 130, 246, 0.4);
        }

        .card.epic .card-inner {
            border-image: linear-gradient(45deg, #8b5cf6, #a78bfa) 1;
            box-shadow: 0 0 30px rgba(139, 92, 246, 0.5);
        }

        .card.legendary .card-inner {
            border-image: linear-gradient(45deg, #f59e0b, #fbbf24, #f97316) 1;
            box-shadow: 0 0 35px rgba(251, 191, 36, 0.6);
            animation: legendaryGlow 3s ease-in-out infinite alternate;
        }

        @keyframes legendaryGlow {
            0% { box-shadow: 0 0 35px rgba(251, 191, 36, 0.6); }
            100% { box-shadow: 0 0 50px rgba(251, 191, 36, 0.8); }
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem 1.2rem 0.5rem;
        }

        .card-type {
            font-size: 0.8rem;
            font-weight: 600;
            text-transform: uppercase;
            opacity: 0.8;
        }

        .card-rarity {
            position: absolute;
            top: 0.8rem;
            right: 0.8rem;
            font-size: 0.8rem;
            font-weight: 700;
            padding: 0.3rem 0.6rem;
            border-radius: 10px;
            text-transform: uppercase;
            z-index: 3;
            box-shadow: 0 3px 8px rgba(0, 0, 0, 0.4);
        }

        .rarity-common { background: #6b7280; color: white; }
        .rarity-rare { background: #3b82f6; color: white; }
        .rarity-epic { background: #8b5cf6; color: white; }
        .rarity-legendary { 
            background: linear-gradient(45deg, #f59e0b, #fbbf24);
            color: #0f0f23;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        .card-icon {
            font-size: 3rem !important;
            text-align: center !important;
            margin-right: 1.5rem !important;
            filter: drop-shadow(0 0 8px rgba(251, 191, 36, 0.7)) !important;
            flex-shrink: 0 !important;
            color: white !important;
            position: static !important;
            z-index: 1 !important;
        }

        .card-title {
            font-size: 1.2rem !important;
            font-weight: bold !important;
            color: white !important;
            text-align: center !important;
            margin: 0 auto !important;
            text-transform: uppercase !important;
            line-height: 1.4 !important;
            flex: 1 !important;
            position: static !important;
            z-index: 3 !important;
            word-wrap: break-word !important;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.6) !important;
            white-space: normal !important;
            overflow: hidden !important;
            max-width: 180px !important;
            display: flex !important;
            align-items: center !important;
            justify-content: center !important;
        }

        .card-description {
            display: none;
        }
        
        /* Valor num√©rico no canto inferior esquerdo */
        .card-value {
            display: none !important;
        }
        
        .card-value-icon {
            width: 20px !important;
            height: 20px !important;
            background: #fbbf24 !important;
            border-radius: 50% !important;
            display: flex !important;
            align-items: center !important;
            justify-content: center !important;
            font-size: 10px !important;
            color: #000 !important;
            font-weight: bold !important;
        }
        
        .card-value-number {
            font-size: 1rem !important;
            font-weight: bold !important;
            color: white !important;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.5) !important;
        }

        .card-stats {
            display: none;
        }
        
        /* Barra de progresso no centro inferior */
        .card-progress {
            display: none !important;
        }
        
        .card-progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #ef4444, #dc2626);
            border-radius: 3px;
            transition: width 0.3s ease;
            width: 75%; /* Valor padr√£o, ser√° ajustado via JavaScript */
        }

        /* R√≥tulo de raridade */
        .card-rarity {
            position: absolute;
            top: 0.8rem;
            right: 0.8rem;
            background: rgba(59, 130, 246, 0.9);
            color: white;
            padding: 0.2rem 0.5rem;
            border-radius: 12px;
            font-size: 0.7rem;
            font-weight: bold;
            text-transform: uppercase;
            z-index: 3;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
        }

        .card-rarity.epic {
            background: rgba(139, 92, 246, 0.8);
        }

        .card-rarity.legendary {
            background: rgba(245, 158, 11, 0.8);
        }

        .card-rarity.common {
            background: rgba(107, 114, 128, 0.8);
        }

        .stat {
            display: flex;
            align-items: center;
            gap: 0.2rem;
        }
        
        /* Descri√ß√£o/estat√≠stica no canto inferior direito */
        .card-stat {
            display: none !important;
        }

        /* EFEITO DE FLIP DAS CARTAS */
        .card-flip {
            perspective: 1000px;
        }

        .card-flip .card-inner {
            transform-style: preserve-3d;
            transition: transform 0.6s;
        }

        .card-flip.flipped .card-inner {
            transform: rotateY(180deg);
        }

        .card-front, .card-back {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            border-radius: 15px;
        }

        .card-back {
            transform: rotateY(180deg);
            background: linear-gradient(135deg, rgba(15, 15, 35, 0.95), rgba(22, 33, 62, 0.95));
            padding: 1.5rem;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        /* DECK E M√ÉO DE CARTAS */
        .deck-area {
            margin-top: 2rem;
            padding: 1.5rem;
            background: rgba(22, 33, 62, 0.6);
            border: 2px solid rgba(251, 191, 36, 0.2);
            border-radius: 15px;
        }

        .hand-cards {
            display: flex;
            gap: 1rem;
            overflow-x: auto;
            padding: 1rem 0;
        }

        .mini-card {
            min-width: 120px;
            height: 80px;
            border-radius: 8px;
            background: linear-gradient(135deg, rgba(22, 33, 62, 0.9), rgba(15, 15, 35, 0.9));
            border: 1px solid rgba(251, 191, 36, 0.3);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .mini-card:hover {
            transform: translateY(-5px);
            border-color: #fbbf24;
            box-shadow: 0 10px 20px rgba(251, 191, 36, 0.2);
        }

        .mini-card-icon {
            font-size: 1.5rem;
            margin-bottom: 0.3rem;
        }

        .mini-card-title {
            font-size: 0.7rem;
            font-weight: 600;
            color: #fbbf24;
            text-align: center;
        }

        /* BOT√ïES MODERNOS */
        .btn {
            background: linear-gradient(135deg, #fbbf24, #f59e0b);
            color: #0f0f23;
            border: none;
            padding: 0.8rem 1.5rem;
            border-radius: 12px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(251, 191, 36, 0.3);
            text-transform: uppercase;
            font-size: 0.85rem;
            letter-spacing: 0.5px;
            position: relative;
            overflow: hidden;
        }

        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(251, 191, 36, 0.5);
            background: linear-gradient(135deg, #f59e0b, #fbbf24);
        }

        .btn:active {
            transform: translateY(-1px);
        }

        .btn-danger {
            background: linear-gradient(135deg, #ef4444, #dc2626);
            color: white;
            box-shadow: 0 4px 15px rgba(239, 68, 68, 0.3);
        }

        .btn-danger:hover {
            box-shadow: 0 8px 25px rgba(239, 68, 68, 0.5);
            background: linear-gradient(135deg, #dc2626, #ef4444);
        }

        .btn-exit {
            background: linear-gradient(135deg, #4b5563, #374151);
            color: white;
            border: 2px solid #9ca3af;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
        }

        .btn-exit:hover {
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.4);
            border-color: #d1d5db;
            background: linear-gradient(135deg, #6b7280, #4b5563);
        }



        .timer-highlighted {
            font-size: 1.2rem;
            font-weight: bold;
            color: #ef4444;
            text-shadow: 0 0 10px rgba(239, 68, 68, 0.6);
            background: rgba(239, 68, 68, 0.2);
            padding: 0.3rem 0.8rem;
            border-radius: 6px;
            border: 1px solid rgba(239, 68, 68, 0.4);
        }





        /* MODAL MODERNO */
        .modal {
            display: none;
            position: fixed;
            z-index: 2000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.9);
            backdrop-filter: blur(10px);
        }

        .modal-content {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: linear-gradient(135deg, #1a1a2e, #16213e);
            border: 3px solid #fbbf24;
            border-radius: 20px;
            padding: 2.5rem;
            max-width: 700px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
        }

        .close {
            color: #aaa;
            float: right;
            font-size: 32px;
            font-weight: bold;
            cursor: pointer;
            transition: color 0.3s ease;
        }

        .close:hover {
            color: #fbbf24;
            text-shadow: 0 0 10px rgba(251, 191, 36, 0.5);
        }

        /* PROGRESS BARS MODERNAS */
        .progress-bar {
            width: 100%;
            height: 12px;
            background: rgba(15, 15, 35, 0.8);
            border-radius: 6px;
            margin-top: 1rem;
            overflow: hidden;
            border: 1px solid rgba(251, 191, 36, 0.2);
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #fbbf24, #f59e0b, #f97316);
            transition: width 0.5s ease;
            box-shadow: 0 0 20px rgba(251, 191, 36, 0.3);
        }

        /* CHAT MODERNO */
        .chat-container {
            height: 200px;
            background: rgba(15, 15, 35, 0.6);
            border: 2px solid rgba(251, 191, 36, 0.3);
            border-radius: 15px;
            padding: 1rem;
            margin-bottom: 1.5rem;
            overflow-y: auto;
            overflow-x: hidden;
            backdrop-filter: blur(10px);
            width: 100%;
            box-sizing: border-box;
        }

        .chat-message {
            margin-bottom: 0.8rem;
            padding: 0.8rem;
            background: linear-gradient(135deg, rgba(15, 15, 35, 0.8), rgba(26, 26, 46, 0.8));
            border-radius: 10px;
            border-left: 3px solid #fbbf24;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
            transition: all 0.3s ease;
        }

        .chat-message:hover {
            transform: translateX(2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }

        .chat-message-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.4rem;
        }

        .chat-user {
            font-weight: bold;
            color: #fbbf24;
            font-size: 0.9rem;
        }

        .chat-time {
            font-size: 0.7rem;
            color: #6b7280;
            opacity: 0.8;
        }

        .chat-content {
            color: #e2e8f0;
            font-size: 0.85rem;
            line-height: 1.4;
        }

        .chat-input-container {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
            margin-top: 1rem;
            width: 100%;
            box-sizing: border-box;
            max-width: 100%;
        }

        .chat-input-field {
            width: 100%;
            padding: 1rem 1.2rem;
            border: 2px solid rgba(251, 191, 36, 0.3);
            border-radius: 15px;
            background: rgba(15, 15, 35, 0.9);
            color: white;
            font-size: 0.95rem;
            font-weight: 500;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
            box-sizing: border-box;
        }

        .chat-input-field:focus {
            outline: none;
            border-color: #fbbf24;
            box-shadow: 0 0 20px rgba(251, 191, 36, 0.4);
            background: rgba(15, 15, 35, 0.95);
            transform: translateY(-2px);
        }

        .chat-input-field::placeholder {
            color: rgba(203, 213, 225, 0.6);
            font-style: italic;
        }

        /* BOT√ÉO ENVIAR FULL-WIDTH - EMBAIXO DO INPUT */
        .send-button {
            background: linear-gradient(135deg, #fbbf24, #f59e0b, #f97316);
            color: #0f0f23;
            border: none;
            padding: 1rem 1.5rem;
            border-radius: 12px;
            font-weight: 800;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            box-shadow: 0 4px 15px rgba(251, 191, 36, 0.4);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            width: 100%;
            position: relative;
            overflow: hidden;
            border: 2px solid transparent;
            background-clip: padding-box;
            box-sizing: border-box;
        }

        .send-button::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            transition: left 0.6s ease;
        }

        .send-button:hover {
            transform: translateY(-4px) scale(1.05);
            box-shadow: 0 10px 30px rgba(251, 191, 36, 0.6);
            background: linear-gradient(135deg, #f59e0b, #fbbf24, #f97316);
            border-color: rgba(251, 191, 36, 0.8);
        }

        .send-button:hover::before {
            left: 100%;
        }

        .send-button:active {
            transform: translateY(-2px) scale(0.95);
            box-shadow: 0 6px 20px rgba(251, 191, 36, 0.5);
            transition: all 0.1s ease;
        }

        .send-button:focus {
            outline: none;
            box-shadow: 0 0 0 3px rgba(251, 191, 36, 0.3);
        }

        .send-button-icon {
            font-size: 1.2rem;
            transition: transform 0.3s ease;
        }

        .send-button:hover .send-button-icon {
            transform: translateX(3px) scale(1.1);
        }

        .send-button-text {
            font-size: 0.9rem;
            font-weight: 800;
            transition: all 0.3s ease;
        }

        .send-button-ripple {
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.6);
            transform: translate(-50%, -50%);
            transition: width 0.6s ease, height 0.6s ease;
            pointer-events: none;
        }

        .send-button:active .send-button-ripple {
            width: 100px;
            height: 100px;
        }

        /* ANIMA√á√ÉO DE PULSE PARA CHAMAR ATEN√á√ÉO */
        @keyframes sendPulse {
            0% { box-shadow: 0 4px 15px rgba(251, 191, 36, 0.4); }
            50% { box-shadow: 0 4px 25px rgba(251, 191, 36, 0.7); }
            100% { box-shadow: 0 4px 15px rgba(251, 191, 36, 0.4); }
        }

        .send-button.highlight {
            animation: sendPulse 1.5s ease-in-out infinite;
        }

        /* RESPONSIVIDADE DO CHAT MELHORADA - LAYOUT VERTICAL */
        @media (max-width: 1024px) {
            .chat-input-container {
                gap: 0.6rem;
            }
            
            .chat-input-field {
                padding: 0.9rem 1rem;
                font-size: 0.9rem;
            }
            
            .send-button {
                padding: 0.9rem 1.2rem;
                font-size: 0.85rem;
                gap: 0.4rem;
            }
        }

        @media (max-width: 768px) {
            .chat-input-container {
                gap: 0.5rem;
            }
            
            .chat-input-field {
                padding: 0.8rem 1rem;
                font-size: 0.85rem;
                border-radius: 10px;
            }
            
            .send-button {
                padding: 0.8rem 1rem;
                font-size: 0.8rem;
                gap: 0.3rem;
                border-radius: 10px;
            }
            
            .send-button-text {
                font-size: 0.8rem;
            }
            
            .send-button-icon {
                font-size: 1.1rem;
            }
        }

        @media (max-width: 480px) {
            .chat-input-container {
                gap: 0.4rem;
            }
            
            .chat-input-field {
                padding: 0.7rem 0.9rem;
                font-size: 0.8rem;
                border-radius: 8px;
            }
            
            .send-button {
                padding: 0.7rem 0.8rem;
                font-size: 0.75rem;
                gap: 0.2rem;
                border-radius: 8px;
            }
            
            .send-button-text {
                font-size: 0.75rem;
            }
            
            .send-button-icon {
                font-size: 1rem;
            }
        }

        @media (max-width: 360px) {
            .chat-input-container {
                gap: 0.3rem;
            }
            
            .chat-input-field {
                padding: 0.6rem 0.8rem;
                font-size: 0.75rem;
            }
            
            .send-button {
                padding: 0.6rem 0.7rem;
                font-size: 0.7rem;
                gap: 0.15rem;
            }
            
            .send-button-text {
                font-size: 0.7rem;
            }
            
            .send-button-icon {
                font-size: 0.9rem;
            }
        }

        /* CORRE√á√ïES CR√çTICAS DE LAYOUT */
            .game-container {
            display: grid !important;
            grid-template-columns: 300px 1fr 300px !important;
            grid-template-rows: 80px 1fr !important;
            height: 100vh !important;
            gap: 1rem !important;
            padding: 1rem !important;
            max-width: 100vw !important;
            overflow: hidden !important;
            }




        
        .sidebar {
            padding: 1rem !important;
            overflow-y: auto !important;
            overflow-x: hidden !important;
            max-height: calc(100vh - 120px) !important;
            display: flex !important;
            flex-direction: column !important;
        }
        
        /* Corre√ß√£o espec√≠fica para sidebar direita com cartas */
        .sidebar:last-child {
            padding-bottom: 2rem !important;
        }
        
        .deck-area {
            margin-bottom: 2rem !important;
        }
        
        .main-area {
            padding: 1.5rem !important;
            overflow-y: auto !important;
            overflow-x: hidden !important;
            max-height: calc(100vh - 120px) !important;
        }

        /* MODAL DE DETALHES DAS CARTAS */
        .card-details-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 10000;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .modal-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }

        .modal-content {
            background: linear-gradient(135deg, rgba(30, 41, 59, 0.95), rgba(15, 23, 42, 0.98));
            border: 3px solid rgba(251, 191, 36, 0.6);
            border-radius: 20px;
            padding: 2rem;
            max-width: 600px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            position: fixed;
            left: 50%;
            top: 50%;
            transform: translate(-50%, -50%) scale(0.8);
            transition: transform 0.3s ease;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
            z-index: 10001;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 2px solid rgba(251, 191, 36, 0.3);
        }

        .modal-header h2 {
            color: #fbbf24;
            margin: 0;
            font-size: 1.5rem;
            text-shadow: 0 0 10px rgba(251, 191, 36, 0.5);
        }

        .close-btn {
            background: none;
            border: none;
            color: #fbbf24;
            font-size: 2rem;
            cursor: pointer;
            padding: 0;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: all 0.3s ease;
        }

        .close-btn:hover {
            background: rgba(251, 191, 36, 0.2);
            transform: scale(1.1);
        }

        .card-detail-main {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 1.5rem;
            padding: 1rem;
            background: rgba(251, 191, 36, 0.1);
            border-radius: 15px;
            border: 1px solid rgba(251, 191, 36, 0.3);
        }

        .detail-icon {
            font-size: 3rem;
            filter: drop-shadow(0 0 10px rgba(251, 191, 36, 0.5));
        }

        .detail-info h3 {
            color: white;
            margin: 0 0 0.5rem 0;
            font-size: 1.3rem;
        }

        .detail-type, .detail-rarity {
            color: #fbbf24;
            margin: 0.2rem 0;
            font-size: 0.9rem;
        }

        .card-detail-description, .card-detail-clues, .card-detail-stats {
            margin-bottom: 1.5rem;
        }

        .card-detail-description h4, .card-detail-clues h4, .card-detail-stats h4 {
            color: #fbbf24;
            margin-bottom: 0.8rem;
            font-size: 1.1rem;
        }

        .card-detail-description p {
            color: #e5e7eb;
            line-height: 1.6;
            margin: 0;
        }

        .card-detail-clues ul {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .card-detail-clues li {
            color: #e5e7eb;
            padding: 0.5rem 0;
            border-bottom: 1px solid rgba(251, 191, 36, 0.2);
            position: relative;
            padding-left: 1.5rem;
        }

        .card-detail-clues li:before {
            content: 'üîç';
            position: absolute;
            left: 0;
            top: 0.5rem;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 0.8rem;
        }

        .stat-item {
            background: rgba(251, 191, 36, 0.1);
            padding: 0.8rem;
            border-radius: 10px;
            text-align: center;
            color: #fbbf24;
            border: 1px solid rgba(251, 191, 36, 0.3);
        }

        .card-actions {
            display: flex;
            gap: 1rem;
            justify-content: center;
            margin-top: 2rem;
        }

        .btn-play, .btn-close {
            padding: 0.8rem 1.5rem;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
        }

        .btn-play {
            background: linear-gradient(135deg, #10b981, #059669);
            color: white;
        }

        .btn-play:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 15px rgba(16, 185, 129, 0.4);
        }

        .btn-close {
            background: linear-gradient(135deg, #ef4444, #dc2626);
            color: white;
        }

        .btn-close:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 15px rgba(239, 68, 68, 0.4);
        }

        .btn-view-cards {
            background: linear-gradient(135deg, #8b5cf6, #7c3aed);
            color: white;
            border: 2px solid #8b5cf6;
            box-shadow: 0 4px 15px rgba(139, 92, 246, 0.3);
        }

        .btn-view-cards:hover {
            background: linear-gradient(135deg, #7c3aed, #6d28d9);
            transform: scale(1.05);
            box-shadow: 0 6px 20px rgba(139, 92, 246, 0.4);
        }

        .btn-secondary {
            background: linear-gradient(135deg, #6b7280, #4b5563);
            color: white;
            border: 2px solid #6b7280;
            box-shadow: 0 4px 15px rgba(107, 114, 128, 0.3);
        }

        .btn-secondary:hover {
            background: linear-gradient(135deg, #4b5563, #374151);
            transform: scale(1.05);
            box-shadow: 0 6px 20px rgba(107, 114, 128, 0.4);
        }

        .card-status.played {
            color: #10b981;
            font-weight: bold;
            font-size: 0.9rem;
        }

        .all-cards-modal {
            max-width: 800px !important;
            max-height: 90vh !important;
        }

        .all-cards-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
            max-height: 60vh;
            overflow-y: auto;
        }

        .all-cards-item {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1rem;
            background: rgba(251, 191, 36, 0.1);
            border: 1px solid rgba(251, 191, 36, 0.3);
            border-radius: 10px;
            transition: all 0.3s ease;
        }

        .all-cards-item.played {
            opacity: 0.6;
            background: rgba(16, 185, 129, 0.1);
            border-color: rgba(16, 185, 129, 0.3);
        }

        .all-cards-icon {
            font-size: 2rem;
            filter: drop-shadow(0 0 5px rgba(251, 191, 36, 0.5));
        }

        .all-cards-info h4 {
            color: white;
            margin: 0 0 0.3rem 0;
            font-size: 1rem;
        }

        .all-cards-info p {
            color: #fbbf24;
            margin: 0 0 0.5rem 0;
            font-size: 0.8rem;
        }

        .played-badge {
            background: #10b981;
            color: white;
            padding: 0.2rem 0.5rem;
            border-radius: 15px;
            font-size: 0.7rem;
            font-weight: bold;
        }

        .available-badge {
            background: #fbbf24;
            color: #1f2937;
            padding: 0.2rem 0.5rem;
            border-radius: 15px;
            font-size: 0.7rem;
            font-weight: bold;
        }
        
        /* Estilos para intera√ß√£o com detalhes das cartas */
        .all-cards-item:hover {
            background: rgba(251, 191, 36, 0.2);
            border-color: rgba(251, 191, 36, 0.6);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(251, 191, 36, 0.3);
        }
        
        .all-cards-action {
            margin-left: auto;
        }
        
        .view-details-btn {
            color: #fbbf24;
            font-size: 0.8rem;
            opacity: 0.8;
            transition: opacity 0.3s ease;
        }
        
        .all-cards-item:hover .view-details-btn {
            opacity: 1;
        }
        
        /* Estilos para o modal de detalhes */
        .card-details-content {
            max-width: 600px;
            max-height: 80vh;
            overflow-y: auto;
        }
        
        .card-details-header {
            display: flex;
            align-items: center;
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid #374151;
        }
        
        .card-details-icon {
            font-size: 3rem;
            margin-right: 1rem;
        }
        
        .card-details-info h3 {
            margin: 0 0 0.5rem 0;
            color: #f9fafb;
        }
        
        .card-type {
            color: #9ca3af;
            margin: 0 0 0.5rem 0;
        }
        
        .card-status {
            color: #10b981;
            font-weight: bold;
            margin: 0;
        }
        
        .card-details-section {
            margin-bottom: 1.5rem;
        }
        
        .card-details-section h4 {
            color: #fbbf24;
            margin-bottom: 0.75rem;
            font-size: 1.1rem;
        }
        
        .investigation-clues {
            list-style: none;
            padding: 0;
        }
        
        .investigation-clues li {
            padding: 0.5rem 0;
            border-bottom: 1px solid #374151;
            color: #d1d5db;
        }
        
        .investigation-clues li:last-child {
            border-bottom: none;
        }
        
        .card-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 1rem;
        }
        
        .stat-item {
            display: flex;
            justify-content: space-between;
            padding: 0.75rem;
            background: #374151;
            border-radius: 6px;
        }
        
        .stat-label {
            color: #9ca3af;
        }
        
        .stat-value {
            color: #fbbf24;
            font-weight: bold;
        }
        
        .card-details-actions {
            text-align: center;
            margin-top: 1.5rem;
            padding-top: 1rem;
            border-top: 1px solid #374151;
        }
        
        /* Melhorias no layout das cartas */
        .card-action {
            position: absolute;
            bottom: 0.5rem;
            left: 0;
            right: 0;
            text-align: center;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        
        .card:hover .card-action {
            opacity: 1;
        }
        
        .view-details-hint {
            color: #fbbf24;
            font-size: 0.8rem;
            font-weight: bold;
            text-shadow: 0 0 5px rgba(251, 191, 36, 0.5);
        }
        
        /* Melhorias no modal de detalhes */
        .card-details-content {
            max-width: 700px;
            max-height: 85vh;
            overflow-y: auto;
            background: linear-gradient(135deg, #1f2937, #111827);
            border: 2px solid #fbbf24;
            border-radius: 15px;
        }
        
        .card-effects {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 0.75rem;
            margin-top: 0.5rem;
        }
        
        .effect-item {
            background: rgba(251, 191, 36, 0.1);
            border: 1px solid rgba(251, 191, 36, 0.3);
            border-radius: 8px;
            padding: 0.75rem;
            font-size: 0.9rem;
            color: #d1d5db;
        }
        
        .effect-item:hover {
            background: rgba(251, 191, 36, 0.2);
            border-color: rgba(251, 191, 36, 0.5);
        }
        
        /* Melhorias na responsividade das cartas */
        .cards-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1.5rem;
            padding: 2rem;
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .card {
            position: relative;
            width: 100%;
            height: 320px;
            margin: 0;
            border-radius: 18px;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            transform-style: preserve-3d;
            perspective: 1000px;
            background: linear-gradient(135deg, rgba(30, 41, 59, 0.95), rgba(15, 23, 42, 0.98));
            border: 2px solid rgba(251, 191, 36, 0.4);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.5), inset 0 1px 0 rgba(251, 191, 36, 0.1);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: space-between;
            overflow: hidden;
            padding: 1.5rem;
        }
        
        .card-inner {
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            align-items: center;
            text-align: center;
        }
        
        .card-header {
            width: 100%;
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }
        
        .card-type {
            color: #9ca3af;
            font-size: 0.8rem;
            font-weight: bold;
        }
        
        .card-rarity {
            color: #fbbf24;
            font-size: 0.7rem;
            font-weight: bold;
            padding: 0.2rem 0.5rem;
            border-radius: 10px;
            background: rgba(251, 191, 36, 0.1);
        }
        
        .card-icon {
            font-size: 3rem;
            margin: 1rem 0;
            filter: drop-shadow(0 0 10px rgba(251, 191, 36, 0.5));
        }
        
        .card-title {
            color: #f9fafb;
            font-size: 1.1rem;
            font-weight: bold;
            margin-bottom: 0.5rem;
            line-height: 1.3;
        }
        
        .card-description {
            color: #d1d5db;
            font-size: 0.9rem;
            line-height: 1.4;
            margin-bottom: 1rem;
            flex-grow: 1;
        }
        
        .card-stats {
            display: flex;
            gap: 1rem;
            margin-bottom: 1rem;
        }
        
        .stat {
            color: #fbbf24;
            font-size: 0.8rem;
            font-weight: bold;
        }

        /* RESPONSIVIDADE B√ÅSICA */
        @media (max-width: 1400px) {
            .game-container {
                grid-template-columns: 280px 1fr 280px !important;
            }
        }
        
        @media (max-width: 1200px) {
            .game-container {
                grid-template-columns: 1fr !important;
                grid-template-rows: auto auto 1fr auto !important;
                height: auto !important;
                min-height: 100vh !important;
                padding: 0.8rem !important;
            }

            .sidebar {
                padding: 1rem 0.8rem !important;
                overflow-x: visible !important;
                max-height: none !important;
            }
            
            .main-area {
                max-height: none !important;
            }
            
            .chat-input-container {
                max-width: 100% !important;
            }
        }
        
        /* CORRE√á√ïES ESPEC√çFICAS PARA MINHA M√ÉO - LAYOUT 3 COLUNAS */
        .hand-cards {
            display: grid !important;
            grid-template-columns: repeat(3, 1fr) !important;
            gap: 1rem !important;
            margin-top: 1rem !important;
            margin-bottom: 1.5rem !important;
            padding: 1.5rem !important;
            background: rgba(15, 15, 35, 0.7) !important;
            border-radius: 20px !important;
            border: 2px solid rgba(251, 191, 36, 0.5) !important;
            box-shadow: 0 6px 30px rgba(0, 0, 0, 0.4) !important;
            max-width: 100% !important;
            }

            .mini-card {
            height: 150px !important;
            min-height: 150px !important;
            display: flex !important;
            flex-direction: column !important;
            justify-content: space-between !important;
            align-items: center !important;
            background: linear-gradient(135deg, #1a1a2e, #16213e, #1e1e3f) !important;
            border: 2px solid rgba(251, 191, 36, 0.4) !important;
            border-radius: 15px !important;
            padding: 1rem !important;
            cursor: pointer !important;
            transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275) !important;
            text-align: center !important;
            position: relative !important;
            overflow: visible !important;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3) !important;
        }
        
        .mini-card:hover {
            transform: translateY(-4px) scale(1.05) !important;
            border-color: rgba(251, 191, 36, 0.8) !important;
            box-shadow: 0 8px 25px rgba(251, 191, 36, 0.3) !important;
            background: linear-gradient(135deg, #1e1e3f, #1a2040) !important;
        }
        
        .mini-card:active {
            transform: translateY(-2px) scale(1.02) !important;
        }
        
        .mini-card-icon {
            font-size: 2rem !important;
            margin-bottom: 0.75rem !important;
            filter: drop-shadow(0 0 10px rgba(251, 191, 36, 0.5)) !important;
            flex-shrink: 0 !important;
        }
        
        .mini-card-title {
            font-size: 0.9rem !important;
            color: #fbbf24 !important;
            font-weight: 700 !important;
            line-height: 1.2 !important;
            text-shadow: 0 0 8px rgba(251, 191, 36, 0.4) !important;
            white-space: normal !important;
            overflow: visible !important;
            text-overflow: unset !important;
            width: 100% !important;
            text-align: center !important;
            margin-top: auto !important;
        }
        
        /* Bot√µes da √°rea de m√£o */
        .hand-buttons {
            display: flex !important;
            gap: 0.5rem !important;
            margin-top: 1rem !important;
            justify-content: center !important;
            flex-wrap: wrap !important;
        }
        
        .hand-buttons button {
            padding: 0.5rem 1rem !important;
            font-size: 0.85rem !important;
            min-width: auto !important;
            flex: none !important;
        }
        
        /* Responsividade para m√£o - Layout 3 colunas otimizado */
        @media (max-width: 768px) {
            .hand-cards {
                grid-template-columns: repeat(3, 1fr) !important;
                gap: 0.75rem !important;
                padding: 1.25rem !important;
            }
            
            .mini-card {
                height: 140px !important;
                min-height: 140px !important;
                padding: 0.75rem !important;
            }
            
            .mini-card-icon {
                font-size: 1.75rem !important;
                margin-bottom: 0.5rem !important;
            }
            
            .mini-card-title {
                font-size: 0.8rem !important;
                line-height: 1.1 !important;
            }
        }
        
        @media (max-width: 480px) {
            .hand-cards {
                grid-template-columns: repeat(2, 1fr) !important;
                gap: 0.75rem !important;
                padding: 1rem !important;
            }
            
            .mini-card {
                height: 130px !important;
                min-height: 130px !important;
                padding: 0.75rem !important;
            }
            
            .mini-card-icon {
                font-size: 1.5rem !important;
                margin-bottom: 0.5rem !important;
            }
            
            .mini-card-title {
                font-size: 0.75rem !important;
                line-height: 1.1 !important;
            }
        }
        
        @media (max-width: 360px) {
            .hand-cards {
                grid-template-columns: repeat(2, 1fr) !important;
                gap: 0.5rem !important;
                padding: 0.75rem !important;
            }
            
            .mini-card {
                height: 120px !important;
                min-height: 120px !important;
                padding: 0.5rem !important;
            }
            
            .mini-card-icon {
                font-size: 1.25rem !important;
                margin-bottom: 0.25rem !important;
            }
            
            .mini-card-title {
                font-size: 0.7rem !important;
                line-height: 1 !important;
            }
        }

        /* ANIMA√á√ïES EXTRAS */
        @keyframes cardAppear {
            0% {
                opacity: 0;
                transform: translateY(50px) rotateX(-30deg);
            }
            100% {
                opacity: 1;
                transform: translateY(0) rotateX(0);
            }
        }

        @keyframes slideIn {
            0% {
                opacity: 0;
                transform: translateX(50px) scale(0.8);
            }
            100% {
                opacity: 1;
                transform: translateX(0) scale(1);
            }
        }

        /* EFEITOS PARA BOT√ÉO DISABLED */
        .send-button:disabled {
            opacity: 0.7;
            cursor: not-allowed;
            transform: none !important;
        }

        .send-button:disabled:hover {
            transform: none !important;
            box-shadow: 0 4px 15px rgba(251, 191, 36, 0.3) !important;
        }

        .card {
            animation: cardAppear 0.6s ease-out;
        }

        .card:nth-child(1) { animation-delay: 0.1s; }
        .card:nth-child(2) { animation-delay: 0.2s; }
        .card:nth-child(3) { animation-delay: 0.3s; }
        .card:nth-child(4) { animation-delay: 0.4s; }
        .card:nth-child(5) { animation-delay: 0.5s; }
        .card:nth-child(6) { animation-delay: 0.6s; }

        /* FOR√áAR LAYOUT 3 COLUNAS - M√ÅXIMA ESPECIFICIDADE */
        html body .sidebar .deck-area .hand-cards {
            display: grid !important;
            grid-template-columns: repeat(3, 1fr) !important;
            gap: 1rem !important;
            margin-top: 1rem !important;
            margin-bottom: 1.5rem !important;
            padding: 1.5rem !important;
            background: rgba(15, 15, 35, 0.7) !important;
            border-radius: 20px !important;
            border: 2px solid rgba(251, 191, 36, 0.5) !important;
            box-shadow: 0 6px 30px rgba(0, 0, 0, 0.4) !important;
            max-width: 100% !important;
        }

        html body .sidebar .deck-area .hand-cards .mini-card {
            height: 150px !important;
            min-height: 150px !important;
            display: flex !important;
            flex-direction: column !important;
            justify-content: space-between !important;
            align-items: center !important;
            background: linear-gradient(135deg, #1a1a2e, #16213e, #1e1e3f) !important;
            border: 2px solid rgba(251, 191, 36, 0.4) !important;
            border-radius: 15px !important;
            padding: 1rem !important;
            cursor: pointer !important;
            transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275) !important;
            text-align: center !important;
            position: relative !important;
            overflow: visible !important;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3) !important;
        }

        html body .sidebar .deck-area .hand-cards .mini-card:hover {
            transform: translateY(-4px) scale(1.05) !important;
            border-color: rgba(251, 191, 36, 0.8) !important;
            box-shadow: 0 8px 25px rgba(251, 191, 36, 0.3) !important;
            background: linear-gradient(135deg, #1e1e3f, #1a2040) !important;
        }

        html body .sidebar .deck-area .hand-cards .mini-card-icon {
            font-size: 2rem !important;
            margin-bottom: 0.75rem !important;
            filter: drop-shadow(0 0 10px rgba(251, 191, 36, 0.5)) !important;
            flex-shrink: 0 !important;
        }

        html body .sidebar .deck-area .hand-cards .mini-card-title {
            font-size: 0.9rem !important;
            color: #fbbf24 !important;
            font-weight: 700 !important;
            line-height: 1.2 !important;
            text-shadow: 0 0 8px rgba(251, 191, 36, 0.4) !important;
            white-space: normal !important;
            overflow: visible !important;
            text-overflow: unset !important;
            width: 100% !important;
            text-align: center !important;
            margin-top: auto !important;
        }

        /* ESTILOS PARA CONQUISTAS RECENTES */
        .achievements-container {
            max-height: 300px;
            overflow-y: auto;
            padding-right: 5px;
        }

        .achievement-item {
            margin-bottom: 0.8rem;
            padding: 0.8rem;
            border-radius: 12px;
            border-left: 4px solid;
            background: rgba(15, 15, 35, 0.8);
            backdrop-filter: blur(10px);
            animation: achievementSlideIn 0.5s ease-out;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .achievement-item:hover {
            transform: translateX(5px);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
        }

        .achievement-item.gold {
            border-left-color: #fbbf24;
            background: linear-gradient(135deg, rgba(251, 191, 36, 0.1), rgba(15, 15, 35, 0.9));
            box-shadow: 0 0 15px rgba(251, 191, 36, 0.2);
        }

        .achievement-item.silver {
            border-left-color: #94a3b8;
            background: linear-gradient(135deg, rgba(148, 163, 184, 0.1), rgba(15, 15, 35, 0.9));
            box-shadow: 0 0 15px rgba(148, 163, 184, 0.2);
        }

        .achievement-item.bronze {
            border-left-color: #f97316;
            background: linear-gradient(135deg, rgba(249, 115, 22, 0.1), rgba(15, 15, 35, 0.9));
            box-shadow: 0 0 15px rgba(249, 115, 22, 0.2);
        }

        .achievement-item.rare {
            border-left-color: #8b5cf6;
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.1), rgba(15, 15, 35, 0.9));
            box-shadow: 0 0 15px rgba(139, 92, 246, 0.2);
        }

        .achievement-icon {
            font-size: 1.2rem;
            margin-right: 0.5rem;
            filter: drop-shadow(0 0 5px rgba(251, 191, 36, 0.5));
        }

        .achievement-title {
            font-weight: 700;
            font-size: 0.9rem;
            color: #fbbf24;
            margin-bottom: 0.2rem;
            text-shadow: 0 0 5px rgba(251, 191, 36, 0.3);
        }

        .achievement-description {
            font-size: 0.75rem;
            color: #94a3b8;
            line-height: 1.2;
        }

        .achievement-reward {
            position: absolute;
            top: 0.5rem;
            right: 0.5rem;
            font-size: 0.7rem;
            color: #10b981;
            font-weight: 600;
            background: rgba(16, 185, 129, 0.1);
            padding: 0.2rem 0.4rem;
            border-radius: 6px;
            border: 1px solid rgba(16, 185, 129, 0.2);
        }

        .achievement-timestamp {
            font-size: 0.65rem;
            color: #64748b;
            margin-top: 0.3rem;
            font-style: italic;
        }

        @keyframes achievementSlideIn {
            from {
                opacity: 0;
                transform: translateX(-20px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        .achievements-container::-webkit-scrollbar {
            width: 4px;
        }

        .achievements-container::-webkit-scrollbar-track {
            background: rgba(15, 15, 35, 0.5);
            border-radius: 2px;
        }

        .achievements-container::-webkit-scrollbar-thumb {
            background: rgba(251, 191, 36, 0.3);
            border-radius: 2px;
        }

        .achievements-container::-webkit-scrollbar-thumb:hover {
            background: rgba(251, 191, 36, 0.5);
        }




    </style>
    <!-- Criminal Minds API v2.0 - Sistema Melhorado -->
    <script src="js/api-client-simple.js?v=20241209_1"></script>
    <script src="js/game-functions.js?v=20241209_1"></script>
    <script defer src="js/comprehensive-test-system.js?v=20241209_1"></script>
    <script defer src="js/enhanced-game-system.js?v=20241209_1"></script>
    <script defer src="js/complete-hand-system.js?v=20241209_1"></script>
    <!-- AggressiveFix desativado nesta tela -->
    <script defer src="js/layout-fix-system.js?v=20241209_1"></script>
    <script defer src="js/layout-diagnostic-system.js?v=20241209_1"></script>
    <script defer src="js/layout-repair-system.js?v=20241209_1"></script>
</head>
<body>
    <div class="game-container">
        <div class="header">
            <div style="display: flex; align-items: center; gap: 1rem; margin-right: 2rem;">
                <button class="btn btn-exit" onclick="exitGame()">‚Üê SAIR</button>
            </div>
            <div style="display: flex; align-items: center; justify-content: center; flex: 1; margin: 0 3rem;">
                <div class="case-title" style="color: #fbbf24; font-size: 1.6rem;">üü° CRIMINAL MINDS: INICIANTE</div>
            </div>
            <div style="display: flex; align-items: center; gap: 1rem; margin-left: 2rem;">
                <button class="btn btn-view-cards" onclick="showAllCards()">üëÅÔ∏è Ver Todas as Cartas</button>

                <button class="btn btn-danger" onclick="makeAccusation()">ACUSAR</button>
            </div>
        </div>

        <div class="sidebar">
            <div class="section-title">üïµÔ∏è Equipe Online</div>
            <div class="team-list" id="teamList">
                <div class="chat-message">
                    <span class="chat-user">üëë Detetive Reid:</span> Online - 127 cartas
                </div>
                <div class="chat-message">
                    <span class="chat-user">üîç Agente Morgan:</span> Online - 98 cartas
                </div>
                <div class="chat-message">
                    <span class="chat-user">üìä Dra. Brennan:</span> Online - 156 cartas
                </div>
            </div>

            <div class="section-title" style="margin-top: 2rem;">üí¨ Chat da Equipe</div>
            <div class="chat-container" id="chatContainer">
                <div class="chat-message">
                    <span class="chat-user">üëë Reid:</span> Acabei de encontrar uma carta LEND√ÅRIA! üî•
                </div>
                <div class="chat-message">
                    <span class="chat-user">üîç Morgan:</span> Vou jogar minha carta de Interrogat√≥rio
                </div>
                <div class="chat-message">
                    <span class="chat-user">üìä Brennan:</span> Combo perfeito de evid√™ncias! +50 pontos
                </div>
            </div>
            <div class="chat-input-container">
                <input type="text" id="chatInput" placeholder="Digite sua mensagem..." maxlength="200" class="chat-input-field">
                <button id="sendButton" class="send-button" onclick="sendUserMessage()" title="Enviar mensagem (Enter)" aria-label="Enviar mensagem">
                    <span class="send-button-text">Enviar</span>
                    <span class="send-button-icon">üì§</span>
                    <div class="send-button-ripple"></div>
                </button>
            </div>
        </div>

        <div class="main-area">
            <div class="section-title">
                üÉè Cartas de Investiga√ß√£o Ativas
            </div>
            <div class="cards-container" id="cardsContainer">
                <!-- Carta 1: Equipamento (√âpica) -->
                <div class="card epic" data-type="equipment" data-rarity="epic">
                    <div class="card-icon">üîç</div>
                    <div class="card-title">EQUIPAMENTO</div>
                    <div class="card-rarity epic">√âPICA</div>
                    <div class="card-value">
                        <div class="card-value-icon">üí∞</div>
                        <div class="card-value-number">90</div>
                    </div>
                    <div class="card-progress">
                        <div class="card-progress-bar" style="width: 30%"></div>
                    </div>
                    <div class="card-stat">+ 50% analise</div>
                </div>

                <!-- Carta 2: Equipamento (Rara) -->
                <div class="card rare" data-type="equipment" data-rarity="rare">
                    <div class="card-icon">üìπ</div>
                    <div class="card-title">EQUIPAMENTO</div>
                    <div class="card-rarity rare">RARA</div>
                    <div class="card-value">
                        <div class="card-value-icon">üí∞</div>
                        <div class="card-value-number">30</div>
                    </div>
                    <div class="card-progress">
                        <div class="card-progress-bar" style="width: 60%"></div>
                    </div>
                    <div class="card-stat">‚ñ† HD</div>
                </div>

                <!-- Carta 3: Aliado (Comum) -->
                <div class="card common" data-type="ally" data-rarity="common">
                    <div class="card-icon">üì±</div>
                    <div class="card-title">ALIADO</div>
                    <div class="card-rarity common">COMUM</div>
                    <div class="card-value">
                        <div class="card-value-icon">üí∞</div>
                        <div class="card-value-number">45</div>
                    </div>
                    <div class="card-progress">
                        <div class="card-progress-bar" style="width: 25%"></div>
                    </div>
                    <div class="card-stat">Protoc√£o</div>
                </div>

                <!-- Carta 4: A√ß√£o (Comum) -->
                <div class="card common" data-type="action" data-rarity="common">
                    <div class="card-icon">üì¶</div>
                    <div class="card-title">A√á√ÉO</div>
                    <div class="card-rarity common">COMUM</div>
                    <div class="card-value">
                        <div class="card-value-icon">üí∞</div>
                        <div class="card-value-number">30</div>
                    </div>
                    <div class="card-progress">
                        <div class="card-progress-bar" style="width: 25%"></div>
                    </div>
                    <div class="card-stat">Legal</div>
                </div>

                <!-- Carta 5: Evid√™ncia (Rara) -->
                <div class="card rare" data-type="evidence" data-rarity="rare">
                    <div class="card-icon">üë§</div>
                    <div class="card-title">EVID√äNCIA</div>
                    <div class="card-rarity rare">RARA</div>
                    <div class="card-value">
                        <div class="card-value-icon">üí∞</div>
                        <div class="card-value-number">30</div>
                    </div>
                    <div class="card-progress">
                        <div class="card-progress-bar" style="width: 25%"></div>
                    </div>
                    <div class="card-stat">Dados</div>
                </div>

                <!-- Carta 6: Testemunho (√âpica) -->
                <div class="card epic" data-type="testimony" data-rarity="epic">
                    <div class="card-icon">üòä</div>
                    <div class="card-title">TESTEMUNHO</div>
                    <div class="card-rarity epic">√âPICA</div>
                    <div class="card-value">
                        <div class="card-value-icon">üí∞</div>
                        <div class="card-value-number">80</div>
                    </div>
                    <div class="card-progress">
                        <div class="card-progress-bar" style="width: 50%"></div>
                    </div>
                    <div class="card-stat">Testemunho</div>
                </div>
            </div>
        </div>

        <div class="sidebar">
            <div class="section-title">üìä Estat√≠sticas</div>
            
            <!-- Estat√≠sticas da Partida Atual -->
            <div style="margin-bottom: 1rem; padding: 0.75rem; background: rgba(15, 15, 35, 0.6); border-radius: 8px; border: 1px solid rgba(251, 191, 36, 0.3);">
                <div style="color: #fbbf24; font-size: 0.8rem; font-weight: bold; margin-bottom: 0.5rem; text-align: center;">
                    üéØ Partida Atual
                </div>
            
                <!-- Indicador Principal de Dificuldade -->
                <div id="difficultyIndicator" style="
                    margin-bottom: 1rem; 
                    padding: 0.75rem; 
                    background: linear-gradient(135deg, rgba(251, 191, 36, 0.1), rgba(245, 158, 11, 0.1)); 
                    border: 2px solid #f59e0b; 
                    border-radius: 10px; 
                    text-align: center;
                    box-shadow: 0 4px 15px rgba(245, 158, 11, 0.2);
                ">
                    <div style="font-size: 1.5rem; margin-bottom: 0.3rem;" id="difficultyIcon">üü°</div>
                    <div style="font-size: 0.9rem; font-weight: bold; color: #f59e0b; margin-bottom: 0.2rem;" id="difficultyName">INTERMEDI√ÅRIO</div>
                    <div style="font-size: 0.7rem; color: #cbd5e1; line-height: 1.3;" id="difficultyDescription">Tempo padr√£o, cartas balanceadas, b√¥nus de 50%</div>
                </div>

                <!-- Evid√™ncias Coletadas -->
                <div style="margin-bottom: 0.75rem;">
                    <div style="display: flex; justify-content: space-between; margin-bottom: 0.3rem; font-size: 0.85rem;">
                        <span>üîç Evid√™ncias</span>
                        <span id="evidenceDisplay" style="color: #10b981; font-weight: bold;">0/100</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="evidenceProgress" style="width: 0%; background: linear-gradient(90deg, #10b981, #059669);"></div>
                    </div>
                </div>

                <div style="margin-bottom: 0.75rem;">
                    <div style="display: flex; justify-content: space-between; margin-bottom: 0.3rem; font-size: 0.85rem;">
                        <span>Multiplicador</span>
                        <span id="currentMultiplier" style="color: #fbbf24; font-weight: bold;">1.0x</span>
                    </div>
                </div>
                
                <div style="margin-bottom: 0.75rem;">
                    <div style="display: flex; justify-content: space-between; margin-bottom: 0.3rem; font-size: 0.85rem;">
                        <span>üÉè Cartas Jogadas</span>
                        <span id="cardsPlayed">0/6</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="cardsProgress" style="width: 0%"></div>
                    </div>
                </div>
                
                <div style="margin-bottom: 0.75rem;">
                    <div style="display: flex; justify-content: space-between; margin-bottom: 0.3rem; font-size: 0.85rem;">
                        <span>üî• Combo Streak</span>
                        <span id="comboStreak">0x</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="comboProgress" style="width: 0%"></div>
                    </div>
                </div>

                <!-- Tempo Restante -->
                <div style="margin-bottom: 0.75rem;">
                    <div style="display: flex; justify-content: space-between; margin-bottom: 0.3rem; font-size: 0.85rem;">
                        <span>‚è±Ô∏è Tempo Restante</span>
                        <span id="timeRemaining" style="color: #ef4444; font-weight: bold;">45:00</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="timeProgress" style="width: 100%; background: linear-gradient(90deg, #ef4444, #dc2626);"></div>
                    </div>
                </div>
            </div>





            <div class="section-title" style="margin-top: 2rem;">üí∞ Loja de Cartas</div>
            <div style="display: flex; flex-direction: column; gap: 0.8rem;">
                <button class="btn" onclick="buyPack('basic')">
                    üì¶ Pacote B√°sico - 100üí∞
                </button>
                <button class="btn" onclick="buyPack('premium')">
                    ‚ú® Pacote Premium - 250üí∞
                </button>
                <button class="btn" onclick="buyPack('legendary')">
                    üåü Pacote Lend√°rio - 500üí∞
                </button>
                </div>

            <div style="text-align: center; margin-top: 1.5rem; font-size: 1.2rem; color: #fbbf24;">
                üí∞ Moedas: <strong id="coin-display">500</strong>
                <div style="font-size: 0.8rem; color: #94a3b8; margin-top: 0.5rem;">
                    üéÅ Ganhe moedas jogando cartas e fazendo combos!
                </div>
            </div>

            <!-- Conquistas Recentes -->
            <div class="achievements-section" style="margin-top: 2rem;">
                <div class="section-title">üèÜ Conquistas Recentes</div>
                <div id="achievements-container" class="achievements-container">
                    <div class="no-achievements" id="no-achievements" style="
                        text-align: center; 
                        color: #64748b; 
                        font-size: 0.9rem; 
                        padding: 1rem;
                        font-style: italic;
                    ">
                        Jogue cartas para desbloquear conquistas! üéØ
                    </div>
                </div>
            </div>
                </div>
            </div>

    <!-- Modal para Carta Detalhada -->
    <div id="cardModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('cardModal')">&times;</span>
            <h2 style="color: #fbbf24; margin-bottom: 1.5rem;">üÉè Detalhes da Carta</h2>
            <div id="cardDetails"></div>
        </div>
    </div>

    <!-- Modal para Cole√ß√£o -->
    <div id="collectionModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('collectionModal')">&times;</span>
            <h2 style="color: #fbbf24; margin-bottom: 1.5rem;">üìö Minha Cole√ß√£o</h2>
            <div id="collectionContent">
                <p>Total de cartas: <strong>47/200</strong></p>
                <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(100px, 1fr)); gap: 1rem; margin-top: 1.5rem;">
                    <div class="mini-card">
                        <div class="mini-card-icon">üß¨</div>
                        <div class="mini-card-title">DNA (L)</div>
                    </div>
                    <div class="mini-card">
                        <div class="mini-card-icon">üë®‚Äçüíº</div>
                        <div class="mini-card-title">Marcus (E)</div>
                    </div>
                    <div class="mini-card">
                        <div class="mini-card-icon">üîç</div>
                        <div class="mini-card-title">Interrogat√≥rio (R)</div>
                    </div>
                    <!-- Mais cartas... -->
                </div>
            </div>
        </div>
    </div>

    <script>
        // Timer do jogo (ser√° definido pela dificuldade)
        let gameTime = 45 * 60;
        let difficultyMultiplier = 1.0;
        let cardsPlayed = 0;
        let comboStreak = 0;
        let playerCoins = loadPlayerCoins(); // Sistema din√¢mico de moedas
        
        // ========================================
        // SISTEMA COMPLETO DE MOEDAS
        // ========================================
        
        function loadPlayerCoins() {
            // Carregar moedas salvas ou come√ßar com valor inicial
            const savedCoins = localStorage.getItem('criminalMinds_playerCoins');
            const initialCoins = savedCoins ? parseInt(savedCoins) : 500; // Valor inicial mais generoso
            return Math.max(initialCoins, 50); // Garantir m√≠nimo de 50 moedas
        }
        
        function savePlayerCoins() {
            localStorage.setItem('criminalMinds_playerCoins', playerCoins);
            console.log(`üí∞ Moedas salvas: ${playerCoins}`);
        }
        
        function updateCoinDisplay() {
            const coinElement = document.getElementById('coin-display') || document.querySelector('div[style*="Moedas"] strong');
            if (coinElement) {
                coinElement.textContent = playerCoins;
                coinElement.style.color = playerCoins < 100 ? '#ff6b6b' : '#fbbf24';
                
                // Efeito visual de mudan√ßa
                coinElement.style.transform = 'scale(1.1)';
                setTimeout(() => {
                    coinElement.style.transform = 'scale(1)';
                }, 200);
                
                console.log(`üí∞ Display de moedas atualizado: ${playerCoins}`);
            } else {
                console.error('üí∞ Elemento coin-display n√£o encontrado');
            }
            savePlayerCoins();
        }
        
        function rewardCoins(amount, reason) {
            if (amount <= 0) return;
            
            // Aplicar multiplicador de dificuldade
            const finalAmount = Math.floor(amount * difficultyMultiplier);
            const bonusText = difficultyMultiplier > 1 ? ` (${difficultyMultiplier}x b√¥nus!)` : '';
            
            playerCoins += finalAmount;
            updateCoinDisplay();
            
            // Verificar conquista de riqueza
            if (!achievements.wealthy.completed && playerCoins >= 1000) {
                unlockAchievement('wealthy');
            }
            
            // Feedback visual e sonoro
            showNotification(`üí∞ +${finalAmount} moedas! ${reason}${bonusText}`);
            addChatMessage(`üí∞ Ganhei ${finalAmount} moedas: ${reason}${bonusText}`, 'self');
            
            // Log para debugging
            console.log(`üí∞ Recompensa: +${finalAmount} moedas (${amount} x ${difficultyMultiplier}) por "${reason}". Total: ${playerCoins}`);
        }
        
        function spendCoins(amount, reason) {
            if (amount <= 0 || playerCoins < amount) return false;
            
            playerCoins -= amount;
            updateCoinDisplay();
            
            showNotification(`üí∏ -${amount} moedas! ${reason}`);
            addChatMessage(`üí∏ Gastei ${amount} moedas: ${reason}`, 'self');
            
            console.log(`üí∏ Gasto: -${amount} moedas (${reason}). Total: ${playerCoins}`);
            return true;
        }
        
        // Sistema de b√¥nus di√°rio
        function checkDailyBonus() {
            const today = new Date().toDateString();
            const lastBonus = localStorage.getItem('criminalMinds_lastDailyBonus');
            
            if (lastBonus !== today) {
                localStorage.setItem('criminalMinds_lastDailyBonus', today);
                rewardCoins(100, "B√¥nus di√°rio!");
                showNotification("üéÅ B√¥nus di√°rio coletado! +100 moedas");
            }
        }
        
        // Sistema de recompensas por a√ß√µes
        const coinRewards = {
            cardPlayed: { amount: 8, message: "Carta jogada" },
            combo3: { amount: 25, message: "Combo 3x!" },
            combo5: { amount: 50, message: "Combo 5x!" },
            combo7: { amount: 100, message: "SUPER COMBO 7x!" },
            timeBonus: { amount: 2, message: "B√¥nus de tempo" },
            perfectRound: { amount: 200, message: "Rodada perfeita!" },
            firstWin: { amount: 150, message: "Primeira vit√≥ria!" },
            investigation: { amount: 75, message: "Investiga√ß√£o completa" }
        };
        
        // Sistema de conquistas
        const achievements = {
            firstCard: { 
                reward: 20, 
                message: "Primeira carta jogada!", 
                description: "Bem-vindo ao mundo da investiga√ß√£o!",
                icon: "üéØ",
                type: "bronze",
                completed: false 
            },
            speedPlayer: { 
                reward: 50, 
                message: "5 cartas em 1 minuto!", 
                description: "Velocidade impressionante de investiga√ß√£o",
                icon: "‚ö°",
                type: "silver",
                completed: false 
            },
            comboMaster: { 
                reward: 100, 
                message: "Combo de 10 cartas!", 
                description: "Sequ√™ncia perfeita de evid√™ncias",
                icon: "üî•",
                type: "gold",
                completed: false 
            },
            investigator: { 
                reward: 150, 
                message: "20 cartas jogadas!", 
                description: "Investigador experiente e dedicado",
                icon: "üïµÔ∏è",
                type: "gold",
                completed: false 
            },
            wealthy: { 
                reward: 200, 
                message: "1000 moedas acumuladas!", 
                description: "Riqueza atrav√©s da investiga√ß√£o",
                icon: "üíé",
                type: "rare",
                completed: false 
            }
        };

        // Lista de conquistas recentes para exibi√ß√£o
        let recentAchievements = [];

        // ========================================
        // SISTEMA DE DIFICULDADE DIN√ÇMICA
        // ========================================
        
        let currentDifficulty = 'beginner'; // Padr√£o iniciante
        
        const difficultySettings = {
            beginner: { 
                cards: 6, 
                name: 'Iniciante', 
                color: '#10b981',
                icon: 'üü¢',
                timer: 45 * 60, // 45 minutos
                coinMultiplier: 1.0,
                evidenceMultiplier: 1.0,
                comboRequirement: 2,
                description: 'Mais tempo, menos cartas, recompensas normais'
            },
            intermediate: { 
                cards: 20, 
                name: 'Intermedi√°rio', 
                color: '#f59e0b',
                icon: 'üü°',
                timer: 45 * 60, // 45 minutos
                coinMultiplier: 1.5,
                evidenceMultiplier: 1.2,
                comboRequirement: 3,
                description: 'Tempo padr√£o, cartas balanceadas, b√¥nus de 50%'
            },
            hard: { 
                cards: 25, 
                name: 'Dif√≠cil', 
                color: '#ef4444',
                icon: 'üî¥',
                timer: 45 * 60, // 45 minutos
                coinMultiplier: 2.0,
                evidenceMultiplier: 1.5,
                comboRequirement: 4,
                description: 'Menos tempo, mais cartas, recompensas dobradas'
            }
        };

        // Base de cartas dispon√≠veis
        const cardDatabase = [
            {
                id: 'dna-evidence',
                type: 'Evid√™ncia',
                rarity: 'legendary',
                icon: 'üß¨',
                title: 'DNA do Assassino',
                description: 'Perfil gen√©tico completo que revela a identidade do criminoso. 99.9% de precis√£o.',
                stats: ['‚ö° 95', 'üéØ 100', 'üíé √önica']
            },
            {
                id: 'main-suspect',
                type: 'Suspeito',
                rarity: 'epic',
                icon: 'üë®‚Äçüíº',
                title: 'Marcus Thompson',
                description: 'Ex-marido violento com motivos claros. Hist√≥rico criminal extenso.',
                stats: ['‚ö° 78', 'üéØ 85', 'üîç Perigoso']
            },
            {
                id: 'interrogation',
                type: 'A√ß√£o',
                rarity: 'rare',
                icon: 'üîç',
                title: 'Interrogat√≥rio Intensivo',
                description: 'T√©cnica avan√ßada que for√ßa o suspeito a revelar informa√ß√µes cruciais.',
                stats: ['‚ö° 65', 'üéØ 70', '‚è±Ô∏è 3 min']
            },

            {
                id: 'forensic-kit',
                type: 'Equipamento',
                rarity: 'epic',
                icon: 'üî¨',
                title: 'Kit Forense Avan√ßado',
                description: 'Equipamento de alta tecnologia para an√°lise instant√¢nea de evid√™ncias.',
                stats: ['‚ö° 85', 'üéØ 90', '‚öóÔ∏è +50% an√°lise']
            },
            {
                id: 'backup-officer',
                type: 'Aliado',
                rarity: 'common',
                icon: 'üëÆ‚Äç‚ôÇÔ∏è',
                title: 'Oficial de Apoio',
                description: 'Policial experiente que oferece suporte durante a investiga√ß√£o.',
                stats: ['‚ö° 45', 'üéØ 55', 'üõ°Ô∏è Prote√ß√£o']
            },
            {
                id: 'witness-testimony',
                type: 'Evid√™ncia',
                rarity: 'common',
                icon: 'üëÅÔ∏è',
                title: 'Testemunha Ocular',
                description: 'Relato detalhado de uma testemunha que viu o suspeito no local.',
                stats: ['‚ö° 40', 'üéØ 60', 'üë• Confi√°vel']
            },
            {
                id: 'security-camera',
                type: 'Equipamento',
                rarity: 'rare',
                icon: 'üìπ',
                title: 'C√¢mera de Seguran√ßa',
                description: 'Grava√ß√£o de alta resolu√ß√£o que capturou o momento do crime.',
                stats: ['‚ö° 70', 'üéØ 85', 'üì± HD']
            },
            {
                id: 'phone-records',
                type: 'Evid√™ncia',
                rarity: 'common',
                icon: 'üì±',
                title: 'Registros Telef√¥nicos',
                description: 'Hist√≥rico de chamadas que revela conex√µes suspeitas.',
                stats: ['‚ö° 35', 'üéØ 50', 'üìä Dados']
            },
            {
                id: 'ballistics-report',
                type: 'Evid√™ncia',
                rarity: 'epic',
                icon: 'üéØ',
                title: 'Relat√≥rio Bal√≠stico',
                description: 'An√°lise completa da arma e trajet√≥ria dos proj√©teis.',
                stats: ['‚ö° 80', 'üéØ 95', 'üî´ Preciso']
            },
            {
                id: 'psychological-profile',
                type: 'A√ß√£o',
                rarity: 'rare',
                icon: 'üß†',
                title: 'Perfil Psicol√≥gico',
                description: 'An√°lise comportamental detalhada do suspeito.',
                stats: ['‚ö° 55', 'üéØ 75', 'üß† Insight']
            },
            {
                id: 'search-warrant',
                type: 'A√ß√£o',
                rarity: 'common',
                icon: 'üìú',
                title: 'Mandado de Busca',
                description: 'Autoriza√ß√£o legal para busca e apreens√£o de evid√™ncias.',
                stats: ['‚ö° 30', 'üéØ 40', '‚öñÔ∏è Legal']
            }
        ];



        // Fun√ß√£o para aplicar configura√ß√µes de dificuldade
        function applyDifficultySettings(difficultyConfig) {
            // Atualizar timer baseado na dificuldade
            gameTime = difficultyConfig.timer;
            difficultyMultiplier = difficultyConfig.coinMultiplier;
            
            console.log(`üéØ Aplicando configura√ß√µes de dificuldade: ${difficultyConfig.name}`);
            console.log(`‚è±Ô∏è Timer definido para: ${Math.floor(gameTime / 60)}:${(gameTime % 60).toString().padStart(2, '0')}`);
            console.log(`üí∞ Multiplicador de moedas: ${difficultyMultiplier}x`);
            
            // Atualizar display do header com informa√ß√µes da dificuldade
            updateDifficultyHeader(difficultyConfig);
            
            // Aplicar cor tem√°tica da dificuldade
            applyDifficultyTheme(difficultyConfig);
        }
        
        function updateDifficultyHeader(difficultyConfig) {
            // Atualizar t√≠tulo do caso com indicador de dificuldade
            const caseTitle = document.querySelector('.case-title');
            if (caseTitle) {
                caseTitle.innerHTML = `${difficultyConfig.icon} CRIMINAL MINDS: ${difficultyConfig.name.toUpperCase()}`;
                caseTitle.style.color = difficultyConfig.color;
            }
            
            // Atualizar timer com cor da dificuldade
            const timer = document.getElementById('gameTimer');
            if (timer) {
                timer.style.borderColor = difficultyConfig.color;
                timer.style.boxShadow = `0 0 15px ${difficultyConfig.color}40`;
            }
            
            // Atualizar indicador de dificuldade na sidebar
            updateDifficultyIndicator(difficultyConfig);
        }
        
        function updateDifficultyIndicator(difficultyConfig) {
            const indicator = document.getElementById('difficultyIndicator');
            const icon = document.getElementById('difficultyIcon');
            const name = document.getElementById('difficultyName');
            const description = document.getElementById('difficultyDescription');
            const multiplier = document.getElementById('currentMultiplier');
            
            if (indicator) {
                indicator.style.background = `linear-gradient(135deg, ${difficultyConfig.color}20, ${difficultyConfig.color}10)`;
                indicator.style.borderColor = difficultyConfig.color;
                indicator.style.boxShadow = `0 4px 15px ${difficultyConfig.color}40`;
            }
            
            if (icon) icon.textContent = difficultyConfig.icon;
            if (name) {
                name.textContent = difficultyConfig.name.toUpperCase();
                name.style.color = difficultyConfig.color;
            }
            if (description) description.textContent = difficultyConfig.description;
            if (multiplier) multiplier.textContent = `${difficultyConfig.coinMultiplier}x`;
        }
        
        function applyDifficultyTheme(difficultyConfig) {
            // Aplicar cor tem√°tica aos elementos principais
            const root = document.documentElement;
            root.style.setProperty('--difficulty-color', difficultyConfig.color);
            root.style.setProperty('--difficulty-glow', `${difficultyConfig.color}40`);
            
            // Atualizar bordas dos containers principais
            const mainArea = document.querySelector('.main-area');
            if (mainArea) {
                mainArea.style.borderColor = `${difficultyConfig.color}60`;
            }
            
            const sidebar = document.querySelector('.sidebar');
            if (sidebar) {
                sidebar.style.borderColor = `${difficultyConfig.color}40`;
            }
        }

        function generateCards() {
            const container = document.getElementById('cardsContainer');
            if (!container) return;
            
            // Obter dificuldade da URL ou usar padr√£o
            const urlParams = new URLSearchParams(window.location.search);
            const difficultyFromUrl = urlParams.get('difficulty') || 'easy';
            
            console.log(`üîç URL atual: ${window.location.href}`);
            console.log(`üéØ Dificuldade da URL: ${difficultyFromUrl}`);
            
            // Mapear dificuldades da URL para as configura√ß√µes existentes
            const difficultyMap = {
                'easy': 'beginner',
                'medium': 'intermediate', 
                'hard': 'hard'
            };
            
            const mappedDifficulty = difficultyMap[difficultyFromUrl] || 'intermediate';
            const difficultyConfig = difficultySettings[mappedDifficulty];
            const numCards = difficultyConfig.cards;
            
            console.log(`üó∫Ô∏è Dificuldade mapeada: ${mappedDifficulty}`);
            console.log(`üÉè N√∫mero de cartas: ${numCards}`);
            console.log(`‚è±Ô∏è Timer: ${Math.floor(difficultyConfig.timer / 60)} minutos`);
            console.log(`üí∞ Multiplicador de moedas: ${difficultyConfig.coinMultiplier}x`);
            
            // Atualizar vari√°vel global de dificuldade
            currentDifficulty = mappedDifficulty;
            
            // Aplicar configura√ß√µes de dificuldade
            applyDifficultySettings(difficultyConfig);
            
            // Atualizar contador baseado no novo n√≠vel
            updateCardsCounterForLevel();
            
            // Atualizar display da dificuldade atual
            updateCurrentDifficultyDisplay(difficultyFromUrl);
            
            // Limpar cartas existentes
            container.innerHTML = '';
            
            // Aplicar classe CSS baseada na dificuldade
            container.className = `cards-container ${mappedDifficulty}`;
            
            console.log(`üé® Aplicando classe CSS: cards-container ${mappedDifficulty}`);
            
            // Filtrar apenas cartas n√£o jogadas
            const availableCards = cardDatabase.filter(card => !card.played);
            console.log(`üÉè Cartas dispon√≠veis (n√£o jogadas): ${availableCards.length} de ${cardDatabase.length} total`);
            
            // Se n√£o h√° cartas dispon√≠veis, mostrar mensagem
            if (availableCards.length === 0) {
                container.innerHTML = `
                    <div style="text-align: center; padding: 2rem; color: #6b7280; grid-column: 1 / -1;">
                        <div style="font-size: 3rem; margin-bottom: 1rem;">üéâ</div>
                        <h3 style="text-align: center; margin-bottom: 1rem;">Todas as cartas foram jogadas!</h3>
                        <p style="text-align: center; margin-bottom: 1.5rem;">Parab√©ns! Voc√™ utilizou todas as cartas dispon√≠veis nesta investiga√ß√£o.</p>
                        <button class="btn btn-primary" onclick="showAllCards()">üëÅÔ∏è Ver Todas as Cartas</button>
                    </div>
                `;
                return;
            }
            
            // Embaralhar e selecionar cartas dispon√≠veis
            const shuffledCards = [...availableCards].sort(() => Math.random() - 0.5);
            const selectedCards = shuffledCards.slice(0, Math.min(numCards, availableCards.length));
            
            console.log(`üÉè Cartas selecionadas: ${selectedCards.length} de ${availableCards.length} dispon√≠veis`);
            
            // Gerar HTML para cada carta
            selectedCards.forEach((cardData, index) => {
                const cardElement = createCardElement(cardData);
                container.appendChild(cardElement);
                
                // Anima√ß√£o escalonada
                setTimeout(() => {
                    cardElement.style.opacity = '1';
                    cardElement.style.transform = 'translateY(0)';
                }, index * 100);
            });
            
            console.log(`üéØ Geradas ${selectedCards.length} cartas para dificuldade ${currentDifficulty}`);
            
            // Atualizar contador dinamicamente baseado nas cartas dispon√≠veis
            updateDynamicCardsCounter();
        }

        function createCardElement(cardData) {
            const card = document.createElement('div');
            card.className = `card ${cardData.rarity}`;
            card.setAttribute('data-card-id', cardData.id);
            
            // Adicionar evento de clique para abrir detalhes
            card.addEventListener('click', (e) => {
                e.preventDefault();
                e.stopPropagation();
                showCardDetails(cardData);
            });
            
            // Iniciar invis√≠vel para anima√ß√£o
            card.style.opacity = '0';
            card.style.transform = 'translateY(20px)';
            card.style.transition = 'all 0.5s ease-out';
            
            // Criar estrutura da carta com layout melhorado
            card.innerHTML = `
                <div class="card-inner">
                    <div class="card-header">
                        <span class="card-type">${cardData.type}</span>
                        <span class="card-rarity rarity-${cardData.rarity}">${getRarityName(cardData.rarity)}</span>
                    </div>
                    <div class="card-icon">${cardData.icon}</div>
                    <div class="card-title">${cardData.title}</div>
                    <div class="card-description">${cardData.description}</div>
                    <div class="card-stats">
                        ${cardData.stats ? cardData.stats.map(stat => `<div class="stat">${stat}</div>`).join('') : ''}
                    </div>
                    <div class="card-action">
                        <span class="view-details-hint">üëÅÔ∏è Ver Detalhes</span>
                    </div>
                </div>
            `;
            
            return card;
        }

        function showCardDetails(cardData) {
            console.log(`üîç Abrindo detalhes da carta: ${cardData.title}`);
            
            // Verificar se a carta j√° foi jogada
            const isPlayed = cardData.played || false;
            
            // Fechar modal atual se existir
            closeCardDetails();
            
            // Criar modal com detalhes da carta
            const modal = document.createElement('div');
            modal.className = 'card-details-modal';
            
            // Obter informa√ß√µes detalhadas da carta
            const detailedDescription = getDetailedDescription(cardData);
            const investigationClues = getInvestigationClues(cardData);
            const cardEffects = getCardEffects(cardData);
            
            modal.innerHTML = `
                <div class="modal-overlay" onclick="closeCardDetails()"></div>
                <div class="modal-content card-details-content">
                    <div class="modal-header">
                        <h2>${cardData.icon} ${cardData.title}</h2>
                        <button class="close-btn" onclick="closeCardDetails()">√ó</button>
                    </div>
                    <div class="modal-body">
                        <div class="card-details-header">
                            <div class="card-details-icon">${cardData.icon}</div>
                            <div class="card-details-info">
                                <h3>${cardData.title}</h3>
                                <p class="card-type">${cardData.type} - ${getRarityName(cardData.rarity)}</p>
                                <p class="card-status">${isPlayed ? '‚úÖ Jogada' : 'üÉè Dispon√≠vel'}</p>
                            </div>
                        </div>
                        
                        <div class="card-details-section">
                            <h4>üìù Descri√ß√£o Detalhada</h4>
                            <p>${detailedDescription}</p>
                        </div>
                        
                        <div class="card-details-section">
                            <h4>üîç Pistas de Investiga√ß√£o</h4>
                            <ul class="investigation-clues">
                                ${investigationClues.map(clue => `<li>${clue}</li>`).join('')}
                            </ul>
                        </div>
                        
                        <div class="card-details-section">
                            <h4>‚ö° Efeitos da Carta</h4>
                            <div class="card-effects">
                                ${cardEffects.map(effect => `<div class="effect-item">${effect}</div>`).join('')}
                            </div>
                        </div>
                        
                        <div class="card-details-section">
                            <h4>üìä Estat√≠sticas</h4>
                            <div class="card-stats">
                                <div class="stat-item">
                                    <span class="stat-label">Evid√™ncias:</span>
                                    <span class="stat-value">${cardData.evidence || 0}</span>
                                </div>
                                <div class="stat-item">
                                    <span class="stat-label">Raridade:</span>
                                    <span class="stat-value">${getRarityName(cardData.rarity)}</span>
                                </div>
                                <div class="stat-item">
                                    <span class="stat-label">Tipo:</span>
                                    <span class="stat-value">${cardData.type}</span>
                                </div>
                                ${cardData.stats ? `
                                <div class="stat-item">
                                    <span class="stat-label">Atributos:</span>
                                    <span class="stat-value">${cardData.stats.join(', ')}</span>
                                </div>
                                ` : ''}
                            </div>
                        </div>
                        
                        ${!isPlayed ? `
                        <div class="card-details-actions">
                            <button class="btn btn-primary" onclick="playCardFromModal('${cardData.id}')">üÉè Jogar Carta</button>
                            <button class="btn btn-secondary" onclick="closeCardDetails()">‚ùå Fechar</button>
                        </div>
                        ` : `
                        <div class="card-details-actions">
                            <button class="btn btn-secondary" onclick="closeCardDetails()">‚ùå Fechar</button>
                        </div>
                        `}
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
            
            // Animar entrada
            setTimeout(() => {
                modal.style.opacity = '1';
                modal.querySelector('.modal-content').style.transform = 'translate(-50%, -50%) scale(1)';
            }, 10);
        }
                    <div class="modal-header">
                        <h2>üîç Detalhes da Carta</h2>
                        <button class="close-btn" onclick="closeCardDetails()">√ó</button>
                    </div>
                    <div class="modal-body">
                        <div class="card-detail-main">
                            <div class="detail-icon">${cardData.icon}</div>
                            <div class="detail-info">
                                <h3>${cardData.title}</h3>
                                <p class="detail-type">${cardData.type}</p>
                                <p class="detail-rarity">${getRarityName(cardData.rarity)}</p>
                                ${isPlayed ? '<p class="card-status played">‚úÖ Carta Jogada</p>' : ''}
                            </div>
                        </div>
                        <div class="card-detail-description">
                            <h4>üìù Descri√ß√£o Detalhada:</h4>
                            <p>${getDetailedDescription(cardData)}</p>
                        </div>
                        <div class="card-detail-clues">
                            <h4>üîç Pistas para Investiga√ß√£o:</h4>
                            <ul>${getInvestigationClues(cardData).map(clue => `<li>${clue}</li>`).join('')}</ul>
                        </div>
                        <div class="card-detail-stats">
                            <h4>üìä Estat√≠sticas:</h4>
                            <div class="stats-grid">
                                ${cardData.stats.map(stat => `<div class="stat-item">${stat}</div>`).join('')}
                            </div>
                        </div>
                        <div class="card-actions">
                            ${!isPlayed ? `<button class="btn-play" onclick="playCardFromModal('${cardData.id}')">‚ñ∂Ô∏è Jogar Carta</button>` : ''}
                            <button class="btn-close" onclick="closeCardDetails()">‚ùå Fechar</button>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
            
            // Animar entrada
            setTimeout(() => {
                modal.style.opacity = '1';
                modal.querySelector('.modal-content').style.transform = 'translate(-50%, -50%) scale(1)';
            }, 10);
        }

        // Fun√ß√£o auxiliar para mostrar detalhes por ID
        function showCardDetailsById(cardId) {
            const cardData = cardDatabase.find(card => card.id === cardId);
            if (cardData) {
                showCardDetails(cardData);
            } else {
                console.error(`‚ùå Carta n√£o encontrada: ${cardId}`);
            }
        }

        function closeCardDetails() {
            const modal = document.querySelector('.card-details-modal');
            if (modal) {
                modal.style.opacity = '0';
                modal.querySelector('.modal-content').style.transform = 'translate(-50%, -50%) scale(0.8)';
                setTimeout(() => {
                    modal.remove();
                }, 300);
            }
        }

        function playCardFromModal(cardId) {
            console.log(`üÉè Jogando carta do modal: ${cardId}`);
            
            // Fechar o modal primeiro
            closeCardDetails();
            
            // Encontrar a carta no banco de dados
            const cardData = cardDatabase.find(card => card.id === cardId);
            if (!cardData) {
                console.error(`‚ùå Carta n√£o encontrada no banco de dados: ${cardId}`);
                return;
            }
            
            // Verificar se a carta j√° foi jogada
            if (cardData.played) {
                console.log(`‚ö†Ô∏è Carta j√° foi jogada: ${cardData.title}`);
                return;
            }
            
            // Marcar carta como jogada no banco de dados
            cardData.played = true;
            console.log(`‚úÖ Carta marcada como jogada: ${cardData.title}`);
            
            // Incrementar contadores
            cardsPlayed++;
            
            // Gerenciar Combo Streak
            manageComboStreak('increment');
            
            // Registrar tempo da √∫ltima carta jogada
            window.lastCardPlayTime = Date.now();
            
            console.log(`üìä Contadores atualizados: cardsPlayed=${cardsPlayed}, comboStreak=${comboStreak}`);
            
            // Atualizar contador de cartas jogadas imediatamente
            updateCardsPlayedCounter();
            
            // Encontrar o elemento da carta no DOM e remov√™-lo visualmente
            setTimeout(() => {
                const cardElement = document.querySelector(`[data-card-id="${cardId}"]`);
                if (cardElement) {
                    console.log(`‚úÖ Elemento da carta encontrado, removendo visualmente...`);
                    
                    // Aplicar anima√ß√£o de remo√ß√£o
                    cardElement.style.animation = 'cardFadeOut 0.5s ease-out forwards';
                    setTimeout(() => {
                        cardElement.remove();
                        // Recarregar cartas dispon√≠veis
                        generateCards();
                    }, 500);
                } else {
                    console.log(`‚ö†Ô∏è Elemento da carta n√£o encontrado no DOM, mas carta foi jogada`);
                    // Recarregar cartas dispon√≠veis mesmo sem encontrar o elemento
                    generateCards();
                }
            }, 350);
            
            // Adicionar mensagem ao chat
            setTimeout(() => {
                const chatMessages = [
                    `üÉè Carta ${cardData.title} jogada com sucesso!`,
                    `üìä Progresso: ${cardsPlayed}/20 cartas jogadas`,
                    `üéØ Combo ${comboStreak}x ativo!`,
                    `üí° Boa estrat√©gia! ${cardData.title} foi √∫til!`
                ];
                
                const randomMessage = chatMessages[Math.floor(Math.random() * chatMessages.length)];
                const randomMember = teamMembers[Math.floor(Math.random() * teamMembers.length)];
                addChatMessage(randomMessage, randomMember.name.split(' ')[1]);
            }, 1000);
            
            console.log(`üéÆ Carta jogada via modal: ${cardData.title}`);
        }

        function showAllCards() {
            // Criar modal com todas as cartas
            const modal = document.createElement('div');
            modal.className = 'card-details-modal';
            
            const allCards = cardDatabase.map(card => {
                const isPlayed = card.played || false;
                return `
                    <div class="all-cards-item ${isPlayed ? 'played' : ''}" onclick="showCardDetailsById('${card.id}')" style="cursor: pointer;">
                        <div class="all-cards-icon">${card.icon}</div>
                        <div class="all-cards-info">
                            <h4>${card.title}</h4>
                            <p>${card.type} - ${getRarityName(card.rarity)}</p>
                            ${isPlayed ? '<span class="played-badge">‚úÖ Jogada</span>' : '<span class="available-badge">üÉè Dispon√≠vel</span>'}
                        </div>
                        <div class="all-cards-action">
                            <span class="view-details-btn">üëÅÔ∏è Ver Detalhes</span>
                        </div>
                    </div>
                `;
            }).join('');
            
            modal.innerHTML = `
                <div class="modal-overlay"></div>
                <div class="modal-content all-cards-modal">
                    <div class="modal-header">
                        <h2>üëÅÔ∏è Todas as Cartas</h2>
                        <button class="close-btn" onclick="closeCardDetails()">√ó</button>
                    </div>
                    <div class="modal-body">
                        <div class="all-cards-grid">
                            ${allCards}
                        </div>
                        <div class="card-actions">
                            <button class="btn-close" onclick="closeCardDetails()">‚ùå Fechar</button>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
            
            // Animar entrada
            setTimeout(() => {
                modal.style.opacity = '1';
                modal.querySelector('.modal-content').style.transform = 'translate(-50%, -50%) scale(1)';
            }, 10);
        }

        function getDetailedDescription(cardData) {
            const descriptions = {
                'suspect_marcus': 'Marcus Thompson, 34 anos, ex-empregado da v√≠tima. Tinha acesso ao local do crime e estava presente no dia do assassinato. Possui hist√≥rico de conflitos com a v√≠tima por quest√µes financeiras.',
                'equipment_camera': 'C√¢mera de seguran√ßa de alta resolu√ß√£o que capturou imagens do momento do crime. A grava√ß√£o mostra uma figura suspeita no local durante a janela de tempo do assassinato.',
                'equipment_forensic': 'Kit forense avan√ßado com equipamentos para an√°lise de DNA, impress√µes digitais e evid√™ncias microsc√≥picas. Permite coleta e an√°lise detalhada de evid√™ncias f√≠sicas.',
                'action_interrogation': 'T√©cnica de interrogat√≥rio intensivo que pode revelar inconsist√™ncias nas declara√ß√µes dos suspeitos. √ötil para identificar mentiras e obter confiss√µes.',
                'action_warrant': 'Mandado de busca que permite investigar locais espec√≠ficos relacionados ao caso. Pode revelar evid√™ncias escondidas ou documentos comprometedores.',
                'evidence_dna': 'Amostra de DNA encontrada na cena do crime. An√°lise gen√©tica pode identificar definitivamente o autor do crime.',
                'ally_officer': 'Oficial de apoio experiente que pode auxiliar na investiga√ß√£o. Possui conhecimento local e recursos adicionais para o caso.',
                'evidence_ballistic': 'Relat√≥rio bal√≠stico detalhado das armas e muni√ß√µes encontradas. Pode conectar armas espec√≠ficas ao crime.',
                'action_psychological': 'An√°lise psicol√≥gica dos suspeitos e v√≠tima. Pode revelar motivos, padr√µes comportamentais e indicar o perfil do assassino.',
                'equipment_microscope': 'Microsc√≥pio eletr√¥nico para an√°lise de evid√™ncias microsc√≥picas. Pode revelar detalhes impercept√≠veis a olho nu.',
                'evidence_fingerprint': 'Impress√µes digitais coletadas na cena do crime. Pode identificar definitivamente quem esteve no local.',
                'ally_detective': 'Detetive experiente especializado em homic√≠dios. Possui intui√ß√£o apurada e experi√™ncia em casos similares.'
            };
            
            return descriptions[cardData.id] || cardData.description;
        }



        // Fun√ß√£o para obter efeitos da carta
        function getCardEffects(cardData) {
            const effects = {
                'suspect_marcus': [
                    'üîç Revela informa√ß√µes sobre o suspeito',
                    'üìä Fornece evid√™ncias de motiva√ß√£o',
                    'üéØ Ajuda a identificar padr√µes comportamentais',
                    '‚ö° Acelera a investiga√ß√£o'
                ],
                'equipment_camera': [
                    'üìπ Captura evid√™ncias visuais',
                    '‚è∞ Registra hor√°rios importantes',
                    'üéØ Identifica movimentos suspeitos',
                    'üìä Fornece dados de localiza√ß√£o'
                ],
                'equipment_forensic': [
                    'üß¨ Analisa evid√™ncias de DNA',
                    'üîç Coleta impress√µes digitais',
                    '‚öóÔ∏è Processa amostras biol√≥gicas',
                    'üìä Gera relat√≥rios t√©cnicos'
                ],
                'action_interrogation': [
                    'üó£Ô∏è Revela inconsist√™ncias nas declara√ß√µes',
                    'üò∞ Detecta sinais de nervosismo',
                    'üé≠ Identifica mentiras',
                    'üí° Obt√©m informa√ß√µes cruciais'
                ],
                'action_warrant': [
                    'üè† Permite busca em locais espec√≠ficos',
                    'üì± Acesso a dispositivos eletr√¥nicos',
                    'üìÑ Revela documentos comprometedores',
                    'üîç Encontra evid√™ncias escondidas'
                ],
                'evidence_dna': [
                    'üß¨ Identifica definitivamente o autor',
                    'üîó Conecta suspeitos √† cena',
                    'üìä Fornece evid√™ncia irrefut√°vel',
                    '‚öñÔ∏è Suporte para acusa√ß√£o'
                ],
                'ally_officer': [
                    'üëÆ Fornece conhecimento local',
                    'üìã Acesso a registros policiais',
                    'ü§ù Contatos com informantes',
                    'üöî Recursos adicionais de investiga√ß√£o'
                ],
                'evidence_ballistic': [
                    'üî´ Conecta armas ao crime',
                    'üìä Analisa trajet√≥rias de proj√©teis',
                    'üîç Identifica tipo de arma',
                    '‚öñÔ∏è Evid√™ncia t√©cnica s√≥lida'
                ],
                'action_psychological': [
                    'üß† Analisa perfil psicol√≥gico',
                    'üéØ Identifica motiva√ß√µes',
                    'üìä Revela padr√µes comportamentais',
                    'üí° Orienta estrat√©gia de investiga√ß√£o'
                ],
                'equipment_microscope': [
                    'üî¨ Analisa evid√™ncias microsc√≥picas',
                    'üîç Revela detalhes impercept√≠veis',
                    'üìä Fornece dados t√©cnicos precisos',
                    '‚öóÔ∏è Processa amostras complexas'
                ],
                'evidence_fingerprint': [
                    'üëÜ Identifica quem esteve no local',
                    'üîó Conecta suspeitos √† cena',
                    'üìä Evid√™ncia de presen√ßa f√≠sica',
                    '‚öñÔ∏è Suporte para acusa√ß√£o'
                ],
                'ally_detective': [
                    'üïµÔ∏è Experi√™ncia em casos similares',
                    'üí° Intui√ß√£o investigativa apurada',
                    'üìä An√°lise de padr√µes criminais',
                    'üéØ Estrat√©gias de investiga√ß√£o'
                ]
            };
            
            return effects[cardData.id] || [
                'üìä Fornece informa√ß√µes √∫teis',
                'üîç Ajuda na investiga√ß√£o',
                '‚ö° Acelera o progresso',
                'üí° Revela pistas importantes'
            ];
        }

        function getInvestigationClues(cardData) {
            const clues = {
                'suspect_marcus': [
                    'Marcus estava desempregado e com problemas financeiros',
                    'Tinha acesso √†s chaves do local do crime',
                    'Sua alibi para o hor√°rio do crime √© inconsistente',
                    'Possui hist√≥rico de viol√™ncia dom√©stica',
                    'Foi visto discutindo com a v√≠tima no dia anterior'
                ],
                'equipment_camera': [
                    'A grava√ß√£o mostra uma figura masculina no local',
                    'O suspeito usava roupas escuras',
                    'A pessoa tinha aproximadamente 1,75m de altura',
                    'Movimentos sugerem conhecimento do local',
                    'Hor√°rio da grava√ß√£o: 23:47 - 00:15'
                ],
                'equipment_forensic': [
                    'Permite an√°lise de DNA encontrado na cena',
                    'Pode identificar impress√µes digitais',
                    'Revela evid√™ncias de luta f√≠sica',
                    'An√°lise de manchas de sangue',
                    'Detec√ß√£o de res√≠duos de p√≥lvora'
                ],
                'action_interrogation': [
                    'Pode revelar inconsist√™ncias nas declara√ß√µes',
                    'T√©cnicas de press√£o psicol√≥gica',
                    'An√°lise de linguagem corporal',
                    'Detec√ß√£o de mentiras',
                    'Pode levar a confiss√µes'
                ],
                'action_warrant': [
                    'Permite busca na casa do suspeito',
                    'Pode revelar armas escondidas',
                    'Acesso a documentos pessoais',
                    'Busca em local de trabalho',
                    'An√°lise de computadores e celulares'
                ],
                'evidence_dna': [
                    'DNA masculino encontrado na v√≠tima',
                    'Sangue do suspeito na cena',
                    'Cabelos encontrados no local',
                    'Saliva em copo na cena',
                    'Compara√ß√£o com banco de dados'
                ],
                'ally_officer': [
                    'Conhecimento da √°rea local',
                    'Acesso a registros policiais',
                    'Contatos com informantes',
                    'Experi√™ncia em patrulhamento',
                    'Recursos adicionais de investiga√ß√£o'
                ],
                'evidence_ballistic': [
                    'Arma calibre .38 encontrada',
                    'Muni√ß√µes compat√≠veis com ferimentos',
                    'Trajet√≥ria dos proj√©teis',
                    'Dist√¢ncia do tiro',
                    'Compara√ß√£o com outras armas'
                ],
                'action_psychological': [
                    'An√°lise do perfil do assassino',
                    'Motivos poss√≠veis para o crime',
                    'Padr√µes comportamentais',
                    'Hist√≥rico psicol√≥gico dos suspeitos',
                    'Indicadores de psicopatia'
                ],
                'equipment_microscope': [
                    'An√°lise de fibras de tecido',
                    'Detec√ß√£o de res√≠duos qu√≠micos',
                    'An√°lise de manchas microsc√≥picas',
                    'Identifica√ß√£o de materiais',
                    'Evid√™ncias de contato f√≠sico'
                ],
                'evidence_fingerprint': [
                    'Impress√µes digitais na arma',
                    'Digitais em superf√≠cies da cena',
                    'Compara√ß√£o com suspeitos',
                    'Identifica√ß√£o de visitantes',
                    'Padr√µes de movimento na cena'
                ],
                'ally_detective': [
                    'Experi√™ncia em casos similares',
                    'Intui√ß√£o investigativa apurada',
                    'Conhecimento de padr√µes criminais',
                    'T√©cnicas avan√ßadas de interrogat√≥rio',
                    'Rede de contatos profissionais'
                ]
            };
            
            return clues[cardData.id] || ['Informa√ß√µes detalhadas em an√°lise...'];
        }

        function getRarityName(rarity) {
            const rarityNames = {
                common: 'Comum',
                rare: 'Rara',
                epic: '√âpica',
                legendary: 'Lend√°ria'
            };
            return rarityNames[rarity] || 'Comum';
        }
        
        function checkAchievements() {
            // Primeira carta
            if (!achievements.firstCard.completed && cardsPlayed === 1) {
                unlockAchievement('firstCard');
            }
            
            // 20 cartas jogadas
            if (!achievements.investigator.completed && cardsPlayed >= 20) {
                unlockAchievement('investigator');
            }
            
            // Combo master
            if (!achievements.comboMaster.completed && comboStreak >= 10) {
                unlockAchievement('comboMaster');
            }
            
            // Wealthy
            if (!achievements.wealthy.completed && playerCoins >= 1000) {
                unlockAchievement('wealthy');
            }
        }
        
        function unlockAchievement(achievementId) {
            const achievement = achievements[achievementId];
            if (achievement && !achievement.completed) {
                achievement.completed = true;
                
                // Adicionar √† lista de conquistas recentes
                const achievementData = {
                    id: achievementId,
                    ...achievement,
                    timestamp: new Date().toLocaleTimeString('pt-BR', { 
                        hour: '2-digit', 
                        minute: '2-digit' 
                    })
                };
                
                recentAchievements.unshift(achievementData);
                
                // Manter apenas as 5 conquistas mais recentes
                if (recentAchievements.length > 5) {
                    recentAchievements = recentAchievements.slice(0, 5);
                }
                
                // Atualizar display de conquistas
                updateAchievementsDisplay();
                
                // Recompensa e feedback
                rewardCoins(achievement.reward, `üèÜ CONQUISTA: ${achievement.message}`);
                
                // Salvar conquistas
                localStorage.setItem('criminalMinds_achievements', JSON.stringify(achievements));
                localStorage.setItem('criminalMinds_recentAchievements', JSON.stringify(recentAchievements));
                
                // Efeito especial
                showNotification(`üèÜ CONQUISTA DESBLOQUEADA!\n${achievement.message}\n+${achievement.reward} moedas!`);
                
                // Efeito visual especial na conquista
                setTimeout(() => {
                    const achievementElement = document.querySelector(`[data-achievement-id="${achievementId}"]`);
                    if (achievementElement) {
                        achievementElement.style.animation = 'none';
                        achievementElement.offsetHeight; // Trigger reflow
                        achievementElement.style.animation = 'achievementSlideIn 0.6s ease-out';
                    }
                }, 100);
            }
        }
        
        function loadAchievements() {
            const saved = localStorage.getItem('criminalMinds_achievements');
            if (saved) {
                const savedAchievements = JSON.parse(saved);
                Object.assign(achievements, savedAchievements);
            }
            
            const savedRecent = localStorage.getItem('criminalMinds_recentAchievements');
            if (savedRecent) {
                recentAchievements = JSON.parse(savedRecent);
            }
            
            // Atualizar display inicial
            updateAchievementsDisplay();
        }

        function updateAchievementsDisplay() {
            const container = document.getElementById('achievements-container');
            const noAchievements = document.getElementById('no-achievements');
            
            if (!container) return;
            
            if (recentAchievements.length === 0) {
                if (noAchievements) {
                    noAchievements.style.display = 'block';
                }
                // Limpar conquistas existentes
                const existingAchievements = container.querySelectorAll('.achievement-item');
                existingAchievements.forEach(item => item.remove());
                return;
            }
            
            // Ocultar mensagem "sem conquistas"
            if (noAchievements) {
                noAchievements.style.display = 'none';
            }
            
            // Limpar conquistas existentes
            const existingAchievements = container.querySelectorAll('.achievement-item');
            existingAchievements.forEach(item => item.remove());
            
            // Adicionar conquistas recentes
            recentAchievements.forEach((achievement, index) => {
                const achievementElement = createAchievementElement(achievement);
                container.appendChild(achievementElement);
                
                // Anima√ß√£o escalonada para m√∫ltiplas conquistas
                setTimeout(() => {
                    achievementElement.style.opacity = '1';
                    achievementElement.style.transform = 'translateX(0)';
                }, index * 100);
            });
        }

        function createAchievementElement(achievement) {
            const element = document.createElement('div');
            element.className = `achievement-item ${achievement.type}`;
            element.setAttribute('data-achievement-id', achievement.id);
            
            element.innerHTML = `
                <div class="achievement-reward">+${achievement.reward} üí∞</div>
                <div style="display: flex; align-items: flex-start;">
                    <span class="achievement-icon">${achievement.icon}</span>
                    <div style="flex: 1;">
                        <div class="achievement-title">${achievement.message}</div>
                        <div class="achievement-description">${achievement.description}</div>
                        <div class="achievement-timestamp">Desbloqueada √†s ${achievement.timestamp}</div>
                    </div>
                </div>
            `;
            
            // Iniciar invis√≠vel para anima√ß√£o
            element.style.opacity = '0';
            element.style.transform = 'translateX(-20px)';
            
            return element;
        }
        
        // ========================================
        // FUN√á√ïES DE ESTAT√çSTICAS POR DIFICULDADE
        // ========================================
        
        function updateCurrentDifficultyDisplay(difficulty) {
            const difficultyNames = {
                'easy': 'Iniciante',
                'medium': 'Intermedi√°rio',
                'hard': 'Dif√≠cil'
            };
            
            const currentDifficultyElement = document.getElementById('currentDifficulty');
            if (currentDifficultyElement) {
                currentDifficultyElement.textContent = difficultyNames[difficulty] || 'Intermedi√°rio';
            }
        }
        
        function loadDifficultyStats() {
            // Simular carregamento de estat√≠sticas (em produ√ß√£o viria da API)
            const mockStats = {
                easy: {
                    gamesPlayed: 5,
                    gamesWon: 4,
                    winRate: '80.0',
                    bestTimeFormatted: '3:45'
                },
                medium: {
                    gamesPlayed: 12,
                    gamesWon: 8,
                    winRate: '66.7',
                    bestTimeFormatted: '5:22'
                },
                hard: {
                    gamesPlayed: 3,
                    gamesWon: 1,
                    winRate: '33.3',
                    bestTimeFormatted: '8:15'
                }
            };
            
            // Comentado temporariamente para evitar erro de elementos n√£o encontrados
            // updateDifficultyStatsDisplay(mockStats);
            console.log('üìä Estat√≠sticas por dificuldade carregadas (elementos n√£o encontrados no HTML)');
        }
        
        function updateDifficultyStatsDisplay(stats) {
            console.log('üìä Tentando atualizar estat√≠sticas por dificuldade...');
            
            // Verificar se os elementos existem antes de tentar acess√°-los
            const elements = {
                easyWinRate: document.getElementById('easyWinRate'),
                easyStats: document.getElementById('easyStats'),
                easyBestTime: document.getElementById('easyBestTime'),
                mediumWinRate: document.getElementById('mediumWinRate'),
                mediumStats: document.getElementById('mediumStats'),
                mediumBestTime: document.getElementById('mediumBestTime'),
                hardWinRate: document.getElementById('hardWinRate'),
                hardStats: document.getElementById('hardStats'),
                hardBestTime: document.getElementById('hardBestTime')
            };
            
            // Atualizar apenas elementos que existem
            if (elements.easyWinRate) {
                elements.easyWinRate.textContent = stats.easy.winRate + '%';
                console.log('üìä easyWinRate atualizado');
            }
            
            if (elements.easyStats) {
                elements.easyStats.textContent = `${stats.easy.gamesWon}/${stats.easy.gamesPlayed} jogos`;
                console.log('üìä easyStats atualizado');
            }
            
            if (elements.easyBestTime) {
                elements.easyBestTime.textContent = stats.easy.bestTimeFormatted;
                console.log('üìä easyBestTime atualizado');
            }
            
            if (elements.mediumWinRate) {
                elements.mediumWinRate.textContent = stats.medium.winRate + '%';
                console.log('üìä mediumWinRate atualizado');
            }
            
            if (elements.mediumStats) {
                elements.mediumStats.textContent = `${stats.medium.gamesWon}/${stats.medium.gamesPlayed} jogos`;
                console.log('üìä mediumStats atualizado');
            }
            
            if (elements.mediumBestTime) {
                elements.mediumBestTime.textContent = stats.medium.bestTimeFormatted;
                console.log('üìä mediumBestTime atualizado');
            }
            
            if (elements.hardWinRate) {
                elements.hardWinRate.textContent = stats.hard.winRate + '%';
                console.log('üìä hardWinRate atualizado');
            }
            
            if (elements.hardStats) {
                elements.hardStats.textContent = `${stats.hard.gamesWon}/${stats.hard.gamesPlayed} jogos`;
                console.log('üìä hardStats atualizado');
            }
            
            if (elements.hardBestTime) {
                elements.hardBestTime.textContent = stats.hard.bestTimeFormatted;
                console.log('üìä hardBestTime atualizado');
            }
            
            console.log('üìä Atualiza√ß√£o de estat√≠sticas por dificuldade conclu√≠da');
        }
        
        function startTimer() {
            // Carregar conquistas salvas
            loadAchievements();
            
            // Comentado temporariamente para evitar erro de elementos n√£o encontrados
            // loadDifficultyStats();
            console.log('‚è±Ô∏è Timer iniciado - estat√≠sticas por dificuldade desabilitadas');

            // FOR√áAR REMO√á√ÉO DA SE√á√ÉO MINHA M√ÉO
            function removeHandSection() {
                const selectors = [
                    '.deck-area',
                    '.hand-cards', 
                    '.mini-card',
                    '[class*="hand"]',
                    '[id*="hand"]',
                    '[class*="mao"]',
                    '[id*="mao"]',
                    '[class*="deck"]',
                    '[id*="deck"]'
                ];
                
                selectors.forEach(selector => {
                    const elements = document.querySelectorAll(selector);
                    elements.forEach(el => {
                        if (!el.closest('.main-area')) { // N√£o remover cartas da √°rea principal
                            el.remove();
                        }
                    });
                });
            }
            
            // Remover imediatamente e depois de 1 segundo
            removeHandSection();
            setTimeout(removeHandSection, 1000);
            
            // Gerar cartas iniciais
            generateCards();
            
            // Verificar b√¥nus di√°rio ao iniciar
            checkDailyBonus();
            
            // Atualizar display inicial de moedas
            updateCoinDisplay();
            
            // Inicializar o timer automaticamente
            startTimerInterval();
            
            // Adicionar mensagem inicial sobre o tempo
            setTimeout(() => {
                addChatMessage("‚è±Ô∏è 45 minutos para resolver o caso. Boa sorte!", "Hotchner");
            }, 2000);
        }

        function calculateFinalRewards() {
            let finalBonus = 0;
            let reasons = [];
            
            // B√¥nus por cartas jogadas
            if (cardsPlayed >= 10) {
                finalBonus += 50;
                reasons.push("10+ cartas jogadas");
            }
            
            // B√¥nus por combo streak
            if (comboStreak >= 5) {
                finalBonus += coinRewards.combo5.amount;
                reasons.push("Combo 5x mantido");
            }
            
            // B√¥nus de conclus√£o
            finalBonus += coinRewards.investigation.amount;
            reasons.push("Investiga√ß√£o conclu√≠da");
            
            if (finalBonus > 0) {
                rewardCoins(finalBonus, reasons.join(", "));
            }
        }

        // Inicializar timer imediatamente quando a p√°gina carrega
        startTimer();
        
        // Garantir que o timer inicie imediatamente
        setTimeout(() => {
            if (!isTimerRunning) {
                console.log('üîÑ Reiniciando timer...');
                startTimerInterval();
            }
        }, 100);



        function playFromHand(cardId) {
            const handCards = {
                'witness': 'üëÅÔ∏è Testemunha interrogada! Obteve informa√ß√µes valiosas.',
                'phone-data': 'üì± Dados do celular analisados! √öltimas chamadas reveladas.',
                'ballistics': 'üéØ An√°lise bal√≠stica completa! Trajet√≥ria confirmada.',
                'surveillance': 'üìπ C√¢meras revisadas! Suspeito identificado.',
                'profile': 'üß† Perfil psicol√≥gico atualizado! Padr√£o comportamental detectado.',
                'warrant': 'üìú Mandado executado! Evid√™ncias legalmente obtidas.'
            };

            const effect = handCards[cardId] || 'Carta da m√£o jogada!';

            // Remover carta da m√£o (efeito visual)
            event.currentTarget.style.animation = 'cardAppear 0.5s ease-out reverse';
            setTimeout(() => {
                event.currentTarget.style.opacity = '0.3';
                event.currentTarget.style.pointerEvents = 'none';
            }, 500);
            
            // Recompensa por jogar carta da m√£o (b√¥nus extra)
            rewardCoins(coinRewards.cardPlayed.amount + 3, "Carta da m√£o jogada");
            
            showNotification(effect);
            addChatMessage(`üÉè Da m√£o: ${effect}`, 'self');

            // Atualizar estat√≠sticas
            cardsPlayed++;
            comboStreak++;
            
            // Sistema de recompensas por combo (tamb√©m para cartas da m√£o)
            if (comboStreak === 3) {
                rewardCoins(coinRewards.combo3.amount, coinRewards.combo3.message);
            } else if (comboStreak === 5) {
                rewardCoins(coinRewards.combo5.amount, coinRewards.combo5.message);
            } else if (comboStreak >= 7) {
                rewardCoins(coinRewards.combo7.amount, coinRewards.combo7.message);
            }
            
            updateStats();
            
            // Verificar conquistas
            checkAchievements();
        }

        function showCardEffect(effect) {
            // Criar popup de efeito da carta
            const popup = document.createElement('div');
            popup.style.cssText = `
                position: fixed;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                background: linear-gradient(135deg, #1a1a2e, #16213e);
                border: 3px solid #fbbf24;
                border-radius: 20px;
                padding: 2rem;
                z-index: 3000;
                text-align: center;
                box-shadow: 0 20px 60px rgba(0, 0, 0, 0.8);
                animation: cardAppear 0.6s ease-out;
            `;
            
            popup.innerHTML = `
                <h3 style="color: #fbbf24; margin-bottom: 1rem; font-size: 1.5rem;">${effect.title}</h3>
                <p style="color: #cbd5e1; margin-bottom: 1rem; font-size: 1.1rem;">${effect.effect}</p>
                <p style="color: #6b7280; font-style: italic;">${effect.sound}</p>
                <button class="btn" onclick="this.parentElement.remove()" style="margin-top: 1.5rem;">‚ú® Continuar</button>
            `;
            
            document.body.appendChild(popup);
            
            // Remover automaticamente ap√≥s 5 segundos
            setTimeout(() => {
                if (popup.parentElement) {
                    popup.remove();
                }
            }, 5000);
        }

        function showNotification(message) {
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: linear-gradient(135deg, #fbbf24, #f59e0b);
                color: #0f0f23;
                padding: 1rem 1.5rem;
                border-radius: 12px;
                font-weight: 600;
                z-index: 2000;
                box-shadow: 0 10px 30px rgba(251, 191, 36, 0.4);
                animation: cardAppear 0.5s ease-out;
            `;
            notification.textContent = message;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.animation = 'cardAppear 0.5s ease-out reverse';
                setTimeout(() => notification.remove(), 500);
            }, 3000);
        }



        // Fun√ß√µes do deck
        function drawCard() {
            const newCards = [
                'üîç Lupa M√°gica',
                'üìã Relat√≥rio Forense',
                'üé≠ Disfarce',
                'üí° Inspira√ß√£o',
                'üîê Chave Mestra'
            ];
            
            const randomCard = newCards[Math.floor(Math.random() * newCards.length)];
            showNotification(`üé¥ Nova carta: ${randomCard}`);
            addChatMessage(`üé¥ Comprei: ${randomCard}`, 'self');
        }

        function shuffleDeck() {
            showNotification('üîÄ Deck embaralhado! Novas possibilidades dispon√≠veis.');
            addChatMessage('üîÄ Embaralhei meu deck', 'self');
        }

        function useCombo() {
            if (comboStreak >= 3) {
                // Recompensa baseada no n√≠vel do combo
                let comboReward = 0;
                let comboMessage = '';
                
                if (comboStreak >= 7) {
                    comboReward = coinRewards.combo7.amount;
                    comboMessage = coinRewards.combo7.message;
                } else if (comboStreak >= 5) {
                    comboReward = coinRewards.combo5.amount;
                    comboMessage = coinRewards.combo5.message;
                } else {
                    comboReward = coinRewards.combo3.amount;
                    comboMessage = coinRewards.combo3.message;
                }
                
                // B√¥nus extra por usar combo manualmente
                comboReward += 25;
                
                rewardCoins(comboReward, `${comboMessage} (Ativa√ß√£o manual)`);
                showNotification(`‚ö° COMBO ATIVADO! +${comboReward} moedas!`);
                addChatMessage(`‚ö° Usei combo devastador! +${comboReward} moedas`, 'self');
                
                comboStreak = 0;
                updateStats();
            } else {
                showNotification('‚ùå Combo insuficiente. Precisa de pelo menos 3 cartas em sequ√™ncia.');
            }
        }

        // Loja de cartas
        function buyPack(packType) {
            const packs = {
                'basic': { cost: 100, cards: 3, rares: 0 },
                'premium': { cost: 250, cards: 5, rares: 1 },
                'legendary': { cost: 500, cards: 8, rares: 3 }
            };
            
            const pack = packs[packType];
            
            if (spendCoins(pack.cost, `Pacote ${packType}`)) {
                showNotification(`üì¶ Pacote ${packType} comprado! ${pack.cards} cartas obtidas!`);
                addChatMessage(`üí∞ Comprei pacote ${packType}! ${pack.cards} novas cartas`, 'self');
                
                // Simular abertura de pacote com poss√≠vel moeda b√¥nus
                if (packType === 'legendary' && Math.random() < 0.3) {
                    rewardCoins(50, "Carta rara encontrada no pacote!");
                }
            } else {
                showNotification(`‚ùå Moedas insuficientes! Voc√™ tem ${playerCoins}, precisa de ${pack.cost}.`);
            }
        }


        
        function showMessageSuccess() {
            const success = document.createElement('div');
            success.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: linear-gradient(135deg, #10b981, #059669);
                color: white;
                padding: 0.8rem 1.5rem;
                border-radius: 12px;
                font-weight: 600;
                z-index: 3000;
                box-shadow: 0 10px 30px rgba(16, 185, 129, 0.4);
                animation: slideIn 0.3s ease-out;
            `;
            success.innerHTML = '‚úÖ Mensagem enviada!';
            
            document.body.appendChild(success);
            
            setTimeout(() => {
                success.style.animation = 'slideIn 0.3s ease-out reverse';
                setTimeout(() => success.remove(), 300);
            }, 2000);
        }



        // Modais
        function openDeck() {
            alert('üÉè Sistema de deck em desenvolvimento! Em breve voc√™ poder√° personalizar completamente seu baralho.');
        }

        function showCollection() {
            document.getElementById('collectionModal').style.display = 'block';
        }

        function makeAccusation() {
            const confirmAccusation = confirm('‚öñÔ∏è Tem certeza que deseja fazer sua acusa√ß√£o final?\n\nüÉè Suas cartas jogadas determinar√£o o resultado.\n\n‚úÖ Clique OK para fazer a acusa√ß√£o\n‚ùå Clique Cancelar para continuar investigando');
            
            if (confirmAccusation) {
                // Calcular resultado baseado nas cartas jogadas
                const success = Math.random() > 0.5; // Simula√ß√£o simples (50% chance)
                
                // B√¥nus final baseado no desempenho
                calculateFinalRewards();
                
                // Mostrar resultado final
                showGameEndModal(success ? 'win' : 'lose');
            }
        }

        function exitGame() {
            const confirmExit = confirm('üö™ Tem certeza que deseja sair do jogo?\n\n‚ö†Ô∏è Todo o progresso n√£o salvo ser√° perdido.\n\n‚úÖ Clique OK para sair\n‚ùå Clique Cancelar para continuar jogando');
            
            if (confirmExit) {
                // Parar o timer se estiver rodando
                if (window.simpleGameTimer) {
                    window.simpleGameTimer.stop();
                }
                
                // Limpar dados tempor√°rios
                localStorage.removeItem('criminalMinds_timerStarted');
                localStorage.removeItem('criminalMinds_timerStartTime');
                
                // Salvar estat√≠sticas finais
                const exitData = {
                    exitTime: new Date().toISOString(),
                    cardsPlayed: cardsPlayed || 0,
                    playerCoins: playerCoins || 0,
                    timeRemaining: gameTime || 0,
                    reason: 'user_exit'
                };
                
                localStorage.setItem('criminalMinds_exitData', JSON.stringify(exitData));
                
                // Redirecionar para o lobby
                window.location.href = 'lobby.html';
            }
        }

        // Fun√ß√£o para mostrar modal de fim de jogo
        function showGameEndModal(result) {
            let title, message, icon, color;
            
            switch(result) {
                case 'win':
                    title = 'üéâ CASO RESOLVIDO!';
                    message = 'Parab√©ns! Voc√™ desvendou o mist√©rio e capturou o criminoso!';
                    icon = 'üèÜ';
                    color = '#10b981';
                    break;
                case 'lose':
                    title = '‚ùå CASO ARQUIVADO';
                    message = 'Sua acusa√ß√£o estava incorreta. O criminoso escapou desta vez...';
                    icon = 'üíî';
                    color = '#ef4444';
                    break;
                case 'timeout':
                    title = '‚è∞ TEMPO ESGOTADO';
                    message = 'O tempo acabou! O caso foi encerrado sem solu√ß√£o definitiva.';
                    icon = '‚åõ';
                    color = '#f59e0b';
                    break;
                default:
                    title = 'üèÅ FIM DE JOGO';
                    message = 'A investiga√ß√£o chegou ao fim.';
                    icon = 'üéÆ';
                    color = '#6b7280';
            }
            
            // Salvar progresso e estat√≠sticas
            const gameData = {
                result: result,
                cardsPlayed: cardsPlayed,
                comboStreak: comboStreak,
                playerCoins: playerCoins,
                timeRemaining: gameTime,
                endTime: new Date().toISOString()
            };
            
            localStorage.setItem('criminalMinds_lastGameResult', JSON.stringify(gameData));
            
            // Criar modal de resultado
            const resultModal = document.createElement('div');
            resultModal.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0, 0, 0, 0.9);
                display: flex;
                justify-content: center;
                align-items: center;
                z-index: 5000;
            `;
            
            const modalContent = document.createElement('div');
            modalContent.style.cssText = `
                background: linear-gradient(135deg, #1a1a2e, #16213e);
                border: 3px solid ${color};
                border-radius: 25px;
                padding: 3rem;
                text-align: center;
                max-width: 500px;
                width: 90%;
                box-shadow: 0 30px 80px rgba(0, 0, 0, 0.8);
                animation: modalSlideIn 0.5s ease-out;
            `;
            
            modalContent.innerHTML = `
                <div style="font-size: 4rem; margin-bottom: 1rem;">${icon}</div>
                <h2 style="color: ${color}; font-size: 2rem; margin-bottom: 1rem;">${title}</h2>
                <p style="color: #cbd5e1; font-size: 1.1rem; margin-bottom: 2rem; line-height: 1.6;">${message}</p>
                
                <div style="background: rgba(0, 0, 0, 0.3); border-radius: 15px; padding: 1.5rem; margin-bottom: 2rem;">
                    <h3 style="color: #fbbf24; margin-bottom: 1rem;">üìä Resumo da Investiga√ß√£o</h3>
                    <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 1rem; font-size: 0.9rem;">
                        <div style="color: #94a3b8;">üÉè Cartas Jogadas: <span style="color: #fbbf24; font-weight: bold;">${cardsPlayed}</span></div>
                        <div style="color: #94a3b8;">‚ö° Combo M√°ximo: <span style="color: #fbbf24; font-weight: bold;">${comboStreak}x</span></div>
                        <div style="color: #94a3b8;">üí∞ Moedas Ganhas: <span style="color: #fbbf24; font-weight: bold;">${playerCoins}</span></div>
                        <div style="color: #94a3b8;">‚è±Ô∏è Tempo Restante: <span style="color: #fbbf24; font-weight: bold;">${Math.floor(gameTime / 60)}:${(gameTime % 60).toString().padStart(2, '0')}</span></div>
                    </div>
                </div>
                
                <div style="color: #6b7280; font-style: italic; margin-bottom: 1.5rem;">Retornando ao lobby em <span id="countdown">5</span> segundos...</div>
                <button onclick="returnToLobby()" style="
                    background: linear-gradient(135deg, #fbbf24, #f59e0b);
                    color: #0f0f23;
                    border: none;
                    padding: 1rem 2rem;
                    border-radius: 10px;
                    font-weight: bold;
                    font-size: 1rem;
                    cursor: pointer;
                    transition: all 0.3s ease;
                " onmouseover="this.style.transform='scale(1.05)'" onmouseout="this.style.transform='scale(1)'">
                    üè† Voltar ao Lobby Agora
                </button>
            `;
            
            // Adicionar anima√ß√£o CSS
            const style = document.createElement('style');
            style.textContent = `
                @keyframes modalSlideIn {
                    from { opacity: 0; transform: translateY(-50px) scale(0.9); }
                    to { opacity: 1; transform: translateY(0) scale(1); }
                }
            `;
            document.head.appendChild(style);
            
            resultModal.appendChild(modalContent);
            document.body.appendChild(resultModal);
            
            // Countdown autom√°tico
            let countdown = 5;
            const countdownElement = document.getElementById('countdown');
            const countdownInterval = setInterval(() => {
                countdown--;
                if (countdownElement) {
                    countdownElement.textContent = countdown;
                }
                if (countdown <= 0) {
                    clearInterval(countdownInterval);
                    returnToLobby();
                }
            }, 1000);
        }
        
        function returnToLobby() {
            window.location.href = 'lobby.html';
        }

        // Fun√ß√£o para sair da investiga√ß√£o
        function exitInvestigation() {
            // Mostrar modal de confirma√ß√£o
            const confirmExit = confirm('üö™ Tem certeza que deseja sair da investiga√ß√£o?\n\n‚ö†Ô∏è Seu progresso atual ser√° salvo, mas voc√™ perder√° o timer atual.\n\n‚úÖ Clique OK para voltar ao lobby\n‚ùå Clique Cancelar para continuar jogando');
            
            if (confirmExit) {
                // Salvar progresso antes de sair
                const gameData = {
                    cardsPlayed: cardsPlayed,
                    comboStreak: comboStreak,
                    playerCoins: playerCoins,
                    exitTime: new Date().toISOString(),
                    timeRemaining: gameTime
                };
                
                localStorage.setItem('criminalMinds_gameProgress', JSON.stringify(gameData));
                
                // Mostrar feedback de sa√≠da
                const exitFeedback = document.createElement('div');
                exitFeedback.style.cssText = `
                    position: fixed;
                    top: 50%;
                    left: 50%;
                    transform: translate(-50%, -50%);
                    background: linear-gradient(135deg, #1a1a2e, #16213e);
                    border: 3px solid #fbbf24;
                    border-radius: 20px;
                    padding: 2rem;
                    z-index: 4000;
                    text-align: center;
                    box-shadow: 0 20px 60px rgba(0, 0, 0, 0.8);
                    color: white;
                `;
                
                exitFeedback.innerHTML = `
                    <h3 style="color: #fbbf24; margin-bottom: 1rem;">üö™ Saindo da Investiga√ß√£o...</h3>
                    <p style="color: #cbd5e1; margin-bottom: 1rem;">‚úÖ Progresso salvo com sucesso!</p>
                    <p style="color: #6b7280; font-style: italic;">Redirecionando para o lobby...</p>
                `;
                
                document.body.appendChild(exitFeedback);
                
                // Redirecionar ap√≥s 2 segundos
                setTimeout(() => {
                    window.location.href = 'lobby.html';
                }, 2000);
            }
        }

        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
        }

        // Fechar modal clicando fora
        window.onclick = function(event) {
            const modals = ['cardModal', 'collectionModal'];
            modals.forEach(modalId => {
                const modal = document.getElementById(modalId);
                if (event.target == modal) {
                    modal.style.display = 'none';
                }
            });
        }

        // SISTEMA DE CHAT DA EQUIPE
        let chatMessages = [];
        let teamMembers = [
            { name: 'Detetive Reid', status: 'Online', cards: 127, avatar: 'üß†' },
            { name: 'Agente Morgan', status: 'Online', cards: 98, avatar: 'üí™' },
            { name: 'Dra. Brennan', status: 'Online', cards: 156, avatar: 'üî¨' },
            { name: 'Garcia', status: 'Online', cards: 203, avatar: 'üíª' },
            { name: 'Hotchner', status: 'Online', cards: 89, avatar: 'üëî' }
        ];

        // Simula√ß√£o de atividade da equipe
        function simulateTeamActivity() {
            const activities = [
                { message: "üé¥ Joguei carta LEND√ÅRIA: Perfil Completo!", author: "Reid" },
                { message: "‚ö° Ativei combo de 5 cartas! +50 pontos", author: "Morgan" },
                { message: "üíé Encontrei carta √âPICA rara!", author: "Brennan" },
                { message: "üî• Comprei pacote premium!", author: "Garcia" },
                { message: "‚ú® Desbloqueei conquista especial!", author: "Hotchner" },
                { message: "üîç Nova evid√™ncia coletada!", author: "Reid" },
                { message: "üìä Progresso: 75% das evid√™ncias", author: "Morgan" },
                { message: "üéØ Suspeito identificado!", author: "Brennan" },
                { message: "üí° Ideia brilhante para o caso!", author: "Garcia" },
                { message: "üö® Alerta: Tempo acabando!", author: "Hotchner" }
            ];
            
            setInterval(() => {
                if (Math.random() < 0.3) {
                    const activity = activities[Math.floor(Math.random() * activities.length)];
                    addChatMessage(activity.message, activity.author);
                }
            }, 10000);
        }

        // Fun√ß√£o para adicionar mensagem ao chat
        function addChatMessage(message, author) {
            const chatContainer = document.getElementById('chatMessages');
            if (!chatContainer) return;

            const messageDiv = document.createElement('div');
            messageDiv.className = 'chat-message';
            
            const timestamp = new Date().toLocaleTimeString('pt-BR', { 
                hour: '2-digit', 
                minute: '2-digit' 
            });
            
            const member = teamMembers.find(m => m.name.includes(author)) || { avatar: 'üë§' };
            
            messageDiv.innerHTML = `
                <div class="chat-message-header">
                    <span class="chat-user">${member.avatar} ${author}:</span>
                    <span class="chat-time">${timestamp}</span>
                </div>
                <div class="chat-content">${message}</div>
            `;
            
            chatContainer.appendChild(messageDiv);
            chatContainer.scrollTop = chatContainer.scrollHeight;
            
            // Limitar mensagens (manter apenas as √∫ltimas 20)
            const messages = chatContainer.querySelectorAll('.chat-message');
            if (messages.length > 20) {
                messages[0].remove();
            }
        }

        // Fun√ß√£o para enviar mensagem do usu√°rio com feedback visual
        function sendUserMessage() {
            const input = document.getElementById('chatInput');
            const sendButton = document.getElementById('sendButton');
            const message = input.value.trim();
            
            if (message) {
                // Feedback visual no bot√£o
                sendButton.style.transform = 'scale(0.95)';
                sendButton.innerHTML = '<span class="send-button-text">Enviando...</span><span class="send-button-icon">‚è≥</span><div class="send-button-ripple"></div>';
                sendButton.disabled = true;
                sendButton.classList.add('highlight');
                
                // Feedback visual no input
                input.style.borderColor = '#10b981';
                input.style.boxShadow = '0 0 20px rgba(16, 185, 129, 0.4)';
                
                setTimeout(() => {
                    // Restaurar bot√£o
                    sendButton.innerHTML = '<span class="send-button-text">Enviar</span><span class="send-button-icon">üì§</span><div class="send-button-ripple"></div>';
                    sendButton.disabled = false;
                    sendButton.style.transform = '';
                    sendButton.classList.remove('highlight');
                    
                    // Restaurar input
                    input.style.borderColor = '';
                    input.style.boxShadow = '';
                    
                    // Adicionar mensagem
                    const detectiveName = localStorage.getItem('detectiveName') || 'Detetive';
                    addChatMessage(message, detectiveName);
                    input.value = '';
                    
                    // Efeito de sucesso
                    showMessageSuccess();
                    
                }, 300);
                
                // Simular resposta da equipe ap√≥s 2-5 segundos
                setTimeout(() => {
                    const responses = [
                        "Entendi! Boa observa√ß√£o! üëç",
                        "Vou investigar isso! üîç",
                        "Excelente ponto! üëè",
                        "Concordo totalmente! üíØ",
                        "Vamos focar nessa pista! üéØ",
                        "Boa estrat√©gia! üöÄ",
                        "Perfeito! Continue assim! ‚ú®",
                        "Vou verificar isso! üîé"
                    ];
                    
                    const randomResponse = responses[Math.floor(Math.random() * responses.length)];
                    const randomMember = teamMembers[Math.floor(Math.random() * teamMembers.length)];
                    addChatMessage(randomResponse, randomMember.name.split(' ')[1]); // Usar apenas o sobrenome
                }, 2300 + Math.random() * 3000);
            } else {
                // Feedback para mensagem vazia
                input.style.borderColor = '#ef4444';
                input.style.boxShadow = '0 0 20px rgba(239, 68, 68, 0.4)';
                input.placeholder = 'Digite algo antes de enviar...';
                
                setTimeout(() => {
                    input.style.borderColor = '';
                    input.style.boxShadow = '';
                    input.placeholder = 'Digite sua mensagem...';
                }, 2000);
            }
        }

        // Fun√ß√£o para inicializar o chat
        function initializeChat() {
            const chatInput = document.getElementById('chatInput');
            const sendButton = document.getElementById('sendButton');
            
            if (chatInput) {
                chatInput.addEventListener('keypress', (e) => {
                    if (e.key === 'Enter') {
                        sendUserMessage();
                    }
                });
            }
            
            if (sendButton) {
                sendButton.addEventListener('click', sendUserMessage);
            }
            
            // Adicionar mensagens iniciais
            setTimeout(() => {
                addChatMessage("üîç Iniciando investiga√ß√£o...", "Reid");
            }, 1000);
            
            setTimeout(() => {
                addChatMessage("üí™ Pronto para a√ß√£o!", "Morgan");
            }, 2000);
            
            setTimeout(() => {
                addChatMessage("üî¨ Laborat√≥rio preparado!", "Brennan");
            }, 3000);
        }

        // Inicializar
        simulateTeamActivity();
        
        // Inicializar contador baseado no n√≠vel atual
        initializeCardsCounter();

        // SISTEMA DE CARTAS INTERATIVAS COMPLETO
        // Vari√°veis j√° declaradas anteriormente, apenas inicializando valores
        cardsPlayed = 0;
        comboStreak = 0;
        playerCoins = 500;
        let totalEvidence = 0;
        let currentCase = {
            id: 'case-001',
            title: 'Assassinato no Condom√≠nio Luxo',
            description: 'Uma mulher foi encontrada morta em seu apartamento. Todas as portas estavam trancadas por dentro.',
            targetEvidence: 100,
            collectedEvidence: 0,
            suspects: ['Marcus Thompson', 'Jo√£o Silva', 'Maria Santos'],
            clues: []
        };

        // Configura√ß√£o das cartas com evid√™ncias espec√≠ficas
        const cardEffects = {
            interrogation: {
                evidence: 8,
                description: 'Revelou informa√ß√µes sobre o relacionamento conturbado da v√≠tima',
                clue: 'V√≠tima tinha problemas com ex-marido'
            },
            forensic: {
                evidence: 12,
                description: 'Encontrou fibras de tecido e impress√µes digitais',
                clue: 'Impress√µes digitais de pessoa conhecida'
            },
            surveillance: {
                evidence: 5,
                description: 'C√¢meras mostraram entrada e sa√≠da de pessoas',
                clue: 'Suspeito visto no local na noite do crime'
            },
            search: {
                evidence: 10,
                description: 'Encontrou objetos pessoais e documentos',
                clue: 'Documentos financeiros comprometedores'
            },
            psychology: {
                evidence: 15,
                description: 'An√°lise revelou padr√£o comportamental do assassino',
                clue: 'Assassino tem conhecimento da v√≠tima'
            },
            dna: {
                evidence: 20,
                description: 'DNA encontrado na cena do crime',
                clue: 'DNA corresponde a um dos suspeitos'
            },
            witness: {
                evidence: 6,
                description: 'Testemunha viu atividade suspeita',
                clue: 'Barulhos estranhos na noite do crime'
            },
            cameras: {
                evidence: 9,
                description: 'Grava√ß√µes revelaram movimenta√ß√£o suspeita',
                clue: 'Pessoa n√£o identificada no elevador'
            },
            database: {
                evidence: 11,
                description: 'Hist√≥rico criminal revelou antecedentes',
                clue: 'Suspeito tem hist√≥rico de viol√™ncia'
            }
        };

        // Fun√ß√£o para jogar uma carta
        function playCard(cardElement) {
            console.log('üÉè Fun√ß√£o playCard chamada');
            
            if (!cardElement) {
                console.error('üÉè Erro: cardElement √© null ou undefined');
                return;
            }
            
            if (cardElement.classList.contains('played')) {
                console.log('üÉè Carta j√° foi jogada, mostrando feedback visual');
                // Feedback visual para carta j√° jogada
                cardElement.style.animation = 'cardShake 0.3s ease-in-out';
                setTimeout(() => {
                    cardElement.style.animation = '';
                }, 300);
                return; // Carta j√° foi jogada
            }
            
            // Verificar se j√° atingiu o limite de cartas para o n√≠vel atual
            const maxCardsForLevel = difficultySettings[currentDifficulty].cards;
            if (cardsPlayed >= maxCardsForLevel) {
                console.log(`üÉè Limite de cartas atingido: ${cardsPlayed}/${maxCardsForLevel}`);
                // Feedback visual para limite atingido
                cardElement.style.animation = 'cardShake 0.3s ease-in-out';
                setTimeout(() => {
                    cardElement.style.animation = '';
                }, 300);
                
                // Mostrar notifica√ß√£o
                showLimitNotification();
                return; // N√£o permitir jogar mais cartas
            }

            const cardType = cardElement.getAttribute('data-type');
            console.log(`üÉè Tipo da carta: ${cardType}`);
            
            const cardEffect = cardEffects[cardType];
            
            if (!cardEffect) {
                console.error('üÉè Tipo de carta n√£o encontrado:', cardType);
                return;
            }
            
            console.log(`üÉè Efeito da carta encontrado: ${cardEffect.evidence} evid√™ncias`);

            // Anima√ß√£o de ativa√ß√£o da carta
            cardElement.style.animation = 'cardPulse 0.3s ease-in-out';
            setTimeout(() => {
                cardElement.style.animation = '';
            }, 300);

            // Marcar carta como jogada
            cardElement.classList.add('played');
            
            // Marcar no banco de dados da carta
            const cardId = cardElement.getAttribute('data-card-id');
            if (cardId) {
                const cardData = cardDatabase.find(card => card.id === cardId);
                if (cardData) {
                    cardData.played = true;
                }
            }
            
            // Remover carta do container ap√≥s anima√ß√£o
            setTimeout(() => {
                cardElement.style.animation = 'cardFadeOut 0.5s ease-out forwards';
                setTimeout(() => {
                    cardElement.remove();
                    // Verificar se ainda h√° cartas dispon√≠veis
                    const remainingCards = document.querySelectorAll('.card:not(.played)');
                    if (remainingCards.length === 0) {
                        // Todas as cartas foram jogadas, mostrar mensagem
                        const container = document.getElementById('cardsContainer');
                        if (container) {
                            container.innerHTML = `
                                <div style="text-align: center; padding: 2rem; color: #6b7280; grid-column: 1 / -1;">
                                    <div style="font-size: 3rem; margin-bottom: 1rem;">üéâ</div>
                                    <h3 style="text-align: center; margin-bottom: 1rem;">Todas as cartas foram jogadas!</h3>
                                    <p style="text-align: center; margin-bottom: 1.5rem;">Parab√©ns! Voc√™ utilizou todas as cartas dispon√≠veis nesta investiga√ß√£o.</p>
                                    <button class="btn btn-primary" onclick="showAllCards()">üëÅÔ∏è Ver Todas as Cartas</button>
                                </div>
                            `;
                        }
                    }
                }, 500);
            }, 1000);
            
            // === ATUALIZA√á√ïES DO JOGO ===
            
            // 1. Incrementar contadores
            cardsPlayed++;
            
            // Gerenciar Combo Streak
            manageComboStreak('increment');
            
            // Registrar tempo da √∫ltima carta jogada
            window.lastCardPlayTime = Date.now();
            
            console.log(`üÉè Contadores atualizados: cardsPlayed=${cardsPlayed}, comboStreak=${comboStreak}`);
            
            // Atualizar contador de cartas jogadas imediatamente
            updateCardsPlayedCounter();
            
            // For√ßar atualiza√ß√£o adicional ap√≥s um pequeno delay
            setTimeout(() => {
                console.log('üîÑ For√ßando atualiza√ß√£o adicional do contador...');
                updateCardsPlayedCounter();
            }, 100);
            
            // For√ßar atualiza√ß√£o direta do elemento
            setTimeout(() => {
                console.log('üîß For√ßando atualiza√ß√£o direta...');
                const element = document.getElementById('cardsPlayed');
                if (element) {
                    const maxCards = difficultySettings[currentDifficulty].cards;
                    element.textContent = `${cardsPlayed}/${maxCards}`;
                    console.log('‚úÖ Atualiza√ß√£o direta realizada');
                } else {
                    console.log('‚ùå Elemento n√£o encontrado para atualiza√ß√£o direta');
                }
            }, 200);
            
            // 2. Atualizar sistema de evid√™ncias
            updateEvidenceDisplay();
            const evidenceCalculation = calculateTotalEvidence();
            console.log(`üÉè Sistema de evid√™ncias atualizado: ${evidenceCalculation.total} total`);
            
            // 4. Adicionar pista ao caso
            if (!currentCase.clues.includes(cardEffect.clue)) {
                currentCase.clues.push(cardEffect.clue);
            }
            
            // 5. Adicionar moedas baseado no combo
            const baseCoins = 10;
            const comboBonus = Math.floor(comboStreak * 2);
            const totalCoins = baseCoins + comboBonus;
            playerCoins += totalCoins;
            
            // 6. Atualizar display de moedas
            updateCoinDisplay();
            
            // 7. Salvar moedas no localStorage
            savePlayerCoins();
            
            // === ATUALIZA√á√ïES VISUAIS ===
            
            // 8. Atualizar todas as estat√≠sticas do jogo de forma s√≠ncrona
            updateAllGameStats();
            
            // 9. Mostrar feedback visual da carta
            const evidenceGained = evidenceCalculation.total - (totalEvidence - cardEffect.evidence);
            showCardPlayedFeedback(cardElement, evidenceGained, cardEffect.description);
            
            // 10. Mostrar notifica√ß√£o de evid√™ncias e moedas
            showEvidenceNotification(evidenceGained, cardEffect.description, totalCoins, comboStreak);
            
            // 12. Efeito sonoro visual (emoji)
            const soundEffect = document.createElement('div');
            soundEffect.style.cssText = `
                position: absolute;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                font-size: 2rem;
                z-index: 1000;
                animation: cardPlayedAnim 1s ease-out forwards;
                pointer-events: none;
            `;
            soundEffect.textContent = 'üîç';
            cardElement.appendChild(soundEffect);
            
            setTimeout(() => {
                soundEffect.remove();
            }, 1000);
            
            // === ATUALIZA√á√ïES DO CHAT ===
            
            // 13. Adicionar mensagem ao chat sobre a evid√™ncia coletada
            setTimeout(() => {
                const evidenceGained = evidenceCalculation.total - (totalEvidence - cardEffect.evidence);
                const chatMessages = [
                    `üîç Coletou ${evidenceGained} evid√™ncias com ${cardEffect.description.toLowerCase()}`,
                    `üìä Progresso: ${evidenceCalculation.total}/${currentCase.targetEvidence} evid√™ncias`,
                    `üéØ Combo ${comboStreak}x ativo! Continue assim!`,
                    `üí° Boa estrat√©gia! Essa evid√™ncia √© crucial!`,
                    `üÉè Carta ${cardType} jogada com sucesso!`,
                    `‚ö° Combo ${comboStreak}x multiplicando evid√™ncias!`,
                    `üí∞ +${totalCoins} moedas ganhas!`,
                    `üéØ Pista adicionada: ${cardEffect.clue}`
                ];
                
                const randomMessage = chatMessages[Math.floor(Math.random() * chatMessages.length)];
                const randomMember = teamMembers[Math.floor(Math.random() * teamMembers.length)];
                addChatMessage(randomMessage, randomMember.name.split(' ')[1]);
            }, 1000);
            
            // 14. Adicionar mensagem espec√≠fica sobre o tipo de carta
            setTimeout(() => {
                const cardTypeMessages = {
                    'equipment': 'üîß Equipamento utilizado com efici√™ncia!',
                    'evidence': 'üîç Evid√™ncia crucial coletada!',
                    'action': '‚ö° A√ß√£o executada com precis√£o!',
                    'ally': 'ü§ù Aliado forneceu informa√ß√µes valiosas!',
                    'suspect': 'üë§ Suspeito interrogado com sucesso!'
                };
                
                const typeMessage = cardTypeMessages[cardType] || 'üÉè Carta jogada com sucesso!';
                addChatMessage(typeMessage, 'Sistema');
            }, 2000);
            
            // === VERIFICA√á√ïES FINAIS ===
            
            // 15. Verificar se atingiu objetivo de evid√™ncias
            if (currentCase.collectedEvidence >= currentCase.targetEvidence) {
                setTimeout(() => {
                    showGameEndModal('victory');
                }, 1500);
            }
            
            // 16. Log final para debug
            console.log(`üéÆ Jogo atualizado: ${cardsPlayed} cartas jogadas, ${comboStreak}x combo, ${currentCase.collectedEvidence}/${currentCase.targetEvidence} evid√™ncias, ${playerCoins} moedas`);
            
        }

        // Fun√ß√£o para atualizar o progresso visual das cartas
        function updateCardProgress() {
            const availableCards = cardDatabase.filter(card => !card.played).length;
            const maxCards = Math.max(difficultySettings[currentDifficulty].cards, availableCards);
            const playedCards = cardDatabase.filter(card => card.played).length;
            const progressPercentage = (playedCards / maxCards) * 100;

            // Atualizar t√≠tulo da se√ß√£o com progresso
            const sectionTitle = document.querySelector('.section-title');
            if (sectionTitle) {
                sectionTitle.innerHTML = `üÉè Cartas de Investiga√ß√£o Ativas <span style="font-size: 0.8rem; color: #10b981;">(${availableCards} dispon√≠veis)</span>`;
            }

            // Adicionar barra de progresso se n√£o existir
            let progressBar = document.getElementById('cards-progress-bar');
            if (!progressBar) {
                progressBar = document.createElement('div');
                progressBar.id = 'cards-progress-bar';
                progressBar.style.cssText = `
                    width: 100%;
                    height: 4px;
                    background: rgba(107, 114, 128, 0.3);
                    border-radius: 2px;
                    margin: 1rem 0;
                    overflow: hidden;
                `;
                
                const progressFill = document.createElement('div');
                progressFill.id = 'cards-progress-fill';
                progressFill.style.cssText = `
                    height: 100%;
                    background: linear-gradient(90deg, #10b981, #059669);
                    border-radius: 2px;
                    transition: width 0.5s ease;
                    width: 0%;
                `;
                
                progressBar.appendChild(progressFill);
                const cardsContainer = document.getElementById('cardsContainer');
                if (cardsContainer && cardsContainer.parentNode) {
                    cardsContainer.parentNode.insertBefore(progressBar, cardsContainer);
                }
            }

            // Atualizar barra de progresso
            const progressFill = document.getElementById('cards-progress-fill');
            if (progressFill) {
                progressFill.style.width = `${progressPercentage}%`;
            }
        }

        // Fun√ß√£o para mostrar feedback visual ao jogar carta
        function showCardPlayedFeedback(cardElement, evidenceGained, description) {
            const feedback = document.createElement('div');
            feedback.style.cssText = `
                position: absolute;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                background: linear-gradient(135deg, #10b981, #059669);
                color: white;
                padding: 0.8rem 1.2rem;
                border-radius: 25px;
                font-weight: bold;
                font-size: 1rem;
                z-index: 1000;
                animation: cardPlayedAnim 1.5s ease-out forwards;
                text-align: center;
                box-shadow: 0 8px 25px rgba(16, 185, 129, 0.4);
            `;
            feedback.innerHTML = `
                <div style="font-size: 1.2rem; margin-bottom: 0.3rem;">üîç</div>
                <div style="font-size: 0.9rem;">+${evidenceGained} Evid√™ncias</div>
                <div style="font-size: 0.7rem; opacity: 0.9; margin-top: 0.2rem;">${description}</div>
            `;
            
            cardElement.style.position = 'relative';
            cardElement.appendChild(feedback);
            
            setTimeout(() => {
                feedback.remove();
            }, 1500);
        }

        // Fun√ß√£o para recarregar cartas dispon√≠veis
        function reloadAvailableCards() {
            console.log('üîÑ Recarregando cartas dispon√≠veis...');
            generateCards();
        }

        // Fun√ß√£o para atualizar todas as estat√≠sticas do jogo de forma s√≠ncrona
        function updateAllGameStats() {
            console.log('üéÆ Atualizando todas as estat√≠sticas do jogo...');
            
            // 1. Atualizar estat√≠sticas principais
            updateStats();
            
            // 2. Atualizar display de moedas
            updateCoinDisplay();
            
            // 3. Atualizar progresso das cartas
            updateCardProgress();
            
            // 4. Atualizar t√≠tulo do caso
            const caseTitle = document.querySelector('.case-title');
            if (caseTitle) {
                caseTitle.innerHTML = `üîç ${currentCase.title} <span style="font-size: 0.8rem; color: #10b981;">(${currentCase.collectedEvidence}/${currentCase.targetEvidence})</span>`;
            }
            
            // 5. Verificar conquistas
            checkAchievements();
            
            // 6. Garantir que o contador de cartas jogadas seja atualizado
            updateCardsPlayedCounter();
            
            // 7. For√ßar atualiza√ß√£o agressiva dos contadores
            forceUpdateCounters();
            
            console.log('‚úÖ Todas as estat√≠sticas do jogo atualizadas');
        }
        
        // Fun√ß√£o para inicializar o contador baseado no n√≠vel atual
        function initializeCardsCounter() {
            const maxCards = difficultySettings[currentDifficulty].cards;
            const cardsElement = document.getElementById('cardsPlayed');
            if (cardsElement) {
                cardsElement.textContent = `0/${maxCards}`;
                console.log(`üéØ Contador inicializado: 0/${maxCards} para n√≠vel ${currentDifficulty}`);
            }
            
            // Inicializar barra de progresso
            updateCardsProgressBar(maxCards);
        }
        
        // Fun√ß√£o para atualizar contador quando o n√≠vel muda
        function updateCardsCounterForLevel() {
            const maxCards = difficultySettings[currentDifficulty].cards;
            const cardsElement = document.getElementById('cardsPlayed');
            if (cardsElement) {
                cardsElement.textContent = `${cardsPlayed}/${maxCards}`;
                console.log(`üéØ Contador atualizado para n√≠vel ${currentDifficulty}: ${cardsPlayed}/${maxCards}`);
            }
            
            // Atualizar barra de progresso
            updateCardsProgressBar(maxCards);
        }
        
        // Fun√ß√£o para atualizar a barra de progresso das cartas
        function updateCardsProgressBar(maxCards) {
            const progressPercentage = (cardsPlayed / maxCards) * 100;
            const progressElement = document.getElementById('cardsProgress');
            
            if (progressElement) {
                progressElement.style.width = `${progressPercentage}%`;
                console.log(`üìä Barra de progresso atualizada: ${cardsPlayed}/${maxCards} = ${progressPercentage.toFixed(1)}%`);
                
                // Adicionar efeito visual de anima√ß√£o
                progressElement.style.transition = 'width 0.5s ease-out';
                progressElement.style.backgroundColor = progressPercentage >= 100 ? '#10b981' : '#fbbf24';
            }
        }
        
        // Fun√ß√£o para detectar dinamicamente o total de cartas dispon√≠veis
        function updateDynamicCardsCounter() {
            const availableCards = cardDatabase.filter(card => !card.played).length;
            const maxCards = Math.max(difficultySettings[currentDifficulty].cards, availableCards);
            const cardsElement = document.getElementById('cardsPlayed');
            if (cardsElement) {
                cardsElement.textContent = `${cardsPlayed}/${maxCards}`;
                console.log(`üéØ Contador din√¢mico: ${cardsPlayed}/${maxCards} (dispon√≠veis: ${availableCards})`);
            }
            
            // Atualizar barra de progresso dinamicamente
            updateCardsProgressBar(maxCards);
        }
        
        // Fun√ß√£o para for√ßar atualiza√ß√£o agressiva dos contadores
        function forceUpdateCounters() {
            console.log('üí™ For√ßando atualiza√ß√£o agressiva dos contadores...');
            
            // Usar contador din√¢mico
            updateDynamicCardsCounter();
            
            // For√ßar atualiza√ß√£o do contador de cartas jogadas
            const cardsElement = document.getElementById('cardsPlayed');
            if (cardsElement) {
                cardsElement.style.color = '#fbbf24';
                cardsElement.style.fontWeight = 'bold';
                console.log(`üí™ Contador for√ßado com valor din√¢mico`);
            }
            
            // For√ßar atualiza√ß√£o do multiplicador
            const multiplierElement = document.getElementById('currentMultiplier');
            if (multiplierElement) {
                const multiplier = 1.0 + (comboStreak * 0.1);
                multiplierElement.textContent = `${multiplier.toFixed(1)}x`;
                console.log(`üí™ Multiplicador for√ßado: ${multiplier.toFixed(1)}x`);
            }
            
            // For√ßar atualiza√ß√£o do combo streak
            const comboElement = document.getElementById('comboStreak');
            if (comboElement) {
                comboElement.textContent = `${comboStreak}x`;
                console.log(`üí™ Combo for√ßado: ${comboStreak}x`);
            }
            
            // Buscar e atualizar qualquer elemento com /20
            const allElements = document.querySelectorAll('*');
            const maxCards = difficultySettings[currentDifficulty].cards;
            allElements.forEach(element => {
                if (element.textContent && element.textContent.includes('/20') && !element.textContent.includes('Evid√™ncias')) {
                    element.textContent = `${cardsPlayed}/${maxCards}`;
                    console.log(`üí™ Elemento encontrado e atualizado: ${element.tagName} ${element.id || element.className}`);
                }
            });
        }

        // Fun√ß√£o espec√≠fica para atualizar o contador de cartas jogadas e multiplicador
        function updateCardsPlayedCounter() {
            // Usar contador din√¢mico em vez de fixo
            updateDynamicCardsCounter();
            return;
            
            const maxCards = difficultySettings[currentDifficulty].cards;
            console.log(`üÉè Atualizando contador de cartas jogadas: ${cardsPlayed}/${maxCards}`);
            
            // === ATUALIZAR CONTADOR DE CARTAS JOGADAS ===
            
            // Busca direta e simples
            let cardsPlayedElement = document.getElementById('cardsPlayed');
            
            if (!cardsPlayedElement) {
                console.log('üîç Elemento n√£o encontrado por ID, buscando por texto...');
                
                // Buscar por texto espec√≠fico
                const allSpans = document.querySelectorAll('span');
                cardsPlayedElement = Array.from(allSpans).find(span => 
                    span.textContent.includes('/20') && !span.textContent.includes('Evid√™ncias')
                );
            }
            
            if (!cardsPlayedElement) {
                console.log('üîç Buscando por contexto...');
                
                // Buscar pr√≥ximo ao texto "Cartas Jogadas"
                const cartasJogadasText = Array.from(document.querySelectorAll('span')).find(span => 
                    span.textContent.includes('Cartas Jogadas')
                );
                if (cartasJogadasText && cartasJogadasText.parentNode) {
                    const siblings = Array.from(cartasJogadasText.parentNode.children);
                    cardsPlayedElement = siblings.find(sibling => 
                        sibling.textContent.includes('/20') && sibling !== cartasJogadasText
                    );
                }
            }
            
            if (cardsPlayedElement) {
                console.log(`‚úÖ Elemento cardsPlayed encontrado: "${cardsPlayedElement.textContent}"`);
                cardsPlayedElement.textContent = `${cardsPlayed}/${maxCards}`;
                console.log(`‚úÖ Contador de cartas jogadas atualizado: ${cardsPlayed}/${maxCards}`);
                
                // Adicionar efeito visual de atualiza√ß√£o
                cardsPlayedElement.style.transform = 'scale(1.1)';
                cardsPlayedElement.style.color = '#fbbf24';
                setTimeout(() => {
                    cardsPlayedElement.style.transform = 'scale(1)';
                    cardsPlayedElement.style.color = '';
                }, 200);
                
                // For√ßar reflow do DOM
                cardsPlayedElement.offsetHeight;
                
            } else {
                console.error('‚ùå Elemento cardsPlayed n√£o encontrado!');
                
                // Debug completo: listar todos os elementos
                console.log('üîç DEBUG COMPLETO - Todos os elementos span:');
                const allSpans = document.querySelectorAll('span');
                allSpans.forEach((span, index) => {
                    console.log(`üîç Span ${index}: id="${span.id}" text="${span.textContent}"`);
                });
                
                // Tentar criar o elemento se n√£o existir
                console.log('üîß Tentando criar elemento cardsPlayed dinamicamente...');
                const sidebar = document.querySelector('.sidebar') || document.querySelector('[class*="sidebar"]');
                if (sidebar) {
                    const newElement = document.createElement('span');
                    newElement.id = 'cardsPlayed';
                    newElement.textContent = `${cardsPlayed}/20`;
                    newElement.style.color = '#fbbf24';
                    newElement.style.fontWeight = 'bold';
                    sidebar.appendChild(newElement);
                    console.log('‚úÖ Elemento cardsPlayed criado dinamicamente');
                }
            }
            
            // === ATUALIZAR MULTIPLICADOR ===
            
            // Calcular multiplicador baseado no combo streak
            const multiplier = 1.0 + (comboStreak * 0.1);
            console.log(`üìä Calculando multiplicador: 1.0 + (${comboStreak} * 0.1) = ${multiplier.toFixed(1)}x`);
            
            // Buscar o elemento espec√≠fico pelo ID exato
            let multiplierElement = document.getElementById('currentMultiplier');
            
            if (multiplierElement) {
                console.log(`‚úÖ Elemento currentMultiplier encontrado: "${multiplierElement.textContent}"`);
                multiplierElement.textContent = `${multiplier.toFixed(1)}x`;
                console.log(`‚úÖ Multiplicador atualizado: ${multiplier.toFixed(1)}x`);
                
                // Adicionar efeito visual de atualiza√ß√£o
                multiplierElement.style.transform = 'scale(1.1)';
                multiplierElement.style.color = '#fbbf24';
                setTimeout(() => {
                    multiplierElement.style.transform = 'scale(1)';
                    multiplierElement.style.color = '#fbbf24'; // Manter cor original
                }, 200);
            } else {
                console.error('‚ùå Elemento currentMultiplier n√£o encontrado!');
                
                // Debug: listar todos os elementos span para encontrar o multiplicador
                const allSpans = document.querySelectorAll('span');
                console.log('üîç Procurando elemento multiplicador...');
                allSpans.forEach((span, index) => {
                    if (span.textContent.includes('x') && span.textContent.includes('1.')) {
                        console.log(`üîç Poss√≠vel multiplicador ${index}: id="${span.id}" text="${span.textContent}"`);
                    }
                });
                
                // Tentar encontrar por texto
                const multiplierTextElements = Array.from(document.querySelectorAll('span')).filter(span => 
                    span.textContent.includes('1.0x') || span.textContent.includes('1x')
                );
                
                if (multiplierTextElements.length > 0) {
                    multiplierElement = multiplierTextElements[0];
                    console.log(`üîß Multiplicador encontrado por texto: "${multiplierElement.textContent}"`);
                    multiplierElement.textContent = `${multiplier.toFixed(1)}x`;
                    console.log(`‚úÖ Multiplicador atualizado via busca por texto: ${multiplier.toFixed(1)}x`);
                }
            }
            
            // === ATUALIZAR BARRA DE PROGRESSO DAS CARTAS ===
            
            const cardsProgress = (cardsPlayed / maxCards) * 100;
            const cardsProgressElement = document.getElementById('cardsProgress');
            
            if (cardsProgressElement) {
                cardsProgressElement.style.width = `${cardsProgress}%`;
                console.log(`üìä Barra de progresso de cartas atualizada: ${cardsProgress}%`);
            } else {
                console.error('üìä Elemento cardsProgress n√£o encontrado');
            }
            
            // === ATUALIZAR BARRA DE PROGRESSO DO COMBO ===
            
            const comboProgress = Math.min((comboStreak / 10) * 100, 100);
            const comboProgressElement = document.getElementById('comboProgress');
            
            if (comboProgressElement) {
                comboProgressElement.style.width = `${comboProgress}%`;
                console.log(`üìä Barra de progresso de combo atualizada: ${comboProgress}%`);
            } else {
                console.error('üìä Elemento comboProgress n√£o encontrado');
            }
            
            // === VERIFICA√á√ÉO FINAL ===
            
            // Verificar se as atualiza√ß√µes foram aplicadas
            setTimeout(() => {
                const finalCardsElement = document.getElementById('cardsPlayed');
                const finalMultiplierElement = document.getElementById('currentMultiplier');
                
                if (finalCardsElement) {
                    console.log(`‚úÖ Verifica√ß√£o final - Cartas jogadas: "${finalCardsElement.textContent}"`);
                }
                
                if (finalMultiplierElement) {
                    console.log(`‚úÖ Verifica√ß√£o final - Multiplicador: "${finalMultiplierElement.textContent}"`);
                }
            }, 100);
        }

        // Fun√ß√£o para mostrar notifica√ß√£o de vit√≥ria
        function showVictoryNotification() {
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                background: linear-gradient(135deg, #10b981, #059669);
                color: white;
                padding: 2rem;
                border-radius: 15px;
                text-align: center;
                z-index: 10000;
                box-shadow: 0 10px 30px rgba(16, 185, 129, 0.5);
                animation: victoryPulse 2s ease-in-out;
            `;
            
            notification.innerHTML = `
                <div style="font-size: 3rem; margin-bottom: 1rem;">üéâ</div>
                <h2 style="margin: 0 0 1rem 0; font-size: 1.5rem;">VIT√ìRIA!</h2>
                <p style="margin: 0 0 1rem 0; font-size: 1.1rem;">Voc√™ coletou todas as evid√™ncias necess√°rias!</p>
                <p style="margin: 0; font-size: 0.9rem; opacity: 0.9;">Total: ${currentCase.collectedEvidence}/${currentCase.targetEvidence} evid√™ncias</p>
                <button onclick="this.parentElement.remove()" style="
                    margin-top: 1rem;
                    padding: 0.5rem 1rem;
                    background: rgba(255, 255, 255, 0.2);
                    border: none;
                    border-radius: 8px;
                    color: white;
                    cursor: pointer;
                    font-weight: bold;
                ">Continuar</button>
            `;
            
            document.body.appendChild(notification);
            
            // Adicionar anima√ß√£o CSS
            const style = document.createElement('style');
            style.textContent = `
                @keyframes victoryPulse {
                    0% { transform: translate(-50%, -50%) scale(0.8); opacity: 0; }
                    50% { transform: translate(-50%, -50%) scale(1.1); opacity: 1; }
                    100% { transform: translate(-50%, -50%) scale(1); opacity: 1; }
                }
            `;
            document.head.appendChild(style);
            
            // Remover automaticamente ap√≥s 5 segundos
            setTimeout(() => {
                if (notification.parentElement) {
                    notification.remove();
                }
            }, 5000);
        }

        // Fun√ß√£o para mostrar notifica√ß√£o de evid√™ncias e moedas
        function showEvidenceNotification(evidence, description, coins, combo) {
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: linear-gradient(135deg, #1e40af, #3b82f6);
                color: white;
                padding: 1.2rem;
                border-radius: 12px;
                font-weight: bold;
                z-index: 2000;
                animation: slideInRight 0.5s ease-out;
                box-shadow: 0 8px 25px rgba(30, 64, 175, 0.4);
                max-width: 300px;
            `;
            notification.innerHTML = `
                <div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.5rem;">
                    <span style="font-size: 1.2rem;">üîç</span>
                    <span style="font-size: 1.1rem;">+${evidence} Evid√™ncias</span>
                </div>
                <div style="font-size: 0.8rem; opacity: 0.9; margin-bottom: 0.5rem; line-height: 1.3;">
                    ${description}
                </div>
                <div style="display: flex; justify-content: space-between; align-items: center; font-size: 0.8rem;">
                    <span>üí∞ +${coins} Moedas</span>
                    <span>üî• Combo ${combo}x</span>
                </div>
            `;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.animation = 'slideOutRight 0.5s ease-in';
                setTimeout(() => notification.remove(), 500);
            }, 4000);
        }

        // ===== SISTEMA DE COMBO STREAK =====
        
        // Fun√ß√£o para gerenciar o Combo Streak
        function manageComboStreak(action = 'increment') {
            console.log(`üî• Gerenciando Combo Streak: ${action}`);
            
            switch (action) {
                case 'increment':
                    comboStreak++;
                    console.log(`üî• Combo incrementado: ${comboStreak}x`);
                    
                    // Verificar conquistas de combo
                    if (comboStreak === 3) {
                        showNotification('üî• Combo 3x! B√¥nus de evid√™ncias ativo!');
                    } else if (comboStreak === 5) {
                        showNotification('‚ö° Combo 5x! Multiplicador m√°ximo!');
                    } else if (comboStreak === 10) {
                        showNotification('üéØ Combo 10x! LEND√ÅRIO!');
                        // Desbloquear conquista
                        unlockAchievement('comboMaster');
                    }
                    break;
                    
                case 'reset':
                    const previousCombo = comboStreak;
                    comboStreak = 0;
                    console.log(`üî• Combo resetado: ${previousCombo}x ‚Üí 0x`);
                    
                    if (previousCombo >= 3) {
                        showNotification('üíî Combo perdido! Volte a jogar cartas consecutivamente.');
                    }
                    break;
                    
                case 'maintain':
                    console.log(`üî• Combo mantido: ${comboStreak}x`);
                    break;
            }
            
            // Atualizar display do combo
            updateComboDisplay();
            
            // Atualizar multiplicador
            updateMultiplier();
            
            // Atualizar barra de progresso do combo
            updateComboProgressBar();
            
            return comboStreak;
        }
        
        // Fun√ß√£o para atualizar o display do combo
        function updateComboDisplay() {
            const comboElement = document.getElementById('comboStreak');
            if (comboElement) {
                comboElement.textContent = `${comboStreak}x`;
                
                // Aplicar cores baseadas no n√≠vel do combo
                if (comboStreak >= 10) {
                    comboElement.style.color = '#fbbf24'; // Dourado
                    comboElement.style.textShadow = '0 0 10px #fbbf24';
                } else if (comboStreak >= 7) {
                    comboElement.style.color = '#ef4444'; // Vermelho
                    comboElement.style.textShadow = '0 0 8px #ef4444';
                } else if (comboStreak >= 5) {
                    comboElement.style.color = '#8b5cf6'; // Roxo
                    comboElement.style.textShadow = '0 0 6px #8b5cf6';
                } else if (comboStreak >= 3) {
                    comboElement.style.color = '#f59e0b'; // Laranja
                    comboElement.style.textShadow = '0 0 4px #f59e0b';
                } else {
                    comboElement.style.color = '#6b7280'; // Cinza
                    comboElement.style.textShadow = 'none';
                }
                
                console.log(`üî• Display do combo atualizado: ${comboStreak}x`);
            } else {
                console.error('üî• Elemento comboStreak n√£o encontrado');
            }
        }
        
        // Fun√ß√£o para atualizar o multiplicador baseado no combo
        function updateMultiplier() {
            const multiplier = 1.0 + (comboStreak * 0.1); // 10% por combo
            const multiplierElement = document.getElementById('currentMultiplier');
            
            if (multiplierElement) {
                multiplierElement.textContent = `${multiplier.toFixed(1)}x`;
                
                // Aplicar cores baseadas no multiplicador
                if (multiplier >= 2.0) {
                    multiplierElement.style.color = '#fbbf24'; // Dourado
                } else if (multiplier >= 1.5) {
                    multiplierElement.style.color = '#ef4444'; // Vermelho
                } else if (multiplier >= 1.3) {
                    multiplierElement.style.color = '#8b5cf6'; // Roxo
                } else {
                    multiplierElement.style.color = '#6b7280'; // Cinza
                }
                
                console.log(`üìà Multiplicador atualizado: ${multiplier.toFixed(1)}x`);
            } else {
                console.error('üìà Elemento currentMultiplier n√£o encontrado');
            }
            
            return multiplier;
        }
        
        // Fun√ß√£o para atualizar a barra de progresso do combo
        function updateComboProgressBar() {
            const maxCombo = 10; // Combo m√°ximo
            const progressPercentage = Math.min((comboStreak / maxCombo) * 100, 100);
            const progressElement = document.getElementById('comboProgress');
            
            if (progressElement) {
                progressElement.style.width = `${progressPercentage}%`;
                
                // Aplicar cores baseadas no progresso
                if (progressPercentage >= 100) {
                    progressElement.style.backgroundColor = '#fbbf24'; // Dourado
                } else if (progressPercentage >= 70) {
                    progressElement.style.backgroundColor = '#ef4444'; // Vermelho
                } else if (progressPercentage >= 50) {
                    progressElement.style.backgroundColor = '#8b5cf6'; // Roxo
                } else if (progressPercentage >= 30) {
                    progressElement.style.backgroundColor = '#f59e0b'; // Laranja
                } else {
                    progressElement.style.backgroundColor = '#10b981'; // Verde
                }
                
                console.log(`üìä Barra de progresso do combo atualizada: ${progressPercentage.toFixed(1)}%`);
            } else {
                console.error('üìä Elemento comboProgress n√£o encontrado');
            }
        }
        
        // Fun√ß√£o para calcular b√¥nus de evid√™ncias baseado no combo
        function calculateComboBonus(baseEvidence) {
            const comboMultiplier = 1 + (comboStreak * 0.1); // 10% por combo
            const totalEvidence = Math.floor(baseEvidence * comboMultiplier);
            const bonusEvidence = totalEvidence - baseEvidence;
            
            console.log(`üî• B√¥nus de combo: ${baseEvidence} + ${bonusEvidence} = ${totalEvidence} evid√™ncias`);
            
            return {
                base: baseEvidence,
                bonus: bonusEvidence,
                total: totalEvidence,
                multiplier: comboMultiplier
            };
        }

        // Fun√ß√£o para calcular total de evid√™ncias baseado na dificuldade
        function calculateTotalEvidence() {
            const difficultyConfig = difficultySettings[currentDifficulty];
            const baseEvidencePerCard = 10; // Evid√™ncias base por carta
            const maxCards = difficultyConfig.cards;
            
            // Calcular evid√™ncias base
            let totalBaseEvidence = cardsPlayed * baseEvidencePerCard;
            
            // Aplicar b√¥nus de combo
            const comboBonus = calculateComboBonus(totalBaseEvidence);
            
            // Aplicar multiplicador de dificuldade
            const difficultyMultiplier = difficultyConfig.evidenceMultiplier || 1.0;
            const finalEvidence = Math.floor(comboBonus.total * difficultyMultiplier);
            
            console.log(`üìä Total de evid√™ncias calculado: ${totalBaseEvidence} base + ${comboBonus.bonus} combo = ${finalEvidence} final`);
            
            return {
                base: totalBaseEvidence,
                combo: comboBonus.bonus,
                total: finalEvidence,
                multiplier: difficultyMultiplier,
                maxCards: maxCards
            };
        }

        // Fun√ß√£o para atualizar display de evid√™ncias
        function updateEvidenceDisplay() {
            const evidenceCalculation = calculateTotalEvidence();
            
            // Atualizar vari√°vel global
            totalEvidence = evidenceCalculation.total;
            currentCase.collectedEvidence = evidenceCalculation.total;
            
            // Atualizar display
            const evidenceDisplayElement = document.getElementById('evidenceDisplay');
            if (evidenceDisplayElement) {
                evidenceDisplayElement.textContent = `${evidenceCalculation.total}/${currentCase.targetEvidence}`;
                console.log(`üìä Display de evid√™ncias atualizado: ${evidenceCalculation.total}/${currentCase.targetEvidence}`);
            }
            
            // Atualizar barra de progresso
            const evidenceProgress = Math.min((evidenceCalculation.total / currentCase.targetEvidence) * 100, 100);
            const evidenceProgressElement = document.getElementById('evidenceProgress');
            if (evidenceProgressElement) {
                evidenceProgressElement.style.width = `${evidenceProgress}%`;
                
                // Mudar cor baseado no progresso
                if (evidenceProgress >= 100) {
                    evidenceProgressElement.style.background = 'linear-gradient(90deg, #10b981, #059669)';
                } else if (evidenceProgress >= 75) {
                    evidenceProgressElement.style.background = 'linear-gradient(90deg, #f59e0b, #d97706)';
                } else if (evidenceProgress >= 50) {
                    evidenceProgressElement.style.background = 'linear-gradient(90deg, #3b82f6, #2563eb)';
                } else {
                    evidenceProgressElement.style.background = 'linear-gradient(90deg, #6b7280, #4b5563)';
                }
                
                console.log(`üìä Barra de progresso de evid√™ncias atualizada: ${evidenceProgress}%`);
            }
            
            // Verificar se atingiu o objetivo
            if (evidenceCalculation.total >= currentCase.targetEvidence) {
                showVictoryNotification();
            }
            
            return evidenceCalculation;
        }
        
        // Fun√ß√£o para calcular b√¥nus de moedas baseado no combo
        function calculateComboCoins() {
            const baseCoins = 5; // Moedas base por carta
            const comboBonus = Math.floor(comboStreak * 2); // +2 moedas por combo
            const totalCoins = baseCoins + comboBonus;
            
            console.log(`üí∞ B√¥nus de moedas por combo: ${baseCoins} + ${comboBonus} = ${totalCoins} moedas`);
            
            return {
                base: baseCoins,
                bonus: comboBonus,
                total: totalCoins
            };
        }
        
        // Fun√ß√£o para verificar se o combo deve ser resetado
        function shouldResetCombo() {
            // Resetar combo se:
            // 1. Passou muito tempo desde a √∫ltima carta jogada (5 segundos)
            // 2. Houve um erro ao jogar carta
            // 3. O jogador clicou em "Ver Todas as Cartas"
            
            const lastCardTime = window.lastCardPlayTime || 0;
            const currentTime = Date.now();
            const timeSinceLastCard = currentTime - lastCardTime;
            
            if (timeSinceLastCard > 5000) { // 5 segundos
                console.log('üî• Combo resetado por timeout (5s)');
                return true;
            }
            
            return false;
        }
        
        // Fun√ß√£o para atualizar estat√≠sticas
        function updateStats() {
            console.log('üìä Atualizando estat√≠sticas...');
            
            // Atualizar cartas jogadas
            const cardsPlayedElement = document.getElementById('cardsPlayed');
            if (cardsPlayedElement) {
                const maxCards = difficultySettings[currentDifficulty].cards;
                cardsPlayedElement.textContent = `${cardsPlayed}/${maxCards}`;
                console.log(`üìä Cartas jogadas atualizadas: ${cardsPlayed}/${maxCards}`);
            } else {
                console.error('üìä Elemento cardsPlayed n√£o encontrado');
            }
            
            const comboStreakElement = document.getElementById('comboStreak');
            if (comboStreakElement) {
                comboStreakElement.textContent = `${comboStreak}x`;
                console.log(`üìä Combo atualizado: ${comboStreak}x`);
            } else {
                console.error('üìä Elemento comboStreak n√£o encontrado');
            }
            
            // Atualizar evid√™ncias usando o novo sistema
            updateEvidenceDisplay();
            
            // Calcular multiplicador baseado na dificuldade
            const difficultyMultiplier = 1.0 + (comboStreak * 0.1);
            const currentMultiplierElement = document.getElementById('currentMultiplier');
            if (currentMultiplierElement) {
                currentMultiplierElement.textContent = `${difficultyMultiplier.toFixed(1)}x`;
                console.log(`üìä Multiplicador atualizado: ${difficultyMultiplier.toFixed(1)}x`);
            } else {
                console.error('üìä Elemento currentMultiplier n√£o encontrado');
            }
            
            // Atualizar barras de progresso
            const maxCards = difficultySettings[currentDifficulty].cards;
            const cardsProgress = (cardsPlayed / maxCards) * 100;
            const comboProgress = Math.min((comboStreak / 10) * 100, 100);
            const cardsProgressElement = document.getElementById('cardsProgress');
            if (cardsProgressElement) {
                cardsProgressElement.style.width = `${cardsProgress}%`;
                console.log(`üìä Barra de progresso de cartas atualizada: ${cardsProgress}%`);
            } else {
                console.error('üìä Elemento cardsProgress n√£o encontrado');
            }
            
            const comboProgressElement = document.getElementById('comboProgress');
            if (comboProgressElement) {
                comboProgressElement.style.width = `${comboProgress}%`;
                console.log(`üìä Barra de progresso de combo atualizada: ${comboProgress}%`);
            } else {
                console.error('üìä Elemento comboProgress n√£o encontrado');
            }
            
            // Atualizar t√≠tulo do caso com progresso
            const caseTitle = document.querySelector('.case-title');
            if (caseTitle) {
                caseTitle.innerHTML = `üîç ${currentCase.title} <span style="font-size: 0.8rem; color: #10b981;">(${currentCase.collectedEvidence}/${currentCase.targetEvidence})</span>`;
            }
        }

        // Adicionar event listeners para as cartas
        function initializeCards() {
            console.log('üÉè Inicializando sistema de cartas...');
            const cards = document.querySelectorAll('.card');
            console.log(`üÉè Encontradas ${cards.length} cartas para inicializar`);
            
            cards.forEach((card, index) => {
                console.log(`üÉè Inicializando carta ${index + 1}: ${card.getAttribute('data-type')}`);
                
                // Remover event listeners anteriores para evitar duplica√ß√£o
                card.removeEventListener('click', () => playCard(card));
                card.removeEventListener('mouseenter', (e) => showCardTooltip(e, card));
                card.removeEventListener('mouseleave', hideCardTooltip);
                
                // Adicionar novos event listeners
                card.addEventListener('click', () => {
                    console.log(`üÉè Carta clicada: ${card.getAttribute('data-type')}`);
                    playCard(card);
                });
                
                // Adicionar tooltip ao passar o mouse
                card.addEventListener('mouseenter', (e) => showCardTooltip(e, card));
                card.addEventListener('mouseleave', hideCardTooltip);
                
                // Adicionar classe para indicar que est√° inicializada
                card.classList.add('initialized');
            });
            
            console.log('üÉè Sistema de cartas inicializado com sucesso!');
        }

        // Fun√ß√£o para mostrar tooltip da carta
        function showCardTooltip(event, cardElement) {
            if (cardElement.classList.contains('played')) {
                return; // N√£o mostrar tooltip para cartas j√° jogadas
            }

            const cardType = cardElement.getAttribute('data-type');
            const cardEffect = cardEffects[cardType];
            
            if (!cardEffect) return;

            const tooltip = document.createElement('div');
            tooltip.id = 'card-tooltip';
            tooltip.style.cssText = `
                position: fixed;
                background: linear-gradient(135deg, #1a1a2e, #16213e);
                border: 2px solid rgba(251, 191, 36, 0.6);
                border-radius: 12px;
                padding: 1rem;
                color: white;
                font-size: 0.9rem;
                z-index: 3000;
                max-width: 250px;
                box-shadow: 0 10px 30px rgba(0, 0, 0, 0.8);
                backdrop-filter: blur(10px);
                animation: cardAppear 0.3s ease-out;
            `;

            tooltip.innerHTML = `
                <div style="color: #fbbf24; font-weight: bold; margin-bottom: 0.5rem;">
                    ${cardElement.querySelector('.card-title').textContent}
                </div>
                <div style="color: #cbd5e1; margin-bottom: 0.5rem;">
                    ${cardElement.querySelector('.card-description').textContent}
                </div>
                <div style="color: #10b981; font-weight: bold;">
                    üîç +${cardEffect.evidence} Evid√™ncias Base
                </div>
                <div style="color: #f59e0b; font-size: 0.8rem; margin-top: 0.5rem;">
                    üí° Pista: ${cardEffect.clue}
                </div>
            `;

            document.body.appendChild(tooltip);

            // Posicionar tooltip
            const rect = cardElement.getBoundingClientRect();
            tooltip.style.left = rect.right + 10 + 'px';
            tooltip.style.top = rect.top + 'px';
        }

        // Fun√ß√£o para esconder tooltip
        function hideCardTooltip() {
            const tooltip = document.getElementById('card-tooltip');
            if (tooltip) {
                tooltip.remove();
            }
        }

        // SISTEMA DE TEMPO RESTANTE COMPLETO
        // gameTime j√° declarado anteriormente
        let timerInterval;
        let isTimerRunning = false;

        // Fun√ß√£o para atualizar o tempo em tempo real
        function updateTimeDisplay() {
            const timeRemainingElement = document.getElementById('timeRemaining');
            const timeProgressElement = document.getElementById('timeProgress');
            const headerTimerElement = document.getElementById('gameTimer');
            
            if (timeRemainingElement && timeProgressElement) {
                const minutes = Math.floor(gameTime / 60);
                const seconds = gameTime % 60;
                const timeString = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
                
                // Atualizar display na se√ß√£o de estat√≠sticas
                timeRemainingElement.textContent = timeString;
                
                // Atualizar timer no header
                if (headerTimerElement) {
                    headerTimerElement.textContent = `‚è±Ô∏è ${timeString}`;
                }
                
                // Atualizar barra de progresso do tempo
                const timeProgress = (gameTime / (45 * 60)) * 100; // 45 minutos = 2700 segundos
                timeProgressElement.style.width = `${timeProgress}%`;
                
                // Mudar cor baseado no tempo restante
                if (gameTime <= 300) { // 5 minutos restantes - VERMELHO
                    timeProgressElement.style.background = 'linear-gradient(90deg, #dc2626, #991b1b)';
                    timeRemainingElement.style.color = '#dc2626';
                    timeRemainingElement.style.animation = 'pulse 1s infinite';
                    showTimeWarning('CR√çTICO: Menos de 5 minutos!');
                } else if (gameTime <= 900) { // 15 minutos restantes - LARANJA
                    timeProgressElement.style.background = 'linear-gradient(90deg, #f59e0b, #d97706)';
                    timeRemainingElement.style.color = '#f59e0b';
                    timeRemainingElement.style.animation = 'none';
                    if (gameTime === 900) showTimeWarning('ATEN√á√ÉO: 15 minutos restantes!');
                } else if (gameTime <= 1800) { // 30 minutos restantes - AMARELO
                    timeProgressElement.style.background = 'linear-gradient(90deg, #eab308, #ca8a04)';
                    timeRemainingElement.style.color = '#eab308';
                    timeRemainingElement.style.animation = 'none';
                } else { // Tempo normal - VERDE
                    timeProgressElement.style.background = 'linear-gradient(90deg, #22c55e, #16a34a)';
                    timeRemainingElement.style.color = '#22c55e';
                    timeRemainingElement.style.animation = 'none';
                }
                
                // Adicionar mensagem ao chat sobre tempo cr√≠tico
                if (gameTime === 300) { // Exatamente 5 minutos
                    addChatMessage("üö® TEMPO CR√çTICO! Menos de 5 minutos restantes!", "Hotchner");
                } else if (gameTime === 900) { // Exatamente 15 minutos
                    addChatMessage("‚ö†Ô∏è ATEN√á√ÉO: 15 minutos restantes!", "Morgan");
                } else if (gameTime === 1800) { // Exatamente 30 minutos
                    addChatMessage("‚è∞ 30 minutos restantes. Mantenha o foco!", "Reid");
                }
            }
        }

        // Fun√ß√£o para mostrar aviso de tempo
        function showTimeWarning(message) {
            const warning = document.createElement('div');
            warning.style.cssText = `
                position: fixed;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                background: linear-gradient(135deg, #dc2626, #991b1b);
                color: white;
                padding: 1rem 2rem;
                border-radius: 15px;
                font-weight: bold;
                font-size: 1.2rem;
                z-index: 3000;
                animation: timeWarningAnim 2s ease-out forwards;
                box-shadow: 0 10px 30px rgba(220, 38, 38, 0.5);
                text-align: center;
            `;
            warning.textContent = message;
            
            document.body.appendChild(warning);
            
            setTimeout(() => {
                warning.remove();
            }, 3000);
        }



        // Fun√ß√£o para iniciar o intervalo do timer
        function startTimerInterval() {
            if (timerInterval) {
                clearInterval(timerInterval);
            }
            
            isTimerRunning = true;
            timerInterval = setInterval(() => {
                if (gameTime > 0) {
                    gameTime--;
                    updateTimeDisplay();
                    
                    // B√¥nus por tempo (a cada minuto)
                    if (gameTime % 60 === 0 && gameTime > 0) {
                        const timeBonus = Math.floor(gameTime / 60) * 2; // 2 moedas por minuto restante
                        playerCoins += timeBonus;
                        document.getElementById('coin-display').textContent = playerCoins;
                        
                        // Adicionar mensagem ao chat sobre b√¥nus de tempo
                        if (timeBonus > 0) {
                            addChatMessage(`üí∞ B√¥nus de tempo: +${timeBonus} moedas!`, "Garcia");
                        }
                    }
                } else {
                    // Tempo esgotado
                    clearInterval(timerInterval);
                    isTimerRunning = false;
                    
                    // Mostrar resultado final
                    showGameEndModal('timeout');
                    
                    // Adicionar mensagem ao chat
                    addChatMessage("‚è∞ TEMPO ESGOTADO! Investiga√ß√£o encerrada.", "Hotchner");
                }
            }, 1000);
        }

        // CSS Animations
        const style = document.createElement('style');
        style.textContent = `
            @keyframes cardPlayedAnim {
                0% { transform: translate(-50%, -50%) scale(0); opacity: 0; }
                50% { transform: translate(-50%, -50%) scale(1.2); opacity: 1; }
                100% { transform: translate(-50%, -50%) scale(1); opacity: 0; }
            }
            
            @keyframes slideInRight {
                from { transform: translateX(100%); opacity: 0; }
                to { transform: translateX(0); opacity: 1; }
            }
            
            @keyframes slideOutRight {
                from { transform: translateX(0); opacity: 1; }
                to { transform: translateX(100%); opacity: 0; }
            }
            
            @keyframes pulse {
                0%, 100% { opacity: 1; }
                50% { opacity: 0.7; }
            }
            
            @keyframes timeWarningAnim {
                0% { transform: translate(-50%, -50%) scale(0); opacity: 0; }
                20% { transform: translate(-50%, -50%) scale(1.1); opacity: 1; }
                80% { transform: translate(-50%, -50%) scale(1); opacity: 1; }
                100% { transform: translate(-50%, -50%) scale(0.9); opacity: 0; }
            }
            
            @keyframes timeCritical {
                0%, 100% { 
                    background: linear-gradient(90deg, #dc2626, #991b1b);
                    box-shadow: 0 0 20px rgba(220, 38, 38, 0.5);
                }
                50% { 
                    background: linear-gradient(90deg, #991b1b, #dc2626);
                    box-shadow: 0 0 30px rgba(220, 38, 38, 0.8);
                }
            }

            @keyframes cardGlow {
                0%, 100% {
                    box-shadow: 0 6px 20px rgba(0, 0, 0, 0.5), inset 0 1px 0 rgba(251, 191, 36, 0.1);
                }
                50% {
                    box-shadow: 0 6px 20px rgba(251, 191, 36, 0.3), inset 0 1px 0 rgba(251, 191, 36, 0.2);
                }
            }

            @keyframes cardPulse {
                0%, 100% {
                    transform: scale(1);
                }
                50% {
                    transform: scale(1.05);
                }
            }

            @keyframes cardShake {
                0%, 100% {
                    transform: translateX(0);
                }
                25% {
                    transform: translateX(-2px);
                }
                75% {
                    transform: translateX(2px);
                }
            }

            @keyframes cardFadeOut {
                0% {
                    opacity: 1;
                    transform: scale(1);
                }
                100% {
                    opacity: 0;
                    transform: scale(0.8);
                }
            }
        `;
        document.head.appendChild(style);

        // Recuperar dados do usu√°rio
        window.onload = function() {
            const detectiveName = localStorage.getItem('detectiveName');
            if (detectiveName) {
                const teamList = document.getElementById('teamList');
                const userDiv = document.createElement('div');
                userDiv.className = 'chat-message';
                userDiv.innerHTML = `<span class="chat-user">üïµÔ∏è ${detectiveName}:</span> Online - 47 cartas`;
                teamList.appendChild(userDiv);
            }
            
            // Timer simples j√° est√° configurado para iniciar automaticamente
            console.log('‚è±Ô∏è Timer simples configurado para iniciar automaticamente');
            
            // Garantir que o timer inicie quando a p√°gina carregar completamente
            if (!isTimerRunning) {
                console.log('‚è±Ô∏è Iniciando timer no carregamento da p√°gina...');
                startTimerInterval();
                updateTimeDisplay();
            }
            
            // Inicializar sistema completo de testes e melhorias
            if (typeof ComprehensiveTestSystem !== 'undefined') {
                try {
                    window.comprehensiveTestSystem = new ComprehensiveTestSystem();
                    console.log('üß™ Sistema completo de testes e melhorias inicializado');
                } catch (error) {
                    console.error('Erro ao inicializar sistema de testes:', error);
                }
            }
            
            // Inicializar sistema aprimorado do jogo
            if (typeof EnhancedGameSystem !== 'undefined') {
                try {
                    window.enhancedGameSystem = new EnhancedGameSystem();
                    console.log('üéÆ Sistema aprimorado do jogo inicializado');
                } catch (error) {
                    console.error('Erro ao inicializar sistema aprimorado:', error);
                }
            }
            
            // Inicializar sistema de m√£o completa
            if (typeof CompleteHandSystem !== 'undefined') {
                try {
                    window.completeHandSystem = new CompleteHandSystem();
                    console.log('üÉè Sistema de m√£o completa inicializado');
                } catch (error) {
                    console.error('Erro ao inicializar sistema de m√£o completa:', error);
                }
            }
            
            // Inicializar sistema de diagn√≥stico de layout PRIMEIRO
            if (typeof LayoutDiagnosticSystem !== 'undefined') {
                try {
                    window.layoutDiagnostic = new LayoutDiagnosticSystem();
                    console.log('üîç Sistema de diagn√≥stico de layout inicializado');
                    
                    // Executar diagn√≥stico completo
            setTimeout(() => {
                        window.layoutDiagnostic.forceFixBasedOnDiagnostic();
                        window.layoutDiagnostic.runRealTimeDiagnostic();
                    }, 500);
                } catch (error) {
                    console.error('Erro ao inicializar sistema de diagn√≥stico:', error);
                }
            }

            // Desabilitado: AggressiveFixSystem estava limpando o DOM e causando loops
            // Caso necess√°rio no futuro, reativar com muito cuidado
            
            // Inicializar sistema de corre√ß√£o de layout
            if (typeof LayoutFixSystem !== 'undefined') {
                try {
                    window.layoutFixSystem = new LayoutFixSystem();
                    console.log('üé® Sistema de corre√ß√£o de layout inicializado');
                    
                    // Executar corre√ß√£o de layout
                    setTimeout(() => {
                        window.layoutFixSystem.run();
                    }, 2000);
                } catch (error) {
                    console.error('Erro ao inicializar sistema de corre√ß√£o de layout:', error);
                }
            }
            
            // Inicializar sistema de cartas interativas
            initializeCards();
            console.log('üÉè Sistema de cartas interativas inicializado');
            
            // Inicializar estat√≠sticas
            updateStats();
            updateTimeDisplay();
            console.log('üìä Estat√≠sticas inicializadas');
            
            // Inicializar chat da equipe
            initializeChat();
            console.log('üí¨ Chat da equipe inicializado');
        };
    </script>
</body>
</html>