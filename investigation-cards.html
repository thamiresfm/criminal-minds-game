<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Investiga√ß√£o - Criminal Minds Cards</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #0f0f23, #1a1a2e, #16213e);
            color: white;
            min-height: 100vh;
            overflow-x: hidden;
        }

        .game-container {
            display: grid;
            grid-template-columns: 320px 1fr 320px;
            grid-template-rows: 70px 1fr;
            height: 100vh;
            gap: 0.8rem;
            padding: 0.8rem;
            background: linear-gradient(135deg, #0f0f23, #1a1a2e, #16213e);
            box-shadow: inset 0 0 100px rgba(0, 0, 0, 0.3);
        }

        .header {
            grid-column: 1 / -1;
            background: linear-gradient(135deg, rgba(15, 15, 35, 0.98), rgba(26, 26, 46, 0.98));
            border: 2px solid rgba(251, 191, 36, 0.4);
            border-radius: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 2rem;
            backdrop-filter: blur(20px);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4), inset 0 1px 0 rgba(251, 191, 36, 0.1);
        }

        .case-title {
            font-size: 1.6rem;
            font-weight: 800;
            background: linear-gradient(45deg, #fbbf24, #f59e0b, #f97316);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            text-shadow: 0 0 25px rgba(251, 191, 36, 0.4);
            letter-spacing: 0.5px;
        }

        .timer {
            font-size: 1.4rem;
            color: #ef4444;
            font-weight: 700;
            text-shadow: 0 0 12px rgba(239, 68, 68, 0.6);
            background: rgba(239, 68, 68, 0.1);
            padding: 0.5rem 1rem;
            border-radius: 8px;
            border: 1px solid rgba(239, 68, 68, 0.3);
        }

        .sidebar {
            background: linear-gradient(135deg, rgba(15, 15, 35, 0.98), rgba(26, 26, 46, 0.98));
            border: 2px solid rgba(251, 191, 36, 0.4);
            border-radius: 18px;
            padding: 1.2rem;
            backdrop-filter: blur(20px);
            overflow-y: auto;
            overflow-x: visible;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4), inset 0 1px 0 rgba(251, 191, 36, 0.1);
            min-width: 0;
            max-width: 100%;
        }

        .main-area {
            background: linear-gradient(135deg, rgba(15, 15, 35, 0.98), rgba(26, 26, 46, 0.98));
            border: 2px solid rgba(251, 191, 36, 0.4);
            border-radius: 18px;
            padding: 1.5rem;
            backdrop-filter: blur(20px);
            overflow: hidden;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4), inset 0 1px 0 rgba(251, 191, 36, 0.1);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            min-height: calc(100vh - 140px);
        }

        .section-title {
            font-size: 1.3rem;
            font-weight: 700;
            margin-bottom: 1.5rem;
            color: #fbbf24;
            border-bottom: 3px solid rgba(251, 191, 36, 0.5);
            padding-bottom: 0.8rem;
            text-shadow: 0 0 12px rgba(251, 191, 36, 0.4);
            flex-shrink: 0;
            text-align: center;
            letter-spacing: 0.5px;
        }

        /* OCULTAR SE√á√ÉO MINHA M√ÉO - VERS√ÉO EXPANDIDA */
        .deck-area,
        .hand-cards,
        .mini-card,
        [class*="hand"],
        [id*="hand"],
        [class*="mao"],
        [id*="mao"],
        [class*="deck"],
        [id*="deck"],
        [data-type*="hand"],
        [data-type*="deck"],
        .sidebar .deck-area,
        .sidebar [class*="hand"],
        .sidebar [class*="mini"],
        .sidebar [class*="card"]:not(.main-area .card) {
            display: none !important;
            visibility: hidden !important;
            opacity: 0 !important;
            height: 0 !important;
            overflow: hidden !important;
        }
        
        /* SISTEMA DE CARTAS - GRID QUADRADO 3 COLUNAS */
        .cards-container {
            display: grid;
            grid-template-columns: repeat(3, 208px) !important;
            gap: 0.8rem;
            justify-content: center;
            align-content: center;
            width: 100%;
            max-width: 100%;
            padding: 0 0.8rem;
            min-height: calc(100vh - 200px);
        }
        
        /* Grid espec√≠fico para iniciante (6 cartas = 2x3) */
        .cards-container.beginner {
            grid-template-rows: repeat(2, 130px) !important;
            align-content: center;
        }
        
        /* Grid espec√≠fico para intermedi√°rio (9 cartas = 3x3) */
        .cards-container.intermediate {
            grid-template-rows: repeat(3, 130px) !important;
            align-content: center;
        }
        
        /* Grid espec√≠fico para dif√≠cil (12 cartas = 4x3) */
        .cards-container.hard {
            grid-template-rows: repeat(4, 130px) !important;
            align-content: center;
        }
        
        /* Media queries para responsividade */
        @media (max-width: 1200px) {
            .cards-container {
                grid-template-columns: repeat(3, 180px) !important;
                gap: 0.6rem;
                padding: 0 0.6rem;
                align-content: center;
            }
            
            .card {
                width: 180px;
                height: 110px;
            }
        }
        
        @media (max-width: 768px) {
            .cards-container {
                grid-template-columns: repeat(3, 140px) !important;
                gap: 0.5rem;
                align-content: center;
            }
            
            .card {
                width: 140px;
                height: 90px;
            }
        }
        
        @media (max-width: 480px) {
            .cards-container {
                grid-template-columns: repeat(2, 120px) !important;
                gap: 0.4rem;
                padding: 0 0.3rem;
                align-content: center;
            }
            
            .card {
                width: 120px;
                height: 80px;
            }
        }

        .card {
            position: relative;
            width: 208px;
            height: 130px;
            margin: 0 auto;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            transform-style: preserve-3d;
            perspective: 1000px;
            background: linear-gradient(135deg, rgba(30, 41, 59, 0.95), rgba(15, 23, 42, 0.98));
            border: 2px solid rgba(251, 191, 36, 0.4);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.5), inset 0 1px 0 rgba(251, 191, 36, 0.1);
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            overflow: hidden;
        }

        .card:hover {
            transform: translateY(-10px) rotateX(5deg) rotateY(5deg);
            box-shadow: 0 20px 40px rgba(251, 191, 36, 0.2);
            cursor: pointer;
        }

        .card:active {
            transform: translateY(-5px) rotateX(2deg) rotateY(2deg);
            box-shadow: 0 15px 30px rgba(251, 191, 36, 0.3);
        }

        .card.played {
            opacity: 0.6;
            transform: scale(0.95);
            filter: grayscale(50%);
        }

        .card.played:hover {
            transform: scale(0.95) translateY(-5px);
        }

        .card-inner {
            position: relative;
            width: 100%;
            height: 100%;
            border-radius: 15px;
            overflow: hidden;
            background: linear-gradient(135deg, rgba(22, 33, 62, 0.9), rgba(15, 15, 35, 0.9));
            border: 2px solid transparent;
            background-clip: padding-box;
        }

        /* RARIDADES DAS CARTAS */
        .card.common .card-inner {
            border-image: linear-gradient(45deg, #6b7280, #9ca3af) 1;
            box-shadow: 0 0 20px rgba(107, 114, 128, 0.3);
        }

        .card.rare .card-inner {
            border-image: linear-gradient(45deg, #3b82f6, #60a5fa) 1;
            box-shadow: 0 0 25px rgba(59, 130, 246, 0.4);
        }

        .card.epic .card-inner {
            border-image: linear-gradient(45deg, #8b5cf6, #a78bfa) 1;
            box-shadow: 0 0 30px rgba(139, 92, 246, 0.5);
        }

        .card.legendary .card-inner {
            border-image: linear-gradient(45deg, #f59e0b, #fbbf24, #f97316) 1;
            box-shadow: 0 0 35px rgba(251, 191, 36, 0.6);
            animation: legendaryGlow 3s ease-in-out infinite alternate;
        }

        @keyframes legendaryGlow {
            0% { box-shadow: 0 0 35px rgba(251, 191, 36, 0.6); }
            100% { box-shadow: 0 0 50px rgba(251, 191, 36, 0.8); }
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem 1.2rem 0.5rem;
        }

        .card-type {
            font-size: 0.8rem;
            font-weight: 600;
            text-transform: uppercase;
            opacity: 0.8;
        }

        .card-rarity {
            font-size: 0.9rem;
            font-weight: 700;
            padding: 0.2rem 0.8rem;
            border-radius: 20px;
            text-transform: uppercase;
            font-size: 0.7rem;
        }

        .rarity-common { background: #6b7280; color: white; }
        .rarity-rare { background: #3b82f6; color: white; }
        .rarity-epic { background: #8b5cf6; color: white; }
        .rarity-legendary { 
            background: linear-gradient(45deg, #f59e0b, #fbbf24);
            color: #0f0f23;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        .card-icon {
            font-size: 1.4rem;
            text-align: center;
            margin: 0.3rem 0;
            filter: drop-shadow(0 0 6px rgba(251, 191, 36, 0.3));
            flex-shrink: 0;
        }

        .card-title {
            font-size: 0.75rem;
            font-weight: 700;
            color: #fbbf24;
            text-align: center;
            margin-bottom: 0.3rem;
            text-shadow: 0 0 6px rgba(251, 191, 36, 0.3);
            line-height: 1.1;
            flex-shrink: 0;
        }

        .card-description {
            font-size: 0.6rem;
            color: #cbd5e1;
            line-height: 1.1;
            padding: 0 0.3rem;
            text-align: center;
            margin-bottom: 0.6rem;
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .card-stats {
            background: rgba(0, 0, 0, 0.8);
            padding: 0.25rem 0.5rem;
            display: flex;
            justify-content: space-between;
            font-size: 0.55rem;
            border-radius: 0 0 8px 8px;
            backdrop-filter: blur(10px);
            margin-top: auto;
            flex-shrink: 0;
        }

        .stat {
            display: flex;
            align-items: center;
            gap: 0.2rem;
        }

        /* EFEITO DE FLIP DAS CARTAS */
        .card-flip {
            perspective: 1000px;
        }

        .card-flip .card-inner {
            transform-style: preserve-3d;
            transition: transform 0.6s;
        }

        .card-flip.flipped .card-inner {
            transform: rotateY(180deg);
        }

        .card-front, .card-back {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            border-radius: 15px;
        }

        .card-back {
            transform: rotateY(180deg);
            background: linear-gradient(135deg, rgba(15, 15, 35, 0.95), rgba(22, 33, 62, 0.95));
            padding: 1.5rem;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        /* DECK E M√ÉO DE CARTAS */
        .deck-area {
            margin-top: 2rem;
            padding: 1.5rem;
            background: rgba(22, 33, 62, 0.6);
            border: 2px solid rgba(251, 191, 36, 0.2);
            border-radius: 15px;
        }

        .hand-cards {
            display: flex;
            gap: 1rem;
            overflow-x: auto;
            padding: 1rem 0;
        }

        .mini-card {
            min-width: 120px;
            height: 80px;
            border-radius: 8px;
            background: linear-gradient(135deg, rgba(22, 33, 62, 0.9), rgba(15, 15, 35, 0.9));
            border: 1px solid rgba(251, 191, 36, 0.3);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .mini-card:hover {
            transform: translateY(-5px);
            border-color: #fbbf24;
            box-shadow: 0 10px 20px rgba(251, 191, 36, 0.2);
        }

        .mini-card-icon {
            font-size: 1.5rem;
            margin-bottom: 0.3rem;
        }

        .mini-card-title {
            font-size: 0.7rem;
            font-weight: 600;
            color: #fbbf24;
            text-align: center;
        }

        /* BOT√ïES MODERNOS */
        .btn {
            background: linear-gradient(135deg, #fbbf24, #f59e0b);
            color: #0f0f23;
            border: none;
            padding: 0.8rem 1.5rem;
            border-radius: 12px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(251, 191, 36, 0.3);
            text-transform: uppercase;
            font-size: 0.85rem;
            letter-spacing: 0.5px;
            position: relative;
            overflow: hidden;
        }

        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(251, 191, 36, 0.5);
            background: linear-gradient(135deg, #f59e0b, #fbbf24);
        }

        .btn:active {
            transform: translateY(-1px);
        }

        .btn-danger {
            background: linear-gradient(135deg, #ef4444, #dc2626);
            color: white;
            box-shadow: 0 4px 15px rgba(239, 68, 68, 0.3);
        }

        .btn-danger:hover {
            box-shadow: 0 8px 25px rgba(239, 68, 68, 0.5);
            background: linear-gradient(135deg, #dc2626, #ef4444);
        }

        /* BOT√ÉO SAIR MODERNO */
        .exit-button {
            background: rgba(15, 15, 35, 0.9);
            border: 2px solid rgba(156, 163, 175, 0.3);
            color: #9ca3af;
            padding: 0.6rem 1rem;
            border-radius: 12px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.9rem;
            backdrop-filter: blur(10px);
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
        }

        .exit-button:hover {
            border-color: #ef4444;
            color: #f87171;
            background: rgba(239, 68, 68, 0.1);
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(239, 68, 68, 0.2);
        }

        .exit-icon {
            font-size: 1.2rem;
            font-weight: bold;
            transition: transform 0.3s ease;
        }

        .exit-button:hover .exit-icon {
            transform: translateX(-3px);
        }

        .exit-button:active {
            transform: translateY(0) scale(0.95);
        }

        /* MODAL MODERNO */
        .modal {
            display: none;
            position: fixed;
            z-index: 2000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.9);
            backdrop-filter: blur(10px);
        }

        .modal-content {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: linear-gradient(135deg, #1a1a2e, #16213e);
            border: 3px solid #fbbf24;
            border-radius: 20px;
            padding: 2.5rem;
            max-width: 700px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
        }

        .close {
            color: #aaa;
            float: right;
            font-size: 32px;
            font-weight: bold;
            cursor: pointer;
            transition: color 0.3s ease;
        }

        .close:hover {
            color: #fbbf24;
            text-shadow: 0 0 10px rgba(251, 191, 36, 0.5);
        }

        /* PROGRESS BARS MODERNAS */
        .progress-bar {
            width: 100%;
            height: 12px;
            background: rgba(15, 15, 35, 0.8);
            border-radius: 6px;
            margin-top: 1rem;
            overflow: hidden;
            border: 1px solid rgba(251, 191, 36, 0.2);
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #fbbf24, #f59e0b, #f97316);
            transition: width 0.5s ease;
            box-shadow: 0 0 20px rgba(251, 191, 36, 0.3);
        }

        /* CHAT MODERNO */
        .chat-container {
            height: 200px;
            background: rgba(15, 15, 35, 0.6);
            border: 2px solid rgba(251, 191, 36, 0.3);
            border-radius: 15px;
            padding: 1rem;
            margin-bottom: 1.5rem;
            overflow-y: auto;
            overflow-x: hidden;
            backdrop-filter: blur(10px);
            width: 100%;
            box-sizing: border-box;
        }

        .chat-message {
            margin-bottom: 0.8rem;
            font-size: 0.9rem;
            padding: 0.5rem;
            border-radius: 8px;
            background: rgba(22, 33, 62, 0.3);
        }

        .chat-user {
            color: #fbbf24;
            font-weight: 700;
            text-shadow: 0 0 5px rgba(251, 191, 36, 0.3);
        }

        .chat-input-container {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
            margin-top: 1rem;
            width: 100%;
            box-sizing: border-box;
            max-width: 100%;
        }

        .chat-input-field {
            width: 100%;
            padding: 1rem 1.2rem;
            border: 2px solid rgba(251, 191, 36, 0.3);
            border-radius: 15px;
            background: rgba(15, 15, 35, 0.9);
            color: white;
            font-size: 0.95rem;
            font-weight: 500;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
            box-sizing: border-box;
        }

        .chat-input-field:focus {
            outline: none;
            border-color: #fbbf24;
            box-shadow: 0 0 20px rgba(251, 191, 36, 0.4);
            background: rgba(15, 15, 35, 0.95);
            transform: translateY(-2px);
        }

        .chat-input-field::placeholder {
            color: rgba(203, 213, 225, 0.6);
            font-style: italic;
        }

        /* BOT√ÉO ENVIAR FULL-WIDTH - EMBAIXO DO INPUT */
        .send-button {
            background: linear-gradient(135deg, #fbbf24, #f59e0b, #f97316);
            color: #0f0f23;
            border: none;
            padding: 1rem 1.5rem;
            border-radius: 12px;
            font-weight: 800;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            box-shadow: 0 4px 15px rgba(251, 191, 36, 0.4);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            width: 100%;
            position: relative;
            overflow: hidden;
            border: 2px solid transparent;
            background-clip: padding-box;
            box-sizing: border-box;
        }

        .send-button::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            transition: left 0.6s ease;
        }

        .send-button:hover {
            transform: translateY(-4px) scale(1.05);
            box-shadow: 0 10px 30px rgba(251, 191, 36, 0.6);
            background: linear-gradient(135deg, #f59e0b, #fbbf24, #f97316);
            border-color: rgba(251, 191, 36, 0.8);
        }

        .send-button:hover::before {
            left: 100%;
        }

        .send-button:active {
            transform: translateY(-2px) scale(0.95);
            box-shadow: 0 6px 20px rgba(251, 191, 36, 0.5);
            transition: all 0.1s ease;
        }

        .send-button:focus {
            outline: none;
            box-shadow: 0 0 0 3px rgba(251, 191, 36, 0.3);
        }

        .send-button-icon {
            font-size: 1.2rem;
            transition: transform 0.3s ease;
        }

        .send-button:hover .send-button-icon {
            transform: translateX(3px) scale(1.1);
        }

        .send-button-text {
            font-size: 0.9rem;
            font-weight: 800;
            transition: all 0.3s ease;
        }

        .send-button-ripple {
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.6);
            transform: translate(-50%, -50%);
            transition: width 0.6s ease, height 0.6s ease;
            pointer-events: none;
        }

        .send-button:active .send-button-ripple {
            width: 100px;
            height: 100px;
        }

        /* ANIMA√á√ÉO DE PULSE PARA CHAMAR ATEN√á√ÉO */
        @keyframes sendPulse {
            0% { box-shadow: 0 4px 15px rgba(251, 191, 36, 0.4); }
            50% { box-shadow: 0 4px 25px rgba(251, 191, 36, 0.7); }
            100% { box-shadow: 0 4px 15px rgba(251, 191, 36, 0.4); }
        }

        .send-button.highlight {
            animation: sendPulse 1.5s ease-in-out infinite;
        }

        /* RESPONSIVIDADE DO CHAT MELHORADA - LAYOUT VERTICAL */
        @media (max-width: 1024px) {
            .chat-input-container {
                gap: 0.6rem;
            }
            
            .chat-input-field {
                padding: 0.9rem 1rem;
                font-size: 0.9rem;
            }
            
            .send-button {
                padding: 0.9rem 1.2rem;
                font-size: 0.85rem;
                gap: 0.4rem;
            }
        }

        @media (max-width: 768px) {
            .chat-input-container {
                gap: 0.5rem;
            }
            
            .chat-input-field {
                padding: 0.8rem 1rem;
                font-size: 0.85rem;
                border-radius: 10px;
            }
            
            .send-button {
                padding: 0.8rem 1rem;
                font-size: 0.8rem;
                gap: 0.3rem;
                border-radius: 10px;
            }
            
            .send-button-text {
                font-size: 0.8rem;
            }
            
            .send-button-icon {
                font-size: 1.1rem;
            }
        }

        @media (max-width: 480px) {
            .chat-input-container {
                gap: 0.4rem;
            }
            
            .chat-input-field {
                padding: 0.7rem 0.9rem;
                font-size: 0.8rem;
                border-radius: 8px;
            }
            
            .send-button {
                padding: 0.7rem 0.8rem;
                font-size: 0.75rem;
                gap: 0.2rem;
                border-radius: 8px;
            }
            
            .send-button-text {
                font-size: 0.75rem;
            }
            
            .send-button-icon {
                font-size: 1rem;
            }
        }

        @media (max-width: 360px) {
            .chat-input-container {
                gap: 0.3rem;
            }
            
            .chat-input-field {
                padding: 0.6rem 0.8rem;
                font-size: 0.75rem;
            }
            
            .send-button {
                padding: 0.6rem 0.7rem;
                font-size: 0.7rem;
                gap: 0.15rem;
            }
            
            .send-button-text {
                font-size: 0.7rem;
            }
            
            .send-button-icon {
                font-size: 0.9rem;
            }
        }

        /* CORRE√á√ïES CR√çTICAS DE LAYOUT */
            .game-container {
            display: grid !important;
            grid-template-columns: 300px 1fr 300px !important;
            grid-template-rows: 80px 1fr !important;
            height: 100vh !important;
            gap: 1rem !important;
            padding: 1rem !important;
            max-width: 100vw !important;
            overflow: hidden !important;
            }

            .cards-container {
            display: grid !important;
            grid-template-columns: repeat(2, 1fr) !important;
            gap: 1rem !important;
            margin-bottom: 1.5rem !important;
            max-width: 100% !important;
            }

            .card {
            width: 100% !important;
            max-width: none !important;
            height: 130px !important;
            margin: 0 !important;
        }
        
        .sidebar {
            padding: 1rem !important;
            overflow-y: auto !important;
            overflow-x: hidden !important;
            max-height: calc(100vh - 120px) !important;
            display: flex !important;
            flex-direction: column !important;
        }
        
        /* Corre√ß√£o espec√≠fica para sidebar direita com cartas */
        .sidebar:last-child {
            padding-bottom: 2rem !important;
        }
        
        .deck-area {
            margin-bottom: 2rem !important;
        }
        
        .main-area {
            padding: 1.5rem !important;
            overflow-y: auto !important;
            overflow-x: hidden !important;
            max-height: calc(100vh - 120px) !important;
        }

        /* RESPONSIVIDADE OTIMIZADA PARA LAYOUT VERTICAL */
        @media (max-width: 1400px) {
            .game-container {
                grid-template-columns: 280px 1fr 280px !important;
            }
        }
        
        @media (max-width: 1200px) {
            .game-container {
                grid-template-columns: 1fr !important;
                grid-template-rows: auto auto 1fr auto !important;
                height: auto !important;
                min-height: 100vh !important;
                padding: 0.8rem !important;
            }

            .sidebar {
                padding: 1rem 0.8rem !important;
                overflow-x: visible !important;
                max-height: none !important;
            }
            
            .main-area {
                max-height: none !important;
            }
            
            .chat-input-container {
                max-width: 100% !important;
            }

            .cards-container {
                grid-template-columns: repeat(3, 1fr) !important;
            }

            .card {
                width: 100% !important;
                max-width: none !important;
                margin: 0 auto !important;
            }
        }

        @media (max-width: 768px) {
            .sidebar {
                padding: 0.8rem 0.6rem !important;
                overflow-x: visible !important;
            }
            
            .chat-input-container {
                max-width: 100% !important;
            }
            
            .cards-container {
                grid-template-columns: repeat(2, 1fr) !important;
                gap: 0.8rem !important;
            }
            
            .hand-cards {
                justify-content: center !important;
            }
        }

        @media (max-width: 480px) {
            .cards-container {
                grid-template-columns: 1fr !important;
                gap: 0.5rem !important;
            }
            
            .card {
                height: 120px !important;
            }
            
            .game-container {
                padding: 0.5rem !important;
            }
        }
        
        /* CORRE√á√ïES ESPEC√çFICAS PARA MINHA M√ÉO - LAYOUT 3 COLUNAS */
        .hand-cards {
            display: grid !important;
            grid-template-columns: repeat(3, 1fr) !important;
            gap: 1rem !important;
            margin-top: 1rem !important;
            margin-bottom: 1.5rem !important;
            padding: 1.5rem !important;
            background: rgba(15, 15, 35, 0.7) !important;
            border-radius: 20px !important;
            border: 2px solid rgba(251, 191, 36, 0.5) !important;
            box-shadow: 0 6px 30px rgba(0, 0, 0, 0.4) !important;
            max-width: 100% !important;
            }

            .mini-card {
            height: 150px !important;
            min-height: 150px !important;
            display: flex !important;
            flex-direction: column !important;
            justify-content: space-between !important;
            align-items: center !important;
            background: linear-gradient(135deg, #1a1a2e, #16213e, #1e1e3f) !important;
            border: 2px solid rgba(251, 191, 36, 0.4) !important;
            border-radius: 15px !important;
            padding: 1rem !important;
            cursor: pointer !important;
            transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275) !important;
            text-align: center !important;
            position: relative !important;
            overflow: visible !important;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3) !important;
        }
        
        .mini-card:hover {
            transform: translateY(-4px) scale(1.05) !important;
            border-color: rgba(251, 191, 36, 0.8) !important;
            box-shadow: 0 8px 25px rgba(251, 191, 36, 0.3) !important;
            background: linear-gradient(135deg, #1e1e3f, #1a2040) !important;
        }
        
        .mini-card:active {
            transform: translateY(-2px) scale(1.02) !important;
        }
        
        .mini-card-icon {
            font-size: 2rem !important;
            margin-bottom: 0.75rem !important;
            filter: drop-shadow(0 0 10px rgba(251, 191, 36, 0.5)) !important;
            flex-shrink: 0 !important;
        }
        
        .mini-card-title {
            font-size: 0.9rem !important;
            color: #fbbf24 !important;
            font-weight: 700 !important;
            line-height: 1.2 !important;
            text-shadow: 0 0 8px rgba(251, 191, 36, 0.4) !important;
            white-space: normal !important;
            overflow: visible !important;
            text-overflow: unset !important;
            width: 100% !important;
            text-align: center !important;
            margin-top: auto !important;
        }
        
        /* Bot√µes da √°rea de m√£o */
        .hand-buttons {
            display: flex !important;
            gap: 0.5rem !important;
            margin-top: 1rem !important;
            justify-content: center !important;
            flex-wrap: wrap !important;
        }
        
        .hand-buttons button {
            padding: 0.5rem 1rem !important;
            font-size: 0.85rem !important;
            min-width: auto !important;
            flex: none !important;
        }
        
        /* Responsividade para m√£o - Layout 3 colunas otimizado */
        @media (max-width: 768px) {
            .hand-cards {
                grid-template-columns: repeat(3, 1fr) !important;
                gap: 0.75rem !important;
                padding: 1.25rem !important;
            }
            
            .mini-card {
                height: 140px !important;
                min-height: 140px !important;
                padding: 0.75rem !important;
            }
            
            .mini-card-icon {
                font-size: 1.75rem !important;
                margin-bottom: 0.5rem !important;
            }
            
            .mini-card-title {
                font-size: 0.8rem !important;
                line-height: 1.1 !important;
            }
        }
        
        @media (max-width: 480px) {
            .hand-cards {
                grid-template-columns: repeat(2, 1fr) !important;
                gap: 0.75rem !important;
                padding: 1rem !important;
            }
            
            .mini-card {
                height: 130px !important;
                min-height: 130px !important;
                padding: 0.75rem !important;
            }
            
            .mini-card-icon {
                font-size: 1.5rem !important;
                margin-bottom: 0.5rem !important;
            }
            
            .mini-card-title {
                font-size: 0.75rem !important;
                line-height: 1.1 !important;
            }
        }
        
        @media (max-width: 360px) {
            .hand-cards {
                grid-template-columns: repeat(2, 1fr) !important;
                gap: 0.5rem !important;
                padding: 0.75rem !important;
            }
            
            .mini-card {
                height: 120px !important;
                min-height: 120px !important;
                padding: 0.5rem !important;
            }
            
            .mini-card-icon {
                font-size: 1.25rem !important;
                margin-bottom: 0.25rem !important;
            }
            
            .mini-card-title {
                font-size: 0.7rem !important;
                line-height: 1 !important;
            }
        }

        /* ANIMA√á√ïES EXTRAS */
        @keyframes cardAppear {
            0% {
                opacity: 0;
                transform: translateY(50px) rotateX(-30deg);
            }
            100% {
                opacity: 1;
                transform: translateY(0) rotateX(0);
            }
        }

        @keyframes slideIn {
            0% {
                opacity: 0;
                transform: translateX(50px) scale(0.8);
            }
            100% {
                opacity: 1;
                transform: translateX(0) scale(1);
            }
        }

        /* EFEITOS PARA BOT√ÉO DISABLED */
        .send-button:disabled {
            opacity: 0.7;
            cursor: not-allowed;
            transform: none !important;
        }

        .send-button:disabled:hover {
            transform: none !important;
            box-shadow: 0 4px 15px rgba(251, 191, 36, 0.3) !important;
        }

        .card {
            animation: cardAppear 0.6s ease-out;
        }

        .card:nth-child(1) { animation-delay: 0.1s; }
        .card:nth-child(2) { animation-delay: 0.2s; }
        .card:nth-child(3) { animation-delay: 0.3s; }
        .card:nth-child(4) { animation-delay: 0.4s; }
        .card:nth-child(5) { animation-delay: 0.5s; }
        .card:nth-child(6) { animation-delay: 0.6s; }

        /* FOR√áAR LAYOUT 3 COLUNAS - M√ÅXIMA ESPECIFICIDADE */
        html body .sidebar .deck-area .hand-cards {
            display: grid !important;
            grid-template-columns: repeat(3, 1fr) !important;
            gap: 1rem !important;
            margin-top: 1rem !important;
            margin-bottom: 1.5rem !important;
            padding: 1.5rem !important;
            background: rgba(15, 15, 35, 0.7) !important;
            border-radius: 20px !important;
            border: 2px solid rgba(251, 191, 36, 0.5) !important;
            box-shadow: 0 6px 30px rgba(0, 0, 0, 0.4) !important;
            max-width: 100% !important;
        }

        html body .sidebar .deck-area .hand-cards .mini-card {
            height: 150px !important;
            min-height: 150px !important;
            display: flex !important;
            flex-direction: column !important;
            justify-content: space-between !important;
            align-items: center !important;
            background: linear-gradient(135deg, #1a1a2e, #16213e, #1e1e3f) !important;
            border: 2px solid rgba(251, 191, 36, 0.4) !important;
            border-radius: 15px !important;
            padding: 1rem !important;
            cursor: pointer !important;
            transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275) !important;
            text-align: center !important;
            position: relative !important;
            overflow: visible !important;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3) !important;
        }

        html body .sidebar .deck-area .hand-cards .mini-card:hover {
            transform: translateY(-4px) scale(1.05) !important;
            border-color: rgba(251, 191, 36, 0.8) !important;
            box-shadow: 0 8px 25px rgba(251, 191, 36, 0.3) !important;
            background: linear-gradient(135deg, #1e1e3f, #1a2040) !important;
        }

        html body .sidebar .deck-area .hand-cards .mini-card-icon {
            font-size: 2rem !important;
            margin-bottom: 0.75rem !important;
            filter: drop-shadow(0 0 10px rgba(251, 191, 36, 0.5)) !important;
            flex-shrink: 0 !important;
        }

        html body .sidebar .deck-area .hand-cards .mini-card-title {
            font-size: 0.9rem !important;
            color: #fbbf24 !important;
            font-weight: 700 !important;
            line-height: 1.2 !important;
            text-shadow: 0 0 8px rgba(251, 191, 36, 0.4) !important;
            white-space: normal !important;
            overflow: visible !important;
            text-overflow: unset !important;
            width: 100% !important;
            text-align: center !important;
            margin-top: auto !important;
        }

        /* ESTILOS PARA CONQUISTAS RECENTES */
        .achievements-container {
            max-height: 200px;
            overflow-y: auto;
            padding-right: 5px;
        }

        .achievement-item {
            margin-bottom: 0.8rem;
            padding: 0.8rem;
            border-radius: 12px;
            border-left: 4px solid;
            background: rgba(15, 15, 35, 0.8);
            backdrop-filter: blur(10px);
            animation: achievementSlideIn 0.5s ease-out;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .achievement-item:hover {
            transform: translateX(5px);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
        }

        .achievement-item.gold {
            border-left-color: #fbbf24;
            background: linear-gradient(135deg, rgba(251, 191, 36, 0.1), rgba(15, 15, 35, 0.9));
            box-shadow: 0 0 15px rgba(251, 191, 36, 0.2);
        }

        .achievement-item.silver {
            border-left-color: #94a3b8;
            background: linear-gradient(135deg, rgba(148, 163, 184, 0.1), rgba(15, 15, 35, 0.9));
            box-shadow: 0 0 15px rgba(148, 163, 184, 0.2);
        }

        .achievement-item.bronze {
            border-left-color: #f97316;
            background: linear-gradient(135deg, rgba(249, 115, 22, 0.1), rgba(15, 15, 35, 0.9));
            box-shadow: 0 0 15px rgba(249, 115, 22, 0.2);
        }

        .achievement-item.rare {
            border-left-color: #8b5cf6;
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.1), rgba(15, 15, 35, 0.9));
            box-shadow: 0 0 15px rgba(139, 92, 246, 0.2);
        }

        .achievement-icon {
            font-size: 1.2rem;
            margin-right: 0.5rem;
            filter: drop-shadow(0 0 5px rgba(251, 191, 36, 0.5));
        }

        .achievement-title {
            font-weight: 700;
            font-size: 0.9rem;
            color: #fbbf24;
            margin-bottom: 0.2rem;
            text-shadow: 0 0 5px rgba(251, 191, 36, 0.3);
        }

        .achievement-description {
            font-size: 0.75rem;
            color: #94a3b8;
            line-height: 1.2;
        }

        .achievement-reward {
            position: absolute;
            top: 0.5rem;
            right: 0.5rem;
            font-size: 0.7rem;
            color: #10b981;
            font-weight: 600;
            background: rgba(16, 185, 129, 0.1);
            padding: 0.2rem 0.4rem;
            border-radius: 6px;
            border: 1px solid rgba(16, 185, 129, 0.2);
        }

        .achievement-timestamp {
            font-size: 0.65rem;
            color: #64748b;
            margin-top: 0.3rem;
            font-style: italic;
        }

        @keyframes achievementSlideIn {
            from {
                opacity: 0;
                transform: translateX(-20px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        .achievements-container::-webkit-scrollbar {
            width: 4px;
        }

        .achievements-container::-webkit-scrollbar-track {
            background: rgba(15, 15, 35, 0.5);
            border-radius: 2px;
        }

        .achievements-container::-webkit-scrollbar-thumb {
            background: rgba(251, 191, 36, 0.3);
            border-radius: 2px;
        }

        .achievements-container::-webkit-scrollbar-thumb:hover {
            background: rgba(251, 191, 36, 0.5);
        }




    </style>
    <!-- Criminal Minds API v2.0 - Sistema Melhorado -->
    <script src="js/api-client-simple.js?v=20241209_1"></script>
    <script src="js/game-functions.js?v=20241209_1"></script>
    <script defer src="js/comprehensive-test-system.js?v=20241209_1"></script>
    <script defer src="js/enhanced-game-system.js?v=20241209_1"></script>
    <script defer src="js/complete-hand-system.js?v=20241209_1"></script>
    <!-- AggressiveFix desativado nesta tela -->
    <script defer src="js/layout-fix-system.js?v=20241209_1"></script>
    <script defer src="js/layout-diagnostic-system.js?v=20241209_1"></script>
    <script defer src="js/layout-repair-system.js?v=20241209_1"></script>
</head>
<body>
    <div class="game-container">
        <div class="header">
            <div style="display: flex; align-items: center; gap: 1rem;">
                <button class="exit-button" onclick="exitInvestigation()">
                    <span class="exit-icon">‚Üê</span>
                    <span>Sair</span>
                </button>
                <div class="case-title">üéØ CRIMINAL MINDS: DIGITAL CARDS</div>
            </div>
            <div class="timer" id="gameTimer">‚è±Ô∏è 45:00</div>
                        <div style="display: flex; gap: 1rem;">
                <button class="btn" onclick="openDeck()">üÉè Meu Deck</button>
                <button class="btn" onclick="showCollection()">üìö Cole√ß√£o</button>
                <button class="btn btn-danger" onclick="makeAccusation()">‚öñÔ∏è Acusar</button>
            </div>
        </div>

        <div class="sidebar">
            <div class="section-title">üïµÔ∏è Equipe Online</div>
            <div class="team-list" id="teamList">
                <div class="chat-message">
                    <span class="chat-user">üëë Detetive Reid:</span> Online - 127 cartas
                </div>
                <div class="chat-message">
                    <span class="chat-user">üîç Agente Morgan:</span> Online - 98 cartas
                </div>
                <div class="chat-message">
                    <span class="chat-user">üìä Dra. Brennan:</span> Online - 156 cartas
                </div>
            </div>

            <div class="section-title" style="margin-top: 2rem;">üí¨ Chat da Equipe</div>
            <div class="chat-container" id="chatContainer">
                <div class="chat-message">
                    <span class="chat-user">üëë Reid:</span> Acabei de encontrar uma carta LEND√ÅRIA! üî•
                </div>
                <div class="chat-message">
                    <span class="chat-user">üîç Morgan:</span> Vou jogar minha carta de Interrogat√≥rio
                </div>
                <div class="chat-message">
                    <span class="chat-user">üìä Brennan:</span> Combo perfeito de evid√™ncias! +50 pontos
                </div>
            </div>
            <div class="chat-input-container">
                <input type="text" id="chatInput" placeholder="Digite sua mensagem..." maxlength="200" class="chat-input-field">
                <button class="send-button" onclick="sendMessage()" title="Enviar mensagem (Enter)" aria-label="Enviar mensagem">
                    <span class="send-button-text">Enviar</span>
                    <span class="send-button-icon">üì§</span>
                    <div class="send-button-ripple"></div>
                </button>
            </div>
        </div>

        <div class="main-area">
            <div class="section-title">
                üÉè Cartas de Investiga√ß√£o Ativas
            </div>
            <div class="cards-container" id="cardsContainer">
                <!-- Carta 1: Interrogat√≥rio -->
                <div class="card" data-type="interrogation">
                    <div class="card-icon">üîç</div>
                    <div class="card-title">Interrogat√≥rio</div>
                    <div class="card-description">Questiona suspeitos para obter informa√ß√µes cruciais</div>
                    <div class="card-stats">
                        <span>üí¨ +3 Evid√™ncias</span>
                        <span>‚ö° 2 Turnos</span>
                    </div>
                </div>

                <!-- Carta 2: An√°lise Forense -->
                <div class="card" data-type="forensic">
                    <div class="card-icon">üß¨</div>
                    <div class="card-title">An√°lise Forense</div>
                    <div class="card-description">Examina evid√™ncias f√≠sicas no laborat√≥rio</div>
                    <div class="card-stats">
                        <span>üî¨ +5 Evid√™ncias</span>
                        <span>‚ö° 3 Turnos</span>
                    </div>
                </div>

                <!-- Carta 3: Vigil√¢ncia -->
                <div class="card" data-type="surveillance">
                    <div class="card-icon">üìπ</div>
                    <div class="card-title">Vigil√¢ncia</div>
                    <div class="card-description">Monitora movimentos suspeitos</div>
                    <div class="card-stats">
                        <span>üëÅÔ∏è +2 Evid√™ncias</span>
                        <span>‚ö° 1 Turno</span>
                    </div>
                </div>

                <!-- Carta 4: Busca Domiciliar -->
                <div class="card" data-type="search">
                    <div class="card-icon">üè†</div>
                    <div class="card-title">Busca Domiciliar</div>
                    <div class="card-description">Revista resid√™ncias em busca de pistas</div>
                    <div class="card-stats">
                        <span>üîç +4 Evid√™ncias</span>
                        <span>‚ö° 2 Turnos</span>
                    </div>
                </div>

                <!-- Carta 5: An√°lise Psicol√≥gica -->
                <div class="card" data-type="psychology">
                    <div class="card-icon">üß†</div>
                    <div class="card-title">An√°lise Psicol√≥gica</div>
                    <div class="card-description">Avalia o perfil psicol√≥gico do suspeito</div>
                    <div class="card-stats">
                        <span>üí≠ +6 Evid√™ncias</span>
                        <span>‚ö° 4 Turnos</span>
                    </div>
                </div>

                <!-- Carta 6: Coleta de DNA -->
                <div class="card" data-type="dna">
                    <div class="card-icon">üß™</div>
                    <div class="card-title">Coleta de DNA</div>
                    <div class="card-description">Coleta amostras para an√°lise gen√©tica</div>
                    <div class="card-stats">
                        <span>üß¨ +7 Evid√™ncias</span>
                        <span>‚ö° 3 Turnos</span>
                    </div>
                </div>

                <!-- Carta 7: Entrevista de Testemunha -->
                <div class="card" data-type="witness">
                    <div class="card-icon">üë§</div>
                    <div class="card-title">Entrevista de Testemunha</div>
                    <div class="card-description">Obt√©m depoimentos de testemunhas</div>
                    <div class="card-stats">
                        <span>üó£Ô∏è +3 Evid√™ncias</span>
                        <span>‚ö° 1 Turno</span>
                    </div>
                </div>

                <!-- Carta 8: An√°lise de C√¢meras -->
                <div class="card" data-type="cameras">
                    <div class="card-icon">üì∑</div>
                    <div class="card-title">An√°lise de C√¢meras</div>
                    <div class="card-description">Revisa grava√ß√µes de seguran√ßa</div>
                    <div class="card-stats">
                        <span>üìπ +4 Evid√™ncias</span>
                        <span>‚ö° 2 Turnos</span>
                    </div>
                </div>

                <!-- Carta 9: Busca em Banco de Dados -->
                <div class="card" data-type="database">
                    <div class="card-icon">üíæ</div>
                    <div class="card-title">Busca em Banco de Dados</div>
                    <div class="card-description">Consulta registros criminais</div>
                    <div class="card-stats">
                        <span>üîç +5 Evid√™ncias</span>
                        <span>‚ö° 2 Turnos</span>
                    </div>
                </div>
            </div>
        </div>

        <div class="sidebar">
            <div class="section-title">üìä Estat√≠sticas</div>
            
            <!-- Estat√≠sticas da Partida Atual -->
            <div style="margin-bottom: 1rem; padding: 0.75rem; background: rgba(15, 15, 35, 0.6); border-radius: 8px; border: 1px solid rgba(251, 191, 36, 0.3);">
                <div style="color: #fbbf24; font-size: 0.8rem; font-weight: bold; margin-bottom: 0.5rem; text-align: center;">
                    üéØ Partida Atual
                </div>
            
                <!-- Indicador Principal de Dificuldade -->
                <div id="difficultyIndicator" style="
                    margin-bottom: 1rem; 
                    padding: 0.75rem; 
                    background: linear-gradient(135deg, rgba(251, 191, 36, 0.1), rgba(245, 158, 11, 0.1)); 
                    border: 2px solid #f59e0b; 
                    border-radius: 10px; 
                    text-align: center;
                    box-shadow: 0 4px 15px rgba(245, 158, 11, 0.2);
                ">
                    <div style="font-size: 1.5rem; margin-bottom: 0.3rem;" id="difficultyIcon">üü°</div>
                    <div style="font-size: 0.9rem; font-weight: bold; color: #f59e0b; margin-bottom: 0.2rem;" id="difficultyName">INTERMEDI√ÅRIO</div>
                    <div style="font-size: 0.7rem; color: #cbd5e1; line-height: 1.3;" id="difficultyDescription">Tempo padr√£o, cartas balanceadas, b√¥nus de 50%</div>
            </div>

                <div style="margin-bottom: 0.75rem;">
                    <div style="display: flex; justify-content: space-between; margin-bottom: 0.3rem; font-size: 0.85rem;">
                        <span>Multiplicador</span>
                        <span id="currentMultiplier" style="color: #fbbf24; font-weight: bold;">1.5x</span>
                    </div>
                    </div>
                <div style="margin-bottom: 0.75rem;">
                    <div style="display: flex; justify-content: space-between; margin-bottom: 0.3rem; font-size: 0.85rem;">
                    <span>Cartas Jogadas</span>
                        <span id="cardsPlayed">12/20</span>
                    </div>
                <div class="progress-bar">
                        <div class="progress-fill" id="cardsProgress" style="width: 60%"></div>
                    </div>
                    </div>
                <div style="margin-bottom: 0.75rem;">
                    <div style="display: flex; justify-content: space-between; margin-bottom: 0.3rem; font-size: 0.85rem;">
                    <span>Combo Streak</span>
                        <span id="comboStreak">3x</span>
                    </div>
                <div class="progress-bar">
                        <div class="progress-fill" id="comboProgress" style="width: 30%"></div>
                </div>
                </div>
            </div>





            <div class="section-title" style="margin-top: 2rem;">üí∞ Loja de Cartas</div>
            <div style="display: flex; flex-direction: column; gap: 0.8rem;">
                <button class="btn" onclick="buyPack('basic')">
                    üì¶ Pacote B√°sico - 100üí∞
                </button>
                <button class="btn" onclick="buyPack('premium')">
                    ‚ú® Pacote Premium - 250üí∞
                </button>
                <button class="btn" onclick="buyPack('legendary')">
                    üåü Pacote Lend√°rio - 500üí∞
                </button>
                </div>

            <div style="text-align: center; margin-top: 1.5rem; font-size: 1.2rem; color: #fbbf24;">
                üí∞ Moedas: <strong id="coin-display">500</strong>
                <div style="font-size: 0.8rem; color: #94a3b8; margin-top: 0.5rem;">
                    üéÅ Ganhe moedas jogando cartas e fazendo combos!
                </div>
            </div>

            <!-- Conquistas Recentes -->
            <div class="achievements-section" style="margin-top: 2rem;">
                <div class="section-title">üèÜ Conquistas Recentes</div>
                <div id="achievements-container" class="achievements-container">
                    <div class="no-achievements" id="no-achievements" style="
                        text-align: center; 
                        color: #64748b; 
                        font-size: 0.9rem; 
                        padding: 1rem;
                        font-style: italic;
                    ">
                        Jogue cartas para desbloquear conquistas! üéØ
                    </div>
                </div>
            </div>
                </div>
            </div>

    <!-- Modal para Carta Detalhada -->
    <div id="cardModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('cardModal')">&times;</span>
            <h2 style="color: #fbbf24; margin-bottom: 1.5rem;">üÉè Detalhes da Carta</h2>
            <div id="cardDetails"></div>
        </div>
    </div>

    <!-- Modal para Cole√ß√£o -->
    <div id="collectionModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('collectionModal')">&times;</span>
            <h2 style="color: #fbbf24; margin-bottom: 1.5rem;">üìö Minha Cole√ß√£o</h2>
            <div id="collectionContent">
                <p>Total de cartas: <strong>47/200</strong></p>
                <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(100px, 1fr)); gap: 1rem; margin-top: 1.5rem;">
                    <div class="mini-card">
                        <div class="mini-card-icon">üß¨</div>
                        <div class="mini-card-title">DNA (L)</div>
                    </div>
                    <div class="mini-card">
                        <div class="mini-card-icon">üë®‚Äçüíº</div>
                        <div class="mini-card-title">Marcus (E)</div>
                    </div>
                    <div class="mini-card">
                        <div class="mini-card-icon">üîç</div>
                        <div class="mini-card-title">Interrogat√≥rio (R)</div>
                    </div>
                    <!-- Mais cartas... -->
                </div>
            </div>
        </div>
    </div>

    <script>
        // Timer do jogo (ser√° definido pela dificuldade)
        let gameTime = 45 * 60;
        let difficultyMultiplier = 1.0;
        let cardsPlayed = 0;
        let comboStreak = 0;
        let playerCoins = loadPlayerCoins(); // Sistema din√¢mico de moedas
        
        // ========================================
        // SISTEMA COMPLETO DE MOEDAS
        // ========================================
        
        function loadPlayerCoins() {
            // Carregar moedas salvas ou come√ßar com valor inicial
            const savedCoins = localStorage.getItem('criminalMinds_playerCoins');
            const initialCoins = savedCoins ? parseInt(savedCoins) : 500; // Valor inicial mais generoso
            return Math.max(initialCoins, 50); // Garantir m√≠nimo de 50 moedas
        }
        
        function savePlayerCoins() {
            localStorage.setItem('criminalMinds_playerCoins', playerCoins);
            console.log(`üí∞ Moedas salvas: ${playerCoins}`);
        }
        
        function updateCoinDisplay() {
            const coinElement = document.getElementById('coin-display') || document.querySelector('div[style*="Moedas"] strong');
            if (coinElement) {
                coinElement.textContent = playerCoins;
                coinElement.style.color = playerCoins < 100 ? '#ff6b6b' : '#fbbf24';
                
                // Efeito visual de mudan√ßa
                coinElement.style.transform = 'scale(1.1)';
                setTimeout(() => {
                    coinElement.style.transform = 'scale(1)';
                }, 200);
            }
            savePlayerCoins();
        }
        
        function rewardCoins(amount, reason) {
            if (amount <= 0) return;
            
            // Aplicar multiplicador de dificuldade
            const finalAmount = Math.floor(amount * difficultyMultiplier);
            const bonusText = difficultyMultiplier > 1 ? ` (${difficultyMultiplier}x b√¥nus!)` : '';
            
            playerCoins += finalAmount;
            updateCoinDisplay();
            
            // Verificar conquista de riqueza
            if (!achievements.wealthy.completed && playerCoins >= 1000) {
                unlockAchievement('wealthy');
            }
            
            // Feedback visual e sonoro
            showNotification(`üí∞ +${finalAmount} moedas! ${reason}${bonusText}`);
            addChatMessage(`üí∞ Ganhei ${finalAmount} moedas: ${reason}${bonusText}`, 'self');
            
            // Log para debugging
            console.log(`üí∞ Recompensa: +${finalAmount} moedas (${amount} x ${difficultyMultiplier}) por "${reason}". Total: ${playerCoins}`);
        }
        
        function spendCoins(amount, reason) {
            if (amount <= 0 || playerCoins < amount) return false;
            
            playerCoins -= amount;
            updateCoinDisplay();
            
            showNotification(`üí∏ -${amount} moedas! ${reason}`);
            addChatMessage(`üí∏ Gastei ${amount} moedas: ${reason}`, 'self');
            
            console.log(`üí∏ Gasto: -${amount} moedas (${reason}). Total: ${playerCoins}`);
            return true;
        }
        
        // Sistema de b√¥nus di√°rio
        function checkDailyBonus() {
            const today = new Date().toDateString();
            const lastBonus = localStorage.getItem('criminalMinds_lastDailyBonus');
            
            if (lastBonus !== today) {
                localStorage.setItem('criminalMinds_lastDailyBonus', today);
                rewardCoins(100, "B√¥nus di√°rio!");
                showNotification("üéÅ B√¥nus di√°rio coletado! +100 moedas");
            }
        }
        
        // Sistema de recompensas por a√ß√µes
        const coinRewards = {
            cardPlayed: { amount: 8, message: "Carta jogada" },
            combo3: { amount: 25, message: "Combo 3x!" },
            combo5: { amount: 50, message: "Combo 5x!" },
            combo7: { amount: 100, message: "SUPER COMBO 7x!" },
            timeBonus: { amount: 2, message: "B√¥nus de tempo" },
            perfectRound: { amount: 200, message: "Rodada perfeita!" },
            firstWin: { amount: 150, message: "Primeira vit√≥ria!" },
            investigation: { amount: 75, message: "Investiga√ß√£o completa" }
        };
        
        // Sistema de conquistas
        const achievements = {
            firstCard: { 
                reward: 20, 
                message: "Primeira carta jogada!", 
                description: "Bem-vindo ao mundo da investiga√ß√£o!",
                icon: "üéØ",
                type: "bronze",
                completed: false 
            },
            speedPlayer: { 
                reward: 50, 
                message: "5 cartas em 1 minuto!", 
                description: "Velocidade impressionante de investiga√ß√£o",
                icon: "‚ö°",
                type: "silver",
                completed: false 
            },
            comboMaster: { 
                reward: 100, 
                message: "Combo de 10 cartas!", 
                description: "Sequ√™ncia perfeita de evid√™ncias",
                icon: "üî•",
                type: "gold",
                completed: false 
            },
            investigator: { 
                reward: 150, 
                message: "20 cartas jogadas!", 
                description: "Investigador experiente e dedicado",
                icon: "üïµÔ∏è",
                type: "gold",
                completed: false 
            },
            wealthy: { 
                reward: 200, 
                message: "1000 moedas acumuladas!", 
                description: "Riqueza atrav√©s da investiga√ß√£o",
                icon: "üíé",
                type: "rare",
                completed: false 
            }
        };

        // Lista de conquistas recentes para exibi√ß√£o
        let recentAchievements = [];

        // ========================================
        // SISTEMA DE DIFICULDADE DIN√ÇMICA
        // ========================================
        
        let currentDifficulty = 'beginner'; // Padr√£o iniciante
        
        const difficultySettings = {
            beginner: { 
                cards: 6, 
                name: 'Iniciante', 
                color: '#10b981',
                icon: 'üü¢',
                timer: 45 * 60, // 45 minutos
                coinMultiplier: 1.0,
                comboRequirement: 2,
                description: 'Mais tempo, menos cartas, recompensas normais'
            },
            intermediate: { 
                cards: 9, 
                name: 'Intermedi√°rio', 
                color: '#f59e0b',
                icon: 'üü°',
                timer: 45 * 60, // 45 minutos
                coinMultiplier: 1.5,
                comboRequirement: 3,
                description: 'Tempo padr√£o, cartas balanceadas, b√¥nus de 50%'
            },
            hard: { 
                cards: 12, 
                name: 'Dif√≠cil', 
                color: '#ef4444',
                icon: 'üî¥',
                timer: 45 * 60, // 45 minutos
                coinMultiplier: 2.0,
                comboRequirement: 4,
                description: 'Menos tempo, mais cartas, recompensas dobradas'
            }
        };

        // Base de cartas dispon√≠veis
        const cardDatabase = [
            {
                id: 'dna-evidence',
                type: 'Evid√™ncia',
                rarity: 'legendary',
                icon: 'üß¨',
                title: 'DNA do Assassino',
                description: 'Perfil gen√©tico completo que revela a identidade do criminoso. 99.9% de precis√£o.',
                stats: ['‚ö° 95', 'üéØ 100', 'üíé √önica']
            },
            {
                id: 'main-suspect',
                type: 'Suspeito',
                rarity: 'epic',
                icon: 'üë®‚Äçüíº',
                title: 'Marcus Thompson',
                description: 'Ex-marido violento com motivos claros. Hist√≥rico criminal extenso.',
                stats: ['‚ö° 78', 'üéØ 85', 'üîç Perigoso']
            },
            {
                id: 'interrogation',
                type: 'A√ß√£o',
                rarity: 'rare',
                icon: 'üîç',
                title: 'Interrogat√≥rio Intensivo',
                description: 'T√©cnica avan√ßada que for√ßa o suspeito a revelar informa√ß√µes cruciais.',
                stats: ['‚ö° 65', 'üéØ 70', '‚è±Ô∏è 3 min']
            },
            {
                id: 'crime-scene',
                type: 'Local',
                rarity: 'rare',
                icon: 'üè†',
                title: 'Cena do Crime',
                description: 'Apartamento da v√≠tima. M√∫ltiplas evid√™ncias dispon√≠veis para coleta.',
                stats: ['‚ö° 60', 'üéØ 80', 'üîç 5 pistas']
            },
            {
                id: 'forensic-kit',
                type: 'Equipamento',
                rarity: 'epic',
                icon: 'üî¨',
                title: 'Kit Forense Avan√ßado',
                description: 'Equipamento de alta tecnologia para an√°lise instant√¢nea de evid√™ncias.',
                stats: ['‚ö° 85', 'üéØ 90', '‚öóÔ∏è +50% an√°lise']
            },
            {
                id: 'backup-officer',
                type: 'Aliado',
                rarity: 'common',
                icon: 'üëÆ‚Äç‚ôÇÔ∏è',
                title: 'Oficial de Apoio',
                description: 'Policial experiente que oferece suporte durante a investiga√ß√£o.',
                stats: ['‚ö° 45', 'üéØ 55', 'üõ°Ô∏è Prote√ß√£o']
            },
            {
                id: 'witness-testimony',
                type: 'Evid√™ncia',
                rarity: 'common',
                icon: 'üëÅÔ∏è',
                title: 'Testemunha Ocular',
                description: 'Relato detalhado de uma testemunha que viu o suspeito no local.',
                stats: ['‚ö° 40', 'üéØ 60', 'üë• Confi√°vel']
            },
            {
                id: 'security-camera',
                type: 'Equipamento',
                rarity: 'rare',
                icon: 'üìπ',
                title: 'C√¢mera de Seguran√ßa',
                description: 'Grava√ß√£o de alta resolu√ß√£o que capturou o momento do crime.',
                stats: ['‚ö° 70', 'üéØ 85', 'üì± HD']
            },
            {
                id: 'phone-records',
                type: 'Evid√™ncia',
                rarity: 'common',
                icon: 'üì±',
                title: 'Registros Telef√¥nicos',
                description: 'Hist√≥rico de chamadas que revela conex√µes suspeitas.',
                stats: ['‚ö° 35', 'üéØ 50', 'üìä Dados']
            },
            {
                id: 'ballistics-report',
                type: 'Evid√™ncia',
                rarity: 'epic',
                icon: 'üéØ',
                title: 'Relat√≥rio Bal√≠stico',
                description: 'An√°lise completa da arma e trajet√≥ria dos proj√©teis.',
                stats: ['‚ö° 80', 'üéØ 95', 'üî´ Preciso']
            },
            {
                id: 'psychological-profile',
                type: 'A√ß√£o',
                rarity: 'rare',
                icon: 'üß†',
                title: 'Perfil Psicol√≥gico',
                description: 'An√°lise comportamental detalhada do suspeito.',
                stats: ['‚ö° 55', 'üéØ 75', 'üß† Insight']
            },
            {
                id: 'search-warrant',
                type: 'A√ß√£o',
                rarity: 'common',
                icon: 'üìú',
                title: 'Mandado de Busca',
                description: 'Autoriza√ß√£o legal para busca e apreens√£o de evid√™ncias.',
                stats: ['‚ö° 30', 'üéØ 40', '‚öñÔ∏è Legal']
            }
        ];



        // Fun√ß√£o para aplicar configura√ß√µes de dificuldade
        function applyDifficultySettings(difficultyConfig) {
            // Atualizar timer baseado na dificuldade
            gameTime = difficultyConfig.timer;
            difficultyMultiplier = difficultyConfig.coinMultiplier;
            
            console.log(`üéØ Aplicando configura√ß√µes de dificuldade: ${difficultyConfig.name}`);
            console.log(`‚è±Ô∏è Timer definido para: ${Math.floor(gameTime / 60)}:${(gameTime % 60).toString().padStart(2, '0')}`);
            console.log(`üí∞ Multiplicador de moedas: ${difficultyMultiplier}x`);
            
            // Atualizar display do header com informa√ß√µes da dificuldade
            updateDifficultyHeader(difficultyConfig);
            
            // Aplicar cor tem√°tica da dificuldade
            applyDifficultyTheme(difficultyConfig);
        }
        
        function updateDifficultyHeader(difficultyConfig) {
            // Atualizar t√≠tulo do caso com indicador de dificuldade
            const caseTitle = document.querySelector('.case-title');
            if (caseTitle) {
                caseTitle.innerHTML = `${difficultyConfig.icon} CRIMINAL MINDS: ${difficultyConfig.name.toUpperCase()}`;
                caseTitle.style.color = difficultyConfig.color;
            }
            
            // Atualizar timer com cor da dificuldade
            const timer = document.getElementById('gameTimer');
            if (timer) {
                timer.style.borderColor = difficultyConfig.color;
                timer.style.boxShadow = `0 0 15px ${difficultyConfig.color}40`;
            }
            
            // Atualizar indicador de dificuldade na sidebar
            updateDifficultyIndicator(difficultyConfig);
        }
        
        function updateDifficultyIndicator(difficultyConfig) {
            const indicator = document.getElementById('difficultyIndicator');
            const icon = document.getElementById('difficultyIcon');
            const name = document.getElementById('difficultyName');
            const description = document.getElementById('difficultyDescription');
            const multiplier = document.getElementById('currentMultiplier');
            
            if (indicator) {
                indicator.style.background = `linear-gradient(135deg, ${difficultyConfig.color}20, ${difficultyConfig.color}10)`;
                indicator.style.borderColor = difficultyConfig.color;
                indicator.style.boxShadow = `0 4px 15px ${difficultyConfig.color}40`;
            }
            
            if (icon) icon.textContent = difficultyConfig.icon;
            if (name) {
                name.textContent = difficultyConfig.name.toUpperCase();
                name.style.color = difficultyConfig.color;
            }
            if (description) description.textContent = difficultyConfig.description;
            if (multiplier) multiplier.textContent = `${difficultyConfig.coinMultiplier}x`;
        }
        
        function applyDifficultyTheme(difficultyConfig) {
            // Aplicar cor tem√°tica aos elementos principais
            const root = document.documentElement;
            root.style.setProperty('--difficulty-color', difficultyConfig.color);
            root.style.setProperty('--difficulty-glow', `${difficultyConfig.color}40`);
            
            // Atualizar bordas dos containers principais
            const mainArea = document.querySelector('.main-area');
            if (mainArea) {
                mainArea.style.borderColor = `${difficultyConfig.color}60`;
            }
            
            const sidebar = document.querySelector('.sidebar');
            if (sidebar) {
                sidebar.style.borderColor = `${difficultyConfig.color}40`;
            }
        }

        function generateCards() {
            const container = document.getElementById('cardsContainer');
            if (!container) return;
            
            // Obter dificuldade da URL ou usar padr√£o
            const urlParams = new URLSearchParams(window.location.search);
            const difficultyFromUrl = urlParams.get('difficulty') || 'easy';
            
            console.log(`üîç URL atual: ${window.location.href}`);
            console.log(`üéØ Dificuldade da URL: ${difficultyFromUrl}`);
            
            // Mapear dificuldades da URL para as configura√ß√µes existentes
            const difficultyMap = {
                'easy': 'beginner',
                'medium': 'intermediate', 
                'hard': 'hard'
            };
            
            const mappedDifficulty = difficultyMap[difficultyFromUrl] || 'intermediate';
            const difficultyConfig = difficultySettings[mappedDifficulty];
            const numCards = difficultyConfig.cards;
            
            console.log(`üó∫Ô∏è Dificuldade mapeada: ${mappedDifficulty}`);
            console.log(`üÉè N√∫mero de cartas: ${numCards}`);
            console.log(`‚è±Ô∏è Timer: ${Math.floor(difficultyConfig.timer / 60)} minutos`);
            console.log(`üí∞ Multiplicador de moedas: ${difficultyConfig.coinMultiplier}x`);
            
            // Atualizar vari√°vel global de dificuldade
            currentDifficulty = mappedDifficulty;
            
            // Aplicar configura√ß√µes de dificuldade
            applyDifficultySettings(difficultyConfig);
            
            // Atualizar display da dificuldade atual
            updateCurrentDifficultyDisplay(difficultyFromUrl);
            
            // Limpar cartas existentes
            container.innerHTML = '';
            
            // Aplicar classe CSS baseada na dificuldade
            container.className = `cards-container ${mappedDifficulty}`;
            
            console.log(`üé® Aplicando classe CSS: cards-container ${mappedDifficulty}`);
            
            // Embaralhar e selecionar cartas
            const shuffledCards = [...cardDatabase].sort(() => Math.random() - 0.5);
            const selectedCards = shuffledCards.slice(0, numCards);
            
            console.log(`üÉè Cartas selecionadas: ${selectedCards.length} de ${cardDatabase.length} dispon√≠veis`);
            
            // Gerar HTML para cada carta
            selectedCards.forEach((cardData, index) => {
                const cardElement = createCardElement(cardData);
                container.appendChild(cardElement);
                
                // Anima√ß√£o escalonada
                setTimeout(() => {
                    cardElement.style.opacity = '1';
                    cardElement.style.transform = 'translateY(0)';
                }, index * 100);
            });
            
            console.log(`üéØ Geradas ${numCards} cartas para dificuldade ${currentDifficulty}`);
        }

        function createCardElement(cardData) {
            const card = document.createElement('div');
            card.className = `card ${cardData.rarity}`;
            card.onclick = () => playCard(cardData.id);
            
            // Iniciar invis√≠vel para anima√ß√£o
            card.style.opacity = '0';
            card.style.transform = 'translateY(20px)';
            card.style.transition = 'all 0.5s ease-out';
            
            card.innerHTML = `
                <div class="card-inner">
                    <div class="card-header">
                        <span class="card-type">${cardData.type}</span>
                        <span class="card-rarity rarity-${cardData.rarity}">${getRarityName(cardData.rarity)}</span>
                    </div>
                    <div class="card-icon">${cardData.icon}</div>
                    <div class="card-title">${cardData.title}</div>
                    <div class="card-description">${cardData.description}</div>
                    <div class="card-stats">
                        ${cardData.stats.map(stat => `<div class="stat">${stat}</div>`).join('')}
                    </div>
                </div>
            `;
            
            return card;
        }

        function getRarityName(rarity) {
            const rarityNames = {
                common: 'Comum',
                rare: 'Rara',
                epic: '√âpica',
                legendary: 'Lend√°ria'
            };
            return rarityNames[rarity] || 'Comum';
        }
        
        function checkAchievements() {
            // Primeira carta
            if (!achievements.firstCard.completed && cardsPlayed === 1) {
                unlockAchievement('firstCard');
            }
            
            // 20 cartas jogadas
            if (!achievements.investigator.completed && cardsPlayed >= 20) {
                unlockAchievement('investigator');
            }
            
            // Combo master
            if (!achievements.comboMaster.completed && comboStreak >= 10) {
                unlockAchievement('comboMaster');
            }
            
            // Wealthy
            if (!achievements.wealthy.completed && playerCoins >= 1000) {
                unlockAchievement('wealthy');
            }
        }
        
        function unlockAchievement(achievementId) {
            const achievement = achievements[achievementId];
            if (achievement && !achievement.completed) {
                achievement.completed = true;
                
                // Adicionar √† lista de conquistas recentes
                const achievementData = {
                    id: achievementId,
                    ...achievement,
                    timestamp: new Date().toLocaleTimeString('pt-BR', { 
                        hour: '2-digit', 
                        minute: '2-digit' 
                    })
                };
                
                recentAchievements.unshift(achievementData);
                
                // Manter apenas as 5 conquistas mais recentes
                if (recentAchievements.length > 5) {
                    recentAchievements = recentAchievements.slice(0, 5);
                }
                
                // Atualizar display de conquistas
                updateAchievementsDisplay();
                
                // Recompensa e feedback
                rewardCoins(achievement.reward, `üèÜ CONQUISTA: ${achievement.message}`);
                
                // Salvar conquistas
                localStorage.setItem('criminalMinds_achievements', JSON.stringify(achievements));
                localStorage.setItem('criminalMinds_recentAchievements', JSON.stringify(recentAchievements));
                
                // Efeito especial
                showNotification(`üèÜ CONQUISTA DESBLOQUEADA!\n${achievement.message}\n+${achievement.reward} moedas!`);
                
                // Efeito visual especial na conquista
                setTimeout(() => {
                    const achievementElement = document.querySelector(`[data-achievement-id="${achievementId}"]`);
                    if (achievementElement) {
                        achievementElement.style.animation = 'none';
                        achievementElement.offsetHeight; // Trigger reflow
                        achievementElement.style.animation = 'achievementSlideIn 0.6s ease-out';
                    }
                }, 100);
            }
        }
        
        function loadAchievements() {
            const saved = localStorage.getItem('criminalMinds_achievements');
            if (saved) {
                const savedAchievements = JSON.parse(saved);
                Object.assign(achievements, savedAchievements);
            }
            
            const savedRecent = localStorage.getItem('criminalMinds_recentAchievements');
            if (savedRecent) {
                recentAchievements = JSON.parse(savedRecent);
            }
            
            // Atualizar display inicial
            updateAchievementsDisplay();
        }

        function updateAchievementsDisplay() {
            const container = document.getElementById('achievements-container');
            const noAchievements = document.getElementById('no-achievements');
            
            if (!container) return;
            
            if (recentAchievements.length === 0) {
                if (noAchievements) {
                    noAchievements.style.display = 'block';
                }
                // Limpar conquistas existentes
                const existingAchievements = container.querySelectorAll('.achievement-item');
                existingAchievements.forEach(item => item.remove());
                return;
            }
            
            // Ocultar mensagem "sem conquistas"
            if (noAchievements) {
                noAchievements.style.display = 'none';
            }
            
            // Limpar conquistas existentes
            const existingAchievements = container.querySelectorAll('.achievement-item');
            existingAchievements.forEach(item => item.remove());
            
            // Adicionar conquistas recentes
            recentAchievements.forEach((achievement, index) => {
                const achievementElement = createAchievementElement(achievement);
                container.appendChild(achievementElement);
                
                // Anima√ß√£o escalonada para m√∫ltiplas conquistas
                setTimeout(() => {
                    achievementElement.style.opacity = '1';
                    achievementElement.style.transform = 'translateX(0)';
                }, index * 100);
            });
        }

        function createAchievementElement(achievement) {
            const element = document.createElement('div');
            element.className = `achievement-item ${achievement.type}`;
            element.setAttribute('data-achievement-id', achievement.id);
            
            element.innerHTML = `
                <div class="achievement-reward">+${achievement.reward} üí∞</div>
                <div style="display: flex; align-items: flex-start;">
                    <span class="achievement-icon">${achievement.icon}</span>
                    <div style="flex: 1;">
                        <div class="achievement-title">${achievement.message}</div>
                        <div class="achievement-description">${achievement.description}</div>
                        <div class="achievement-timestamp">Desbloqueada √†s ${achievement.timestamp}</div>
                    </div>
                </div>
            `;
            
            // Iniciar invis√≠vel para anima√ß√£o
            element.style.opacity = '0';
            element.style.transform = 'translateX(-20px)';
            
            return element;
        }
        
        // ========================================
        // FUN√á√ïES DE ESTAT√çSTICAS POR DIFICULDADE
        // ========================================
        
        function updateCurrentDifficultyDisplay(difficulty) {
            const difficultyNames = {
                'easy': 'Iniciante',
                'medium': 'Intermedi√°rio',
                'hard': 'Dif√≠cil'
            };
            
            const currentDifficultyElement = document.getElementById('currentDifficulty');
            if (currentDifficultyElement) {
                currentDifficultyElement.textContent = difficultyNames[difficulty] || 'Intermedi√°rio';
            }
        }
        
        function loadDifficultyStats() {
            // Simular carregamento de estat√≠sticas (em produ√ß√£o viria da API)
            const mockStats = {
                easy: {
                    gamesPlayed: 5,
                    gamesWon: 4,
                    winRate: '80.0',
                    bestTimeFormatted: '3:45'
                },
                medium: {
                    gamesPlayed: 12,
                    gamesWon: 8,
                    winRate: '66.7',
                    bestTimeFormatted: '5:22'
                },
                hard: {
                    gamesPlayed: 3,
                    gamesWon: 1,
                    winRate: '33.3',
                    bestTimeFormatted: '8:15'
                }
            };
            
            updateDifficultyStatsDisplay(mockStats);
        }
        
        function updateDifficultyStatsDisplay(stats) {
            // Atualizar Iniciante
            document.getElementById('easyWinRate').textContent = stats.easy.winRate + '%';
            document.getElementById('easyStats').textContent = `${stats.easy.gamesWon}/${stats.easy.gamesPlayed} jogos`;
            document.getElementById('easyBestTime').textContent = stats.easy.bestTimeFormatted;
            
            // Atualizar Intermedi√°rio
            document.getElementById('mediumWinRate').textContent = stats.medium.winRate + '%';
            document.getElementById('mediumStats').textContent = `${stats.medium.gamesWon}/${stats.medium.gamesPlayed} jogos`;
            document.getElementById('mediumBestTime').textContent = stats.medium.bestTimeFormatted;
            
            // Atualizar Dif√≠cil
            document.getElementById('hardWinRate').textContent = stats.hard.winRate + '%';
            document.getElementById('hardStats').textContent = `${stats.hard.gamesWon}/${stats.hard.gamesPlayed} jogos`;
            document.getElementById('hardBestTime').textContent = stats.hard.bestTimeFormatted;
        }
        
        function startTimer() {
            // Carregar conquistas salvas
            loadAchievements();
            
            // Carregar estat√≠sticas por dificuldade
            loadDifficultyStats();

            // FOR√áAR REMO√á√ÉO DA SE√á√ÉO MINHA M√ÉO
            function removeHandSection() {
                const selectors = [
                    '.deck-area',
                    '.hand-cards', 
                    '.mini-card',
                    '[class*="hand"]',
                    '[id*="hand"]',
                    '[class*="mao"]',
                    '[id*="mao"]',
                    '[class*="deck"]',
                    '[id*="deck"]'
                ];
                
                selectors.forEach(selector => {
                    const elements = document.querySelectorAll(selector);
                    elements.forEach(el => {
                        if (!el.closest('.main-area')) { // N√£o remover cartas da √°rea principal
                            el.remove();
                        }
                    });
                });
            }
            
            // Remover imediatamente e depois de 1 segundo
            removeHandSection();
            setTimeout(removeHandSection, 1000);
            
            // Gerar cartas iniciais
            generateCards();
            
            // Verificar b√¥nus di√°rio ao iniciar
            checkDailyBonus();
            
            // Atualizar display inicial de moedas
            updateCoinDisplay();
            
            const timer = setInterval(() => {
                const minutes = Math.floor(gameTime / 60);
                const seconds = gameTime % 60;
                const timerEl = document.getElementById('gameTimer');
                if (timerEl) {
                    timerEl.textContent = `‚è±Ô∏è ${minutes}:${seconds.toString().padStart(2, '0')}`;
                }
                
                // B√¥nus por tempo (a cada minuto)
                if (gameTime % 60 === 0 && gameTime > 0) {
                    rewardCoins(coinRewards.timeBonus.amount, coinRewards.timeBonus.message);
                }
                
                if (gameTime <= 0) {
                    clearInterval(timer);
                    
                    // B√¥nus final baseado no desempenho
                    calculateFinalRewards();
                    
                    // Mostrar resultado final
                    showGameEndModal('timeout');
                }
                gameTime--;
            }, 1000);
        }

        function calculateFinalRewards() {
            let finalBonus = 0;
            let reasons = [];
            
            // B√¥nus por cartas jogadas
            if (cardsPlayed >= 10) {
                finalBonus += 50;
                reasons.push("10+ cartas jogadas");
            }
            
            // B√¥nus por combo streak
            if (comboStreak >= 5) {
                finalBonus += coinRewards.combo5.amount;
                reasons.push("Combo 5x mantido");
            }
            
            // B√¥nus de conclus√£o
            finalBonus += coinRewards.investigation.amount;
            reasons.push("Investiga√ß√£o conclu√≠da");
            
            if (finalBonus > 0) {
                rewardCoins(finalBonus, reasons.join(", "));
            }
        }

        startTimer();

        // Sistema de cartas
        function playCard(cardId) {
            const cardElement = event.currentTarget;
            
            // Anima√ß√£o de uso da carta
            cardElement.style.transform = 'scale(1.1) rotateY(180deg)';
            cardElement.style.opacity = '0.7';
            
            setTimeout(() => {
                cardElement.style.transform = 'scale(1) rotateY(0deg)';
                cardElement.style.opacity = '1';
            }, 800);

            // Processar efeito da carta
            const cardEffects = {
                'dna-evidence': {
                    title: 'üß¨ DNA do Assassino Analisado!',
                    effect: 'Revelou a identidade do assassino! +95 pontos de investiga√ß√£o.',
                    sound: 'üî¨ *Som de an√°lise de laborat√≥rio*'
                },
                'main-suspect': {
                    title: 'üë®‚Äçüíº Suspeito Principal Identificado!',
                    effect: 'Marcus Thompson confirmado como suspeito principal! +78 pontos.',
                    sound: 'üö® *Som de sirene*'
                },
                'interrogation': {
                    title: 'üîç Interrogat√≥rio Bem-sucedido!',
                    effect: 'Suspeito revelou informa√ß√µes cruciais! +65 pontos.',
                    sound: 'üé§ *Som de grava√ß√£o*'
                },
                'crime-scene': {
                    title: 'üè† Cena do Crime Investigada!',
                    effect: 'Novas evid√™ncias coletadas! +60 pontos.',
                    sound: 'üì∏ *Som de c√¢mera*'
                },
                'forensic-kit': {
                    title: 'üî¨ Kit Forense Ativado!',
                    effect: 'Velocidade de an√°lise aumentada em 50%! +85 pontos.',
                    sound: '‚öóÔ∏è *Som de equipamento cient√≠fico*'
                },
                'backup-officer': {
                    title: 'üëÆ‚Äç‚ôÇÔ∏è Refor√ßo Chegou!',
                    effect: 'Seguran√ßa aumentada! +45 pontos.',
                    sound: 'üöì *Som de viatura*'
                }
            };

            const effect = cardEffects[cardId] || {
                title: 'üÉè Carta Jogada!',
                effect: 'Efeito ativado com sucesso!',
                sound: '‚ú® *Som m√°gico*'
            };

            // Mostrar efeito
            showCardEffect(effect);
            
            // Recompensa base por jogar carta
            rewardCoins(coinRewards.cardPlayed.amount, coinRewards.cardPlayed.message);
            
            // B√¥nus espec√≠fico por tipo de carta
            const cardBonuses = {
                'dna-evidence': 15,
                'main-suspect': 12,
                'interrogation': 10,
                'crime-scene': 8,
                'forensic-kit': 14,
                'backup-officer': 6
            };
            
            if (cardBonuses[cardId]) {
                rewardCoins(cardBonuses[cardId], `B√¥nus da carta ${effect.title}`);
            }
            
            // Atualizar estat√≠sticas
            cardsPlayed++;
            comboStreak++;
            
            // Sistema de recompensas por combo
            if (comboStreak === 3) {
                rewardCoins(coinRewards.combo3.amount, coinRewards.combo3.message);
            } else if (comboStreak === 5) {
                rewardCoins(coinRewards.combo5.amount, coinRewards.combo5.message);
            } else if (comboStreak >= 7) {
                rewardCoins(coinRewards.combo7.amount, coinRewards.combo7.message);
            }
            
            updateStats();
            
            // Verificar conquistas
            checkAchievements();
            
            // Adicionar mensagem no chat
            addChatMessage(`üé¥ Jogou: ${effect.title}`, 'self');
        }

        function playFromHand(cardId) {
            const handCards = {
                'witness': 'üëÅÔ∏è Testemunha interrogada! Obteve informa√ß√µes valiosas.',
                'phone-data': 'üì± Dados do celular analisados! √öltimas chamadas reveladas.',
                'ballistics': 'üéØ An√°lise bal√≠stica completa! Trajet√≥ria confirmada.',
                'surveillance': 'üìπ C√¢meras revisadas! Suspeito identificado.',
                'profile': 'üß† Perfil psicol√≥gico atualizado! Padr√£o comportamental detectado.',
                'warrant': 'üìú Mandado executado! Evid√™ncias legalmente obtidas.'
            };

            const effect = handCards[cardId] || 'Carta da m√£o jogada!';

            // Remover carta da m√£o (efeito visual)
            event.currentTarget.style.animation = 'cardAppear 0.5s ease-out reverse';
            setTimeout(() => {
                event.currentTarget.style.opacity = '0.3';
                event.currentTarget.style.pointerEvents = 'none';
            }, 500);
            
            // Recompensa por jogar carta da m√£o (b√¥nus extra)
            rewardCoins(coinRewards.cardPlayed.amount + 3, "Carta da m√£o jogada");
            
            showNotification(effect);
            addChatMessage(`üÉè Da m√£o: ${effect}`, 'self');

            // Atualizar estat√≠sticas
            cardsPlayed++;
            comboStreak++;
            
            // Sistema de recompensas por combo (tamb√©m para cartas da m√£o)
            if (comboStreak === 3) {
                rewardCoins(coinRewards.combo3.amount, coinRewards.combo3.message);
            } else if (comboStreak === 5) {
                rewardCoins(coinRewards.combo5.amount, coinRewards.combo5.message);
            } else if (comboStreak >= 7) {
                rewardCoins(coinRewards.combo7.amount, coinRewards.combo7.message);
            }
            
            updateStats();
            
            // Verificar conquistas
            checkAchievements();
        }

        function showCardEffect(effect) {
            // Criar popup de efeito da carta
            const popup = document.createElement('div');
            popup.style.cssText = `
                position: fixed;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                background: linear-gradient(135deg, #1a1a2e, #16213e);
                border: 3px solid #fbbf24;
                border-radius: 20px;
                padding: 2rem;
                z-index: 3000;
                text-align: center;
                box-shadow: 0 20px 60px rgba(0, 0, 0, 0.8);
                animation: cardAppear 0.6s ease-out;
            `;
            
            popup.innerHTML = `
                <h3 style="color: #fbbf24; margin-bottom: 1rem; font-size: 1.5rem;">${effect.title}</h3>
                <p style="color: #cbd5e1; margin-bottom: 1rem; font-size: 1.1rem;">${effect.effect}</p>
                <p style="color: #6b7280; font-style: italic;">${effect.sound}</p>
                <button class="btn" onclick="this.parentElement.remove()" style="margin-top: 1.5rem;">‚ú® Continuar</button>
            `;
            
            document.body.appendChild(popup);
            
            // Remover automaticamente ap√≥s 5 segundos
            setTimeout(() => {
                if (popup.parentElement) {
                    popup.remove();
                }
            }, 5000);
        }

        function showNotification(message) {
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: linear-gradient(135deg, #fbbf24, #f59e0b);
                color: #0f0f23;
                padding: 1rem 1.5rem;
                border-radius: 12px;
                font-weight: 600;
                z-index: 2000;
                box-shadow: 0 10px 30px rgba(251, 191, 36, 0.4);
                animation: cardAppear 0.5s ease-out;
            `;
            notification.textContent = message;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.animation = 'cardAppear 0.5s ease-out reverse';
                setTimeout(() => notification.remove(), 500);
            }, 3000);
        }

        function updateStats() {
            // Atualizar barras de progresso
            const cardsProgress = (cardsPlayed / 20) * 100;
            document.querySelector('.progress-fill').style.width = `${Math.min(cardsProgress, 100)}%`;
            
            // Atualizar combo streak
            const comboProgress = (comboStreak / 10) * 100;
            document.querySelectorAll('.progress-fill')[1].style.width = `${Math.min(comboProgress, 100)}%`;
        }

        // Fun√ß√µes do deck
        function drawCard() {
            const newCards = [
                'üîç Lupa M√°gica',
                'üìã Relat√≥rio Forense',
                'üé≠ Disfarce',
                'üí° Inspira√ß√£o',
                'üîê Chave Mestra'
            ];
            
            const randomCard = newCards[Math.floor(Math.random() * newCards.length)];
            showNotification(`üé¥ Nova carta: ${randomCard}`);
            addChatMessage(`üé¥ Comprei: ${randomCard}`, 'self');
        }

        function shuffleDeck() {
            showNotification('üîÄ Deck embaralhado! Novas possibilidades dispon√≠veis.');
            addChatMessage('üîÄ Embaralhei meu deck', 'self');
        }

        function useCombo() {
            if (comboStreak >= 3) {
                // Recompensa baseada no n√≠vel do combo
                let comboReward = 0;
                let comboMessage = '';
                
                if (comboStreak >= 7) {
                    comboReward = coinRewards.combo7.amount;
                    comboMessage = coinRewards.combo7.message;
                } else if (comboStreak >= 5) {
                    comboReward = coinRewards.combo5.amount;
                    comboMessage = coinRewards.combo5.message;
                } else {
                    comboReward = coinRewards.combo3.amount;
                    comboMessage = coinRewards.combo3.message;
                }
                
                // B√¥nus extra por usar combo manualmente
                comboReward += 25;
                
                rewardCoins(comboReward, `${comboMessage} (Ativa√ß√£o manual)`);
                showNotification(`‚ö° COMBO ATIVADO! +${comboReward} moedas!`);
                addChatMessage(`‚ö° Usei combo devastador! +${comboReward} moedas`, 'self');
                
                comboStreak = 0;
                updateStats();
            } else {
                showNotification('‚ùå Combo insuficiente. Precisa de pelo menos 3 cartas em sequ√™ncia.');
            }
        }

        // Loja de cartas
        function buyPack(packType) {
            const packs = {
                'basic': { cost: 100, cards: 3, rares: 0 },
                'premium': { cost: 250, cards: 5, rares: 1 },
                'legendary': { cost: 500, cards: 8, rares: 3 }
            };
            
            const pack = packs[packType];
            
            if (spendCoins(pack.cost, `Pacote ${packType}`)) {
                showNotification(`üì¶ Pacote ${packType} comprado! ${pack.cards} cartas obtidas!`);
                addChatMessage(`üí∞ Comprei pacote ${packType}! ${pack.cards} novas cartas`, 'self');
                
                // Simular abertura de pacote com poss√≠vel moeda b√¥nus
                if (packType === 'legendary' && Math.random() < 0.3) {
                    rewardCoins(50, "Carta rara encontrada no pacote!");
                }
            } else {
                showNotification(`‚ùå Moedas insuficientes! Voc√™ tem ${playerCoins}, precisa de ${pack.cost}.`);
            }
        }

        // Chat com feedback visual
        function sendMessage() {
            const input = document.getElementById('chatInput');
            const sendButton = document.querySelector('.send-button');
            const message = input.value.trim();
            
            if (message) {
                // Feedback visual no bot√£o
                sendButton.style.transform = 'scale(0.95)';
                sendButton.innerHTML = '<span class="send-button-text">Enviando...</span><span class="send-button-icon">‚è≥</span><div class="send-button-ripple"></div>';
                sendButton.disabled = true;
                sendButton.classList.add('highlight');
                
                // Feedback visual no input
                input.style.borderColor = '#10b981';
                input.style.boxShadow = '0 0 20px rgba(16, 185, 129, 0.4)';
                
                setTimeout(() => {
                    // Restaurar bot√£o
                    sendButton.innerHTML = '<span class="send-button-text">Enviar</span><span class="send-button-icon">üì§</span><div class="send-button-ripple"></div>';
                    sendButton.disabled = false;
                    sendButton.style.transform = '';
                    sendButton.classList.remove('highlight');
                    
                    // Restaurar input
                    input.style.borderColor = '';
                    input.style.boxShadow = '';
                    
                    // Adicionar mensagem
                    addChatMessage(message, 'self');
                    input.value = '';
                    
                    // Efeito de sucesso
                    showMessageSuccess();
                    
                }, 300);
                
                // Simular resposta da equipe
                setTimeout(() => {
                    const responses = [
                        "Excelente estrat√©gia de cartas! üé¥",
                        "Que combo incr√≠vel! üî•",
                        "Suas cartas est√£o muito fortes hoje! üí™",
                        "Boa jogada! Continue assim! ‚ö°",
                        "Impressionante cole√ß√£o de cartas! üåü"
                    ];
                    const randomResponse = responses[Math.floor(Math.random() * responses.length)];
                    addChatMessage(randomResponse, 'üîç Morgan');
                }, 2300);
            } else {
                // Feedback para mensagem vazia
                input.style.borderColor = '#ef4444';
                input.style.boxShadow = '0 0 20px rgba(239, 68, 68, 0.4)';
                input.placeholder = 'Digite algo antes de enviar...';
                
                setTimeout(() => {
                    input.style.borderColor = '';
                    input.style.boxShadow = '';
                    input.placeholder = 'Digite sua mensagem...';
                }, 2000);
            }
        }
        
        function showMessageSuccess() {
            const success = document.createElement('div');
            success.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: linear-gradient(135deg, #10b981, #059669);
                color: white;
                padding: 0.8rem 1.5rem;
                border-radius: 12px;
                font-weight: 600;
                z-index: 3000;
                box-shadow: 0 10px 30px rgba(16, 185, 129, 0.4);
                animation: slideIn 0.3s ease-out;
            `;
            success.innerHTML = '‚úÖ Mensagem enviada!';
            
            document.body.appendChild(success);
            
            setTimeout(() => {
                success.style.animation = 'slideIn 0.3s ease-out reverse';
                setTimeout(() => success.remove(), 300);
            }, 2000);
        }

        function addChatMessage(message, sender) {
            const chatContainer = document.getElementById('chatContainer');
            if (!chatContainer) {
                console.warn('‚ö†Ô∏è chatContainer n√£o encontrado. Mensagem ignorada:', message);
                return;
            }
            const userName = sender === 'self' ? (localStorage.getItem('detectiveName') || 'Detetive') : sender;
            const messageDiv = document.createElement('div');
            messageDiv.className = 'chat-message';
            messageDiv.innerHTML = `<span class="chat-user">${sender === 'self' ? 'üïµÔ∏è' : ''} ${userName}:</span> ${message}`;
            chatContainer.appendChild(messageDiv);
            chatContainer.scrollTop = chatContainer.scrollHeight;
        }

        // Enter para enviar mensagem e destacar bot√£o
        document.getElementById('chatInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                sendMessage();
            }
        });

        // Destacar bot√£o quando usu√°rio est√° digitando
        document.getElementById('chatInput').addEventListener('input', function(e) {
            const sendButton = document.querySelector('.send-button');
            const value = e.target.value.trim();
            
            if (value.length > 0) {
                sendButton.classList.add('highlight');
            } else {
                sendButton.classList.remove('highlight');
            }
        });

        // Adicionar contador de caracteres visual
        document.getElementById('chatInput').addEventListener('input', function(e) {
            const maxLength = parseInt(e.target.getAttribute('maxlength'));
            const currentLength = e.target.value.length;
            const remaining = maxLength - currentLength;
            
            // Mudar cor do placeholder baseado no limite
            if (remaining < 20) {
                e.target.style.color = '#ef4444';
            } else if (remaining < 50) {
                e.target.style.color = '#f59e0b';
            } else {
                e.target.style.color = 'white';
            }
        });

        // Modais
        function openDeck() {
            alert('üÉè Sistema de deck em desenvolvimento! Em breve voc√™ poder√° personalizar completamente seu baralho.');
        }

        function showCollection() {
            document.getElementById('collectionModal').style.display = 'block';
        }

        function makeAccusation() {
            const confirmAccusation = confirm('‚öñÔ∏è Tem certeza que deseja fazer sua acusa√ß√£o final?\n\nüÉè Suas cartas jogadas determinar√£o o resultado.\n\n‚úÖ Clique OK para fazer a acusa√ß√£o\n‚ùå Clique Cancelar para continuar investigando');
            
            if (confirmAccusation) {
                // Calcular resultado baseado nas cartas jogadas
                const success = Math.random() > 0.5; // Simula√ß√£o simples (50% chance)
                
                // B√¥nus final baseado no desempenho
                calculateFinalRewards();
                
                // Mostrar resultado final
                showGameEndModal(success ? 'win' : 'lose');
            }
        }

        // Fun√ß√£o para mostrar modal de fim de jogo
        function showGameEndModal(result) {
            let title, message, icon, color;
            
            switch(result) {
                case 'win':
                    title = 'üéâ CASO RESOLVIDO!';
                    message = 'Parab√©ns! Voc√™ desvendou o mist√©rio e capturou o criminoso!';
                    icon = 'üèÜ';
                    color = '#10b981';
                    break;
                case 'lose':
                    title = '‚ùå CASO ARQUIVADO';
                    message = 'Sua acusa√ß√£o estava incorreta. O criminoso escapou desta vez...';
                    icon = 'üíî';
                    color = '#ef4444';
                    break;
                case 'timeout':
                    title = '‚è∞ TEMPO ESGOTADO';
                    message = 'O tempo acabou! O caso foi encerrado sem solu√ß√£o definitiva.';
                    icon = '‚åõ';
                    color = '#f59e0b';
                    break;
                default:
                    title = 'üèÅ FIM DE JOGO';
                    message = 'A investiga√ß√£o chegou ao fim.';
                    icon = 'üéÆ';
                    color = '#6b7280';
            }
            
            // Salvar progresso e estat√≠sticas
            const gameData = {
                result: result,
                cardsPlayed: cardsPlayed,
                comboStreak: comboStreak,
                playerCoins: playerCoins,
                timeRemaining: gameTime,
                endTime: new Date().toISOString()
            };
            
            localStorage.setItem('criminalMinds_lastGameResult', JSON.stringify(gameData));
            
            // Criar modal de resultado
            const resultModal = document.createElement('div');
            resultModal.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0, 0, 0, 0.9);
                display: flex;
                justify-content: center;
                align-items: center;
                z-index: 5000;
            `;
            
            const modalContent = document.createElement('div');
            modalContent.style.cssText = `
                background: linear-gradient(135deg, #1a1a2e, #16213e);
                border: 3px solid ${color};
                border-radius: 25px;
                padding: 3rem;
                text-align: center;
                max-width: 500px;
                width: 90%;
                box-shadow: 0 30px 80px rgba(0, 0, 0, 0.8);
                animation: modalSlideIn 0.5s ease-out;
            `;
            
            modalContent.innerHTML = `
                <div style="font-size: 4rem; margin-bottom: 1rem;">${icon}</div>
                <h2 style="color: ${color}; font-size: 2rem; margin-bottom: 1rem;">${title}</h2>
                <p style="color: #cbd5e1; font-size: 1.1rem; margin-bottom: 2rem; line-height: 1.6;">${message}</p>
                
                <div style="background: rgba(0, 0, 0, 0.3); border-radius: 15px; padding: 1.5rem; margin-bottom: 2rem;">
                    <h3 style="color: #fbbf24; margin-bottom: 1rem;">üìä Resumo da Investiga√ß√£o</h3>
                    <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 1rem; font-size: 0.9rem;">
                        <div style="color: #94a3b8;">üÉè Cartas Jogadas: <span style="color: #fbbf24; font-weight: bold;">${cardsPlayed}</span></div>
                        <div style="color: #94a3b8;">‚ö° Combo M√°ximo: <span style="color: #fbbf24; font-weight: bold;">${comboStreak}x</span></div>
                        <div style="color: #94a3b8;">üí∞ Moedas Ganhas: <span style="color: #fbbf24; font-weight: bold;">${playerCoins}</span></div>
                        <div style="color: #94a3b8;">‚è±Ô∏è Tempo Restante: <span style="color: #fbbf24; font-weight: bold;">${Math.floor(gameTime / 60)}:${(gameTime % 60).toString().padStart(2, '0')}</span></div>
                    </div>
                </div>
                
                <div style="color: #6b7280; font-style: italic; margin-bottom: 1.5rem;">Retornando ao lobby em <span id="countdown">5</span> segundos...</div>
                <button onclick="returnToLobby()" style="
                    background: linear-gradient(135deg, #fbbf24, #f59e0b);
                    color: #0f0f23;
                    border: none;
                    padding: 1rem 2rem;
                    border-radius: 10px;
                    font-weight: bold;
                    font-size: 1rem;
                    cursor: pointer;
                    transition: all 0.3s ease;
                " onmouseover="this.style.transform='scale(1.05)'" onmouseout="this.style.transform='scale(1)'">
                    üè† Voltar ao Lobby Agora
                </button>
            `;
            
            // Adicionar anima√ß√£o CSS
            const style = document.createElement('style');
            style.textContent = `
                @keyframes modalSlideIn {
                    from { opacity: 0; transform: translateY(-50px) scale(0.9); }
                    to { opacity: 1; transform: translateY(0) scale(1); }
                }
            `;
            document.head.appendChild(style);
            
            resultModal.appendChild(modalContent);
            document.body.appendChild(resultModal);
            
            // Countdown autom√°tico
            let countdown = 5;
            const countdownElement = document.getElementById('countdown');
            const countdownInterval = setInterval(() => {
                countdown--;
                if (countdownElement) {
                    countdownElement.textContent = countdown;
                }
                if (countdown <= 0) {
                    clearInterval(countdownInterval);
                    returnToLobby();
                }
            }, 1000);
        }
        
        function returnToLobby() {
            window.location.href = 'lobby.html';
        }

        // Fun√ß√£o para sair da investiga√ß√£o
        function exitInvestigation() {
            // Mostrar modal de confirma√ß√£o
            const confirmExit = confirm('üö™ Tem certeza que deseja sair da investiga√ß√£o?\n\n‚ö†Ô∏è Seu progresso atual ser√° salvo, mas voc√™ perder√° o timer atual.\n\n‚úÖ Clique OK para voltar ao lobby\n‚ùå Clique Cancelar para continuar jogando');
            
            if (confirmExit) {
                // Salvar progresso antes de sair
                const gameData = {
                    cardsPlayed: cardsPlayed,
                    comboStreak: comboStreak,
                    playerCoins: playerCoins,
                    exitTime: new Date().toISOString(),
                    timeRemaining: gameTime
                };
                
                localStorage.setItem('criminalMinds_gameProgress', JSON.stringify(gameData));
                
                // Mostrar feedback de sa√≠da
                const exitFeedback = document.createElement('div');
                exitFeedback.style.cssText = `
                    position: fixed;
                    top: 50%;
                    left: 50%;
                    transform: translate(-50%, -50%);
                    background: linear-gradient(135deg, #1a1a2e, #16213e);
                    border: 3px solid #fbbf24;
                    border-radius: 20px;
                    padding: 2rem;
                    z-index: 4000;
                    text-align: center;
                    box-shadow: 0 20px 60px rgba(0, 0, 0, 0.8);
                    color: white;
                `;
                
                exitFeedback.innerHTML = `
                    <h3 style="color: #fbbf24; margin-bottom: 1rem;">üö™ Saindo da Investiga√ß√£o...</h3>
                    <p style="color: #cbd5e1; margin-bottom: 1rem;">‚úÖ Progresso salvo com sucesso!</p>
                    <p style="color: #6b7280; font-style: italic;">Redirecionando para o lobby...</p>
                `;
                
                document.body.appendChild(exitFeedback);
                
                // Redirecionar ap√≥s 2 segundos
                setTimeout(() => {
                    window.location.href = 'lobby.html';
                }, 2000);
            }
        }

        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
        }

        // Fechar modal clicando fora
        window.onclick = function(event) {
            const modals = ['cardModal', 'collectionModal'];
            modals.forEach(modalId => {
                const modal = document.getElementById(modalId);
                if (event.target == modal) {
                    modal.style.display = 'none';
                }
            });
        }

        // Simula√ß√£o de atividade da equipe
        function simulateTeamActivity() {
            const activities = [
                "üé¥ Reid jogou carta LEND√ÅRIA: Perfil Completo!",
                "‚ö° Morgan ativou combo de 5 cartas!",
                "üíé Brennan encontrou carta √âPICA rara!",
                "üî• Garcia comprou pacote premium!",
                "‚ú® Hotchner desbloqueou conquista especial!"
            ];
            
            setInterval(() => {
                if (Math.random() < 0.4) {
                    const activity = activities[Math.floor(Math.random() * activities.length)];
                    addChatMessage(activity, 'ü§ñ Sistema');
                }
            }, 8000);
        }

        // Inicializar
        simulateTeamActivity();

        // SISTEMA DE CARTAS INTERATIVAS
        let cardsPlayed = 0;
        let comboStreak = 0;
        let playerCoins = 500;

        // Fun√ß√£o para jogar uma carta
        function playCard(cardElement) {
            if (cardElement.classList.contains('played')) {
                return; // Carta j√° foi jogada
            }

            // Marcar carta como jogada
            cardElement.classList.add('played');
            
            // Incrementar contadores
            cardsPlayed++;
            comboStreak++;
            
            // Atualizar estat√≠sticas
            updateStats();
            
            // Mostrar feedback visual
            showCardPlayedFeedback(cardElement);
            
            // Adicionar moedas baseado no combo
            const baseCoins = 10;
            const comboBonus = Math.floor(comboStreak * 2);
            const totalCoins = baseCoins + comboBonus;
            playerCoins += totalCoins;
            
            // Atualizar display de moedas
            document.getElementById('coin-display').textContent = playerCoins;
            
            // Mostrar notifica√ß√£o de moedas ganhas
            showCoinNotification(totalCoins, comboStreak);
            
            // Verificar se atingiu objetivo de cartas
            if (cardsPlayed >= 20) {
                showGameEndModal('victory');
            }
        }

        // Fun√ß√£o para mostrar feedback visual ao jogar carta
        function showCardPlayedFeedback(cardElement) {
            const feedback = document.createElement('div');
            feedback.style.cssText = `
                position: absolute;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                background: linear-gradient(135deg, #fbbf24, #f59e0b);
                color: #0f0f23;
                padding: 0.5rem 1rem;
                border-radius: 20px;
                font-weight: bold;
                font-size: 0.9rem;
                z-index: 1000;
                animation: cardPlayedAnim 1s ease-out forwards;
            `;
            feedback.textContent = `+${comboStreak}x COMBO!`;
            
            cardElement.style.position = 'relative';
            cardElement.appendChild(feedback);
            
            setTimeout(() => {
                feedback.remove();
            }, 1000);
        }

        // Fun√ß√£o para mostrar notifica√ß√£o de moedas
        function showCoinNotification(coins, combo) {
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: linear-gradient(135deg, #fbbf24, #f59e0b);
                color: #0f0f23;
                padding: 1rem;
                border-radius: 10px;
                font-weight: bold;
                z-index: 2000;
                animation: slideInRight 0.5s ease-out;
            `;
            notification.innerHTML = `
                üí∞ +${coins} Moedas<br>
                üî• Combo ${combo}x
            `;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.animation = 'slideOutRight 0.5s ease-in';
                setTimeout(() => notification.remove(), 500);
            }, 3000);
        }

        // Fun√ß√£o para atualizar estat√≠sticas
        function updateStats() {
            document.getElementById('cardsPlayed').textContent = `${cardsPlayed}/20`;
            document.getElementById('comboStreak').textContent = `${comboStreak}x`;
            
            // Atualizar barras de progresso
            const cardsProgress = (cardsPlayed / 20) * 100;
            const comboProgress = Math.min((comboStreak / 10) * 100, 100);
            
            document.getElementById('cardsProgress').style.width = `${cardsProgress}%`;
            document.getElementById('comboProgress').style.width = `${comboProgress}%`;
        }

        // Adicionar event listeners para as cartas
        function initializeCards() {
            const cards = document.querySelectorAll('.card');
            cards.forEach(card => {
                card.addEventListener('click', () => playCard(card));
            });
        }

        // CSS Animations
        const style = document.createElement('style');
        style.textContent = `
            @keyframes cardPlayedAnim {
                0% { transform: translate(-50%, -50%) scale(0); opacity: 0; }
                50% { transform: translate(-50%, -50%) scale(1.2); opacity: 1; }
                100% { transform: translate(-50%, -50%) scale(1); opacity: 0; }
            }
            
            @keyframes slideInRight {
                from { transform: translateX(100%); opacity: 0; }
                to { transform: translateX(0); opacity: 1; }
            }
            
            @keyframes slideOutRight {
                from { transform: translateX(0); opacity: 1; }
                to { transform: translateX(100%); opacity: 0; }
            }
        `;
        document.head.appendChild(style);

        // Recuperar dados do usu√°rio
        window.onload = function() {
            const detectiveName = localStorage.getItem('detectiveName');
            if (detectiveName) {
                const teamList = document.getElementById('teamList');
                const userDiv = document.createElement('div');
                userDiv.className = 'chat-message';
                userDiv.innerHTML = `<span class="chat-user">üïµÔ∏è ${detectiveName}:</span> Online - 47 cartas`;
                teamList.appendChild(userDiv);
            }
            
            // Inicializar sistema completo de testes e melhorias
            if (typeof ComprehensiveTestSystem !== 'undefined') {
                try {
                    window.comprehensiveTestSystem = new ComprehensiveTestSystem();
                    console.log('üß™ Sistema completo de testes e melhorias inicializado');
                } catch (error) {
                    console.error('Erro ao inicializar sistema de testes:', error);
                }
            }
            
            // Inicializar sistema aprimorado do jogo
            if (typeof EnhancedGameSystem !== 'undefined') {
                try {
                    window.enhancedGameSystem = new EnhancedGameSystem();
                    console.log('üéÆ Sistema aprimorado do jogo inicializado');
                } catch (error) {
                    console.error('Erro ao inicializar sistema aprimorado:', error);
                }
            }
            
            // Inicializar sistema de m√£o completa
            if (typeof CompleteHandSystem !== 'undefined') {
                try {
                    window.completeHandSystem = new CompleteHandSystem();
                    console.log('üÉè Sistema de m√£o completa inicializado');
                } catch (error) {
                    console.error('Erro ao inicializar sistema de m√£o completa:', error);
                }
            }
            
            // Inicializar sistema de diagn√≥stico de layout PRIMEIRO
            if (typeof LayoutDiagnosticSystem !== 'undefined') {
                try {
                    window.layoutDiagnostic = new LayoutDiagnosticSystem();
                    console.log('üîç Sistema de diagn√≥stico de layout inicializado');
                    
                    // Executar diagn√≥stico completo
            setTimeout(() => {
                        window.layoutDiagnostic.forceFixBasedOnDiagnostic();
                        window.layoutDiagnostic.runRealTimeDiagnostic();
                    }, 500);
                } catch (error) {
                    console.error('Erro ao inicializar sistema de diagn√≥stico:', error);
                }
            }

            // Desabilitado: AggressiveFixSystem estava limpando o DOM e causando loops
            // Caso necess√°rio no futuro, reativar com muito cuidado
            
            // Inicializar sistema de corre√ß√£o de layout
            if (typeof LayoutFixSystem !== 'undefined') {
                try {
                    window.layoutFixSystem = new LayoutFixSystem();
                    console.log('üé® Sistema de corre√ß√£o de layout inicializado');
                    
                    // Executar corre√ß√£o de layout
                    setTimeout(() => {
                        window.layoutFixSystem.run();
                    }, 2000);
                } catch (error) {
                    console.error('Erro ao inicializar sistema de corre√ß√£o de layout:', error);
                }
            }
            
            // Inicializar sistema de cartas interativas
            initializeCards();
            console.log('üÉè Sistema de cartas interativas inicializado');
        };
    </script>
</body>
</html>