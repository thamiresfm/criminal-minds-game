<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Teste - CorreÃ§Ã£o de Erros</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1e3a8a 0%, #1e40af 100%);
            margin: 0;
            padding: 20px;
            color: white;
        }
        
        .test-container {
            max-width: 800px;
            margin: 0 auto;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 15px;
            padding: 2rem;
            backdrop-filter: blur(10px);
        }
        
        .test-header {
            text-align: center;
            margin-bottom: 2rem;
        }
        
        .test-section {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
        }
        
        .test-title {
            color: #fbbf24;
            font-size: 1.5rem;
            margin-bottom: 1rem;
        }
        
        .test-buttons {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
            margin-bottom: 1rem;
        }
        
        .btn {
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
        }
        
        .btn-primary {
            background: #fbbf24;
            color: #1f2937;
        }
        
        .btn-primary:hover {
            background: #f59e0b;
            transform: translateY(-2px);
        }
        
        .btn-secondary {
            background: #6b7280;
            color: white;
        }
        
        .btn-secondary:hover {
            background: #4b5563;
        }
        
        .btn-success {
            background: #10b981;
            color: white;
        }
        
        .btn-success:hover {
            background: #059669;
        }
        
        .btn-danger {
            background: #ef4444;
            color: white;
        }
        
        .btn-danger:hover {
            background: #dc2626;
        }
        
        .debug-panel {
            background: rgba(0, 0, 0, 0.5);
            border-radius: 8px;
            padding: 1rem;
            margin-top: 1rem;
            max-height: 300px;
            overflow-y: auto;
        }
        
        .debug-title {
            color: #fbbf24;
            margin-bottom: 0.5rem;
        }
        
        .debug-log {
            background: rgba(0, 0, 0, 0.3);
            padding: 0.5rem;
            margin: 0.25rem 0;
            border-radius: 4px;
            font-family: monospace;
            font-size: 0.8rem;
        }
        
        .error-log {
            background: rgba(239, 68, 68, 0.2);
            border-left: 3px solid #ef4444;
        }
        
        .success-log {
            background: rgba(16, 185, 129, 0.2);
            border-left: 3px solid #10b981;
        }
        
        .stats-display {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 1rem;
            margin-bottom: 1rem;
        }
        
        .stat-card {
            background: rgba(0, 0, 0, 0.2);
            padding: 1rem;
            border-radius: 8px;
            text-align: center;
        }
        
        .stat-value {
            font-size: 1.5rem;
            font-weight: bold;
            color: #fbbf24;
        }
        
        .stat-label {
            color: #9ca3af;
            font-size: 0.8rem;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <div class="test-header">
            <h1>ğŸ”§ Teste - CorreÃ§Ã£o de Erros</h1>
            <p>Verificando se os erros foram corrigidos no sistema</p>
        </div>
        
        <!-- SeÃ§Ã£o de EstatÃ­sticas -->
        <div class="test-section">
            <h2 class="test-title">ğŸ“Š EstatÃ­sticas do Sistema</h2>
            <div class="stats-display">
                <div class="stat-card">
                    <div class="stat-value" id="cardsPlayed">0/6</div>
                    <div class="stat-label">ğŸƒ Cartas Jogadas</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="comboStreak">0x</div>
                    <div class="stat-label">ğŸ”¥ Combo Streak</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="currentMultiplier">1.0x</div>
                    <div class="stat-label">ğŸ“ˆ Multiplicador</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="evidenceDisplay">0/100</div>
                    <div class="stat-label">ğŸ” EvidÃªncias</div>
                </div>
            </div>
        </div>
        
        <!-- SeÃ§Ã£o de Testes -->
        <div class="test-section">
            <h2 class="test-title">ğŸ§ª Testes de CorreÃ§Ã£o</h2>
            <div class="test-buttons">
                <button class="btn btn-primary" onclick="testComboStreak()">ğŸ”¥ Testar Combo Streak</button>
                <button class="btn btn-secondary" onclick="testNotifications()">ğŸ”” Testar NotificaÃ§Ãµes</button>
                <button class="btn btn-success" onclick="testAchievements()">ğŸ† Testar Conquistas</button>
                <button class="btn btn-danger" onclick="testErrorHandling()">âŒ Testar Tratamento de Erros</button>
            </div>
        </div>
        
        <!-- SeÃ§Ã£o de VerificaÃ§Ã£o -->
        <div class="test-section">
            <h2 class="test-title">âœ… VerificaÃ§Ã£o de CorreÃ§Ãµes</h2>
            <div class="test-buttons">
                <button class="btn btn-primary" onclick="checkFunctionDefinitions()">ğŸ” Verificar FunÃ§Ãµes</button>
                <button class="btn btn-secondary" onclick="checkElementReferences()">ğŸ¯ Verificar Elementos</button>
                <button class="btn btn-success" onclick="checkVariableScope()">ğŸ“¦ Verificar VariÃ¡veis</button>
                <button class="btn btn-danger" onclick="runFullDiagnostic()">ğŸ”¬ DiagnÃ³stico Completo</button>
            </div>
        </div>
        
        <!-- Painel de Debug -->
        <div class="test-section">
            <h2 class="test-title">ğŸ› Painel de Debug</h2>
            <div class="debug-panel" id="debugPanel">
                <div class="debug-title">Log de Eventos:</div>
                <div class="debug-log">Sistema de teste inicializado. Pronto para verificar correÃ§Ãµes.</div>
            </div>
        </div>
    </div>

    <script>
        // VariÃ¡veis globais do jogo
        let cardsPlayed = 0;
        let comboStreak = 0;
        let currentEvidence = 0;
        const maxEvidence = 100;
        const maxCardsForLevel = 6;
        
        // SimulaÃ§Ã£o do banco de dados de cartas
        const cardDatabase = [
            {
                id: 'test_card_1',
                title: 'Carta de Teste 1',
                type: 'Teste',
                rarity: 'common',
                icon: 'ğŸ§ª',
                evidence: 20,
                played: false
            }
        ];
        
        // SimulaÃ§Ã£o das configuraÃ§Ãµes de dificuldade
        const difficultySettings = {
            beginner: { cards: 6, name: 'Iniciante', color: '#10b981' },
            intermediate: { cards: 20, name: 'IntermediÃ¡rio', color: '#f59e0b' },
            hard: { cards: 25, name: 'DifÃ­cil', color: '#ef4444' }
        };
        
        let currentDifficulty = 'beginner';
        
        // SimulaÃ§Ã£o das conquistas
        const achievements = {
            comboMaster: {
                id: 'comboMaster',
                title: 'Combo Master',
                message: 'AlcanÃ§ou um combo de 10x!',
                reward: 100,
                completed: false
            }
        };
        
        // FunÃ§Ã£o para adicionar log de debug
        function addDebug(message, type = 'info') {
            const debugPanel = document.getElementById('debugPanel');
            const logEntry = document.createElement('div');
            logEntry.className = `debug-log ${type}-log`;
            logEntry.textContent = `[${new Date().toLocaleTimeString()}] ${message}`;
            debugPanel.appendChild(logEntry);
            debugPanel.scrollTop = debugPanel.scrollHeight;
        }
        
        // FunÃ§Ã£o para mostrar notificaÃ§Ã£o
        function showNotification(message) {
            addDebug(`ğŸ”” NotificaÃ§Ã£o: ${message}`, 'success');
        }
        
        // FunÃ§Ã£o para desbloquear conquista
        function unlockAchievement(achievementId) {
            const achievement = achievements[achievementId];
            if (achievement && !achievement.completed) {
                achievement.completed = true;
                addDebug(`ğŸ† Conquista desbloqueada: ${achievement.title}`, 'success');
                showNotification(`ğŸ† CONQUISTA DESBLOQUEADA!\n${achievement.message}`);
            }
        }
        
        // FunÃ§Ã£o para gerenciar o Combo Streak (versÃ£o corrigida)
        function manageComboStreak(action = 'increment') {
            addDebug(`ğŸ”¥ Gerenciando Combo Streak: ${action}`);
            
            try {
                switch (action) {
                    case 'increment':
                        comboStreak++;
                        addDebug(`ğŸ”¥ Combo incrementado: ${comboStreak}x`, 'success');
                        
                        // Verificar conquistas de combo
                        if (comboStreak === 3) {
                            showNotification('ğŸ”¥ Combo 3x! BÃ´nus de evidÃªncias ativo!');
                        } else if (comboStreak === 5) {
                            showNotification('âš¡ Combo 5x! Multiplicador mÃ¡ximo!');
                        } else if (comboStreak === 10) {
                            showNotification('ğŸ¯ Combo 10x! LENDÃRIO!');
                            unlockAchievement('comboMaster');
                        }
                        break;
                        
                    case 'reset':
                        const previousCombo = comboStreak;
                        comboStreak = 0;
                        addDebug(`ğŸ”¥ Combo resetado: ${previousCombo}x â†’ 0x`, 'success');
                        
                        if (previousCombo >= 3) {
                            showNotification('ğŸ’” Combo perdido! Volte a jogar cartas consecutivamente.');
                        }
                        break;
                        
                    case 'maintain':
                        addDebug(`ğŸ”¥ Combo mantido: ${comboStreak}x`, 'success');
                        break;
                        
                    default:
                        addDebug(`âŒ AÃ§Ã£o de combo invÃ¡lida: ${action}`, 'error');
                        return;
                }
                
                updateComboDisplay();
                updateMultiplier();
                updateComboProgressBar();
                
                addDebug(`âœ… Combo Streak gerenciado com sucesso: ${comboStreak}x`, 'success');
                return comboStreak;
                
            } catch (error) {
                addDebug(`âŒ Erro no manageComboStreak: ${error.message}`, 'error');
                console.error('Erro no manageComboStreak:', error);
            }
        }
        
        // FunÃ§Ã£o para atualizar o display do combo
        function updateComboDisplay() {
            try {
                const comboElement = document.getElementById('comboStreak');
                if (comboElement) {
                    comboElement.textContent = `${comboStreak}x`;
                    addDebug(`ğŸ”¥ Display do combo atualizado: ${comboStreak}x`, 'success');
                } else {
                    addDebug('âŒ Elemento comboStreak nÃ£o encontrado', 'error');
                }
            } catch (error) {
                addDebug(`âŒ Erro no updateComboDisplay: ${error.message}`, 'error');
            }
        }
        
        // FunÃ§Ã£o para atualizar o multiplicador
        function updateMultiplier() {
            try {
                const multiplier = 1.0 + (comboStreak * 0.1);
                const multiplierElement = document.getElementById('currentMultiplier');
                
                if (multiplierElement) {
                    multiplierElement.textContent = `${multiplier.toFixed(1)}x`;
                    addDebug(`ğŸ“ˆ Multiplicador atualizado: ${multiplier.toFixed(1)}x`, 'success');
                } else {
                    addDebug('âŒ Elemento currentMultiplier nÃ£o encontrado', 'error');
                }
                
                return multiplier;
            } catch (error) {
                addDebug(`âŒ Erro no updateMultiplier: ${error.message}`, 'error');
            }
        }
        
        // FunÃ§Ã£o para atualizar a barra de progresso do combo
        function updateComboProgressBar() {
            try {
                const maxCombo = 10;
                const progressPercentage = Math.min((comboStreak / maxCombo) * 100, 100);
                addDebug(`ğŸ“Š Barra de progresso do combo: ${progressPercentage.toFixed(1)}%`, 'success');
            } catch (error) {
                addDebug(`âŒ Erro no updateComboProgressBar: ${error.message}`, 'error');
            }
        }
        
        // FunÃ§Ãµes de teste
        function testComboStreak() {
            addDebug('ğŸ§ª Testando sistema de Combo Streak...', 'info');
            
            // Teste 1: Incremento
            manageComboStreak('increment');
            
            // Teste 2: Incremento mÃºltiplo
            setTimeout(() => {
                manageComboStreak('increment');
                manageComboStreak('increment');
                manageComboStreak('increment');
            }, 500);
            
            // Teste 3: Reset
            setTimeout(() => {
                manageComboStreak('reset');
            }, 1500);
            
            addDebug('âœ… Teste de Combo Streak concluÃ­do', 'success');
        }
        
        function testNotifications() {
            addDebug('ğŸ§ª Testando sistema de notificaÃ§Ãµes...', 'info');
            
            showNotification('Teste de notificaÃ§Ã£o 1');
            
            setTimeout(() => {
                showNotification('Teste de notificaÃ§Ã£o 2');
            }, 500);
            
            setTimeout(() => {
                showNotification('Teste de notificaÃ§Ã£o 3');
            }, 1000);
            
            addDebug('âœ… Teste de notificaÃ§Ãµes concluÃ­do', 'success');
        }
        
        function testAchievements() {
            addDebug('ğŸ§ª Testando sistema de conquistas...', 'info');
            
            // Simular combo de 10x para desbloquear conquista
            comboStreak = 9;
            manageComboStreak('increment');
            
            addDebug('âœ… Teste de conquistas concluÃ­do', 'success');
        }
        
        function testErrorHandling() {
            addDebug('ğŸ§ª Testando tratamento de erros...', 'info');
            
            // Teste 1: AÃ§Ã£o invÃ¡lida
            manageComboStreak('invalid_action');
            
            // Teste 2: Elemento inexistente
            try {
                const nonExistentElement = document.getElementById('non_existent');
                if (nonExistentElement) {
                    addDebug('âŒ Elemento inexistente foi encontrado (erro)', 'error');
                } else {
                    addDebug('âœ… Elemento inexistente nÃ£o foi encontrado (correto)', 'success');
                }
            } catch (error) {
                addDebug(`âŒ Erro ao verificar elemento: ${error.message}`, 'error');
            }
            
            addDebug('âœ… Teste de tratamento de erros concluÃ­do', 'success');
        }
        
        function checkFunctionDefinitions() {
            addDebug('ğŸ” Verificando definiÃ§Ãµes de funÃ§Ãµes...', 'info');
            
            const functions = [
                'manageComboStreak',
                'updateComboDisplay',
                'updateMultiplier',
                'updateComboProgressBar',
                'showNotification',
                'unlockAchievement'
            ];
            
            let allFunctionsExist = true;
            
            functions.forEach(funcName => {
                if (typeof window[funcName] === 'function') {
                    addDebug(`âœ… FunÃ§Ã£o ${funcName} definida`, 'success');
                } else {
                    addDebug(`âŒ FunÃ§Ã£o ${funcName} nÃ£o encontrada`, 'error');
                    allFunctionsExist = false;
                }
            });
            
            if (allFunctionsExist) {
                addDebug('ğŸ‰ Todas as funÃ§Ãµes estÃ£o definidas corretamente!', 'success');
            } else {
                addDebug('âš ï¸ Algumas funÃ§Ãµes estÃ£o faltando', 'error');
            }
        }
        
        function checkElementReferences() {
            addDebug('ğŸ¯ Verificando referÃªncias de elementos...', 'info');
            
            const elements = [
                'cardsPlayed',
                'comboStreak',
                'currentMultiplier',
                'evidenceDisplay'
            ];
            
            let allElementsExist = true;
            
            elements.forEach(elementId => {
                const element = document.getElementById(elementId);
                if (element) {
                    addDebug(`âœ… Elemento ${elementId} encontrado`, 'success');
                } else {
                    addDebug(`âŒ Elemento ${elementId} nÃ£o encontrado`, 'error');
                    allElementsExist = false;
                }
            });
            
            if (allElementsExist) {
                addDebug('ğŸ‰ Todos os elementos estÃ£o presentes!', 'success');
            } else {
                addDebug('âš ï¸ Alguns elementos estÃ£o faltando', 'error');
            }
        }
        
        function checkVariableScope() {
            addDebug('ğŸ“¦ Verificando escopo de variÃ¡veis...', 'info');
            
            const variables = [
                'cardsPlayed',
                'comboStreak',
                'currentEvidence',
                'maxEvidence',
                'maxCardsForLevel',
                'cardDatabase',
                'difficultySettings',
                'currentDifficulty',
                'achievements'
            ];
            
            let allVariablesExist = true;
            
            variables.forEach(varName => {
                if (typeof window[varName] !== 'undefined') {
                    addDebug(`âœ… VariÃ¡vel ${varName} definida`, 'success');
                } else {
                    addDebug(`âŒ VariÃ¡vel ${varName} nÃ£o encontrada`, 'error');
                    allVariablesExist = false;
                }
            });
            
            if (allVariablesExist) {
                addDebug('ğŸ‰ Todas as variÃ¡veis estÃ£o definidas!', 'success');
            } else {
                addDebug('âš ï¸ Algumas variÃ¡veis estÃ£o faltando', 'error');
            }
        }
        
        function runFullDiagnostic() {
            addDebug('ğŸ”¬ Iniciando diagnÃ³stico completo...', 'info');
            
            setTimeout(() => {
                checkFunctionDefinitions();
            }, 100);
            
            setTimeout(() => {
                checkElementReferences();
            }, 200);
            
            setTimeout(() => {
                checkVariableScope();
            }, 300);
            
            setTimeout(() => {
                testComboStreak();
            }, 400);
            
            setTimeout(() => {
                testNotifications();
            }, 500);
            
            setTimeout(() => {
                testAchievements();
            }, 600);
            
            setTimeout(() => {
                testErrorHandling();
            }, 700);
            
            setTimeout(() => {
                addDebug('ğŸ‰ DiagnÃ³stico completo finalizado!', 'success');
            }, 800);
        }
        
        // InicializaÃ§Ã£o
        document.addEventListener('DOMContentLoaded', function() {
            addDebug('ğŸš€ Sistema de teste de correÃ§Ã£o inicializado', 'success');
            addDebug('ğŸ”¥ Combo Streak corrigido', 'success');
            addDebug('ğŸ”” NotificaÃ§Ãµes corrigidas', 'success');
            addDebug('ğŸ† Conquistas corrigidas', 'success');
            addDebug('ğŸ“Š Contadores funcionando', 'success');
            
            // Inicializar displays
            updateComboDisplay();
            updateMultiplier();
            updateComboProgressBar();
        });
    </script>
</body>
</html>
